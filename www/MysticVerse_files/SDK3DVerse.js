!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define("SDK3DVerse",[],e):"object"==typeof exports?exports.SDK3DVerse=e():t.SDK3DVerse=e()}("undefined"!=typeof self?self:this,(function(){return function(t){var e={};function n(r){if(e[r])return e[r].exports;var i=e[r]={i:r,l:!1,exports:{}};return t[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)n.d(r,i,function(e){return t[e]}.bind(null,i));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=189)}([function(t,e,n){"use strict";n.r(e),n.d(e,"EPSILON",(function(){return r})),n.d(e,"ARRAY_TYPE",(function(){return i})),n.d(e,"RANDOM",(function(){return o})),n.d(e,"setMatrixArrayType",(function(){return a})),n.d(e,"toRadian",(function(){return u})),n.d(e,"equals",(function(){return c}));var r=1e-6,i="undefined"!=typeof Float32Array?Float32Array:Array,o=Math.random;function a(t){i=t}var s=Math.PI/180;function u(t){return t*s}function c(t,e){return Math.abs(t-e)<=r*Math.max(1,Math.abs(t),Math.abs(e))}},,function(t,e,n){var r=n(4),i=n(18),o=n(10),a=n(16),s=n(13),u=function(t,e,n){var c,h,f,l,p=t&u.F,d=t&u.G,v=t&u.S,y=t&u.P,m=t&u.B,g=d?r:v?r[e]||(r[e]={}):(r[e]||{}).prototype,w=d?i:i[e]||(i[e]={}),b=w.prototype||(w.prototype={});for(c in d&&(n=e),n)f=((h=!p&&g&&void 0!==g[c])?g:n)[c],l=m&&h?s(f,r):y&&"function"==typeof f?s(Function.call,f):f,g&&a(g,c,f,t&u.U),w[c]!=f&&o(w,c,l),y&&b[c]!=f&&(b[c]=f)};r.core=i,u.F=1,u.G=2,u.S=4,u.P=8,u.B=16,u.W=32,u.U=64,u.R=128,t.exports=u},function(t,e,n){var r=n(34)("wks"),i=n(19),o=n(4).Symbol,a="function"==typeof o;(t.exports=function(t){return r[t]||(r[t]=a&&o[t]||(a?o:i)("Symbol."+t))}).store=r},function(t,e){var n=t.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=n)},function(t,e){t.exports=function(t){return"object"==typeof t?null!==t:"function"==typeof t}},function(t,e,n){var r=n(8),i=n(68),o=n(37),a=Object.defineProperty;e.f=n(7)?Object.defineProperty:function(t,e,n){if(r(t),e=o(e,!0),r(n),i)try{return a(t,e,n)}catch(t){}if("get"in n||"set"in n)throw TypeError("Accessors not supported!");return"value"in n&&(t[e]=n.value),t}},function(t,e,n){t.exports=!n(9)((function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a}))},function(t,e,n){var r=n(5);t.exports=function(t){if(!r(t))throw TypeError(t+" is not an object!");return t}},function(t,e){t.exports=function(t){try{return!!t()}catch(t){return!0}}},function(t,e,n){var r=n(6),i=n(26);t.exports=n(7)?function(t,e,n){return r.f(t,e,i(1,n))}:function(t,e,n){return t[e]=n,t}},function(t,e,n){"use strict";n.d(e,"b",(function(){return i})),n.d(e,"g",(function(){return o})),n.d(e,"c",(function(){return a})),n.d(e,"l",(function(){return s})),n.d(e,"a",(function(){return u})),n.d(e,"k",(function(){return c})),n.d(e,"h",(function(){return h})),n.d(e,"m",(function(){return f})),n.d(e,"j",(function(){return l})),n.d(e,"d",(function(){return p})),n.d(e,"i",(function(){return d})),n.d(e,"f",(function(){return v})),n.d(e,"e",(function(){return y}));var r=n(0);function i(t){var e=new r.ARRAY_TYPE(4);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e}function o(t,e,n,i){var o=new r.ARRAY_TYPE(4);return o[0]=t,o[1]=e,o[2]=n,o[3]=i,o}function a(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t}function s(t,e,n,r,i){return t[0]=e,t[1]=n,t[2]=r,t[3]=i,t}function u(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t}function c(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t}function h(t){var e=t[0],n=t[1],r=t[2],i=t[3];return Math.sqrt(e*e+n*n+r*r+i*i)}function f(t){var e=t[0],n=t[1],r=t[2],i=t[3];return e*e+n*n+r*r+i*i}function l(t,e){var n=e[0],r=e[1],i=e[2],o=e[3],a=n*n+r*r+i*i+o*o;return a>0&&(a=1/Math.sqrt(a)),t[0]=n*a,t[1]=r*a,t[2]=i*a,t[3]=o*a,t}function p(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]+t[3]*e[3]}function d(t,e,n,r){var i=e[0],o=e[1],a=e[2],s=e[3];return t[0]=i+r*(n[0]-i),t[1]=o+r*(n[1]-o),t[2]=a+r*(n[2]-a),t[3]=s+r*(n[3]-s),t}function v(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]}function y(t,e){var n=t[0],i=t[1],o=t[2],a=t[3],s=e[0],u=e[1],c=e[2],h=e[3];return Math.abs(n-s)<=r.EPSILON*Math.max(1,Math.abs(n),Math.abs(s))&&Math.abs(i-u)<=r.EPSILON*Math.max(1,Math.abs(i),Math.abs(u))&&Math.abs(o-c)<=r.EPSILON*Math.max(1,Math.abs(o),Math.abs(c))&&Math.abs(a-h)<=r.EPSILON*Math.max(1,Math.abs(a),Math.abs(h))}var m,g;m=new r.ARRAY_TYPE(4),r.ARRAY_TYPE!=Float32Array&&(m[0]=0,m[1]=0,m[2]=0,m[3]=0),g=m},function(t,e,n){"use strict";n.r(e),n.d(e,"create",(function(){return i})),n.d(e,"clone",(function(){return o})),n.d(e,"length",(function(){return a})),n.d(e,"fromValues",(function(){return s})),n.d(e,"copy",(function(){return u})),n.d(e,"set",(function(){return c})),n.d(e,"add",(function(){return h})),n.d(e,"subtract",(function(){return f})),n.d(e,"multiply",(function(){return l})),n.d(e,"divide",(function(){return p})),n.d(e,"ceil",(function(){return d})),n.d(e,"floor",(function(){return v})),n.d(e,"min",(function(){return y})),n.d(e,"max",(function(){return m})),n.d(e,"round",(function(){return g})),n.d(e,"scale",(function(){return w})),n.d(e,"scaleAndAdd",(function(){return b})),n.d(e,"distance",(function(){return E})),n.d(e,"squaredDistance",(function(){return _})),n.d(e,"squaredLength",(function(){return A})),n.d(e,"negate",(function(){return x})),n.d(e,"inverse",(function(){return k})),n.d(e,"normalize",(function(){return T})),n.d(e,"dot",(function(){return S})),n.d(e,"cross",(function(){return C})),n.d(e,"lerp",(function(){return R})),n.d(e,"hermite",(function(){return P})),n.d(e,"bezier",(function(){return I})),n.d(e,"random",(function(){return M})),n.d(e,"transformMat4",(function(){return U})),n.d(e,"transformMat3",(function(){return O})),n.d(e,"transformQuat",(function(){return D})),n.d(e,"rotateX",(function(){return L})),n.d(e,"rotateY",(function(){return N})),n.d(e,"rotateZ",(function(){return F})),n.d(e,"angle",(function(){return B})),n.d(e,"zero",(function(){return V})),n.d(e,"str",(function(){return j})),n.d(e,"exactEquals",(function(){return Y})),n.d(e,"equals",(function(){return G})),n.d(e,"sub",(function(){return q})),n.d(e,"mul",(function(){return z})),n.d(e,"div",(function(){return X})),n.d(e,"dist",(function(){return H})),n.d(e,"sqrDist",(function(){return K})),n.d(e,"len",(function(){return J})),n.d(e,"sqrLen",(function(){return Q})),n.d(e,"forEach",(function(){return $}));var r=n(0);function i(){var t=new r.ARRAY_TYPE(3);return r.ARRAY_TYPE!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t}function o(t){var e=new r.ARRAY_TYPE(3);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e}function a(t){var e=t[0],n=t[1],r=t[2];return Math.sqrt(e*e+n*n+r*r)}function s(t,e,n){var i=new r.ARRAY_TYPE(3);return i[0]=t,i[1]=e,i[2]=n,i}function u(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t}function c(t,e,n,r){return t[0]=e,t[1]=n,t[2]=r,t}function h(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t}function f(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t}function l(t,e,n){return t[0]=e[0]*n[0],t[1]=e[1]*n[1],t[2]=e[2]*n[2],t}function p(t,e,n){return t[0]=e[0]/n[0],t[1]=e[1]/n[1],t[2]=e[2]/n[2],t}function d(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t[2]=Math.ceil(e[2]),t}function v(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t[2]=Math.floor(e[2]),t}function y(t,e,n){return t[0]=Math.min(e[0],n[0]),t[1]=Math.min(e[1],n[1]),t[2]=Math.min(e[2],n[2]),t}function m(t,e,n){return t[0]=Math.max(e[0],n[0]),t[1]=Math.max(e[1],n[1]),t[2]=Math.max(e[2],n[2]),t}function g(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t[2]=Math.round(e[2]),t}function w(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t}function b(t,e,n,r){return t[0]=e[0]+n[0]*r,t[1]=e[1]+n[1]*r,t[2]=e[2]+n[2]*r,t}function E(t,e){var n=e[0]-t[0],r=e[1]-t[1],i=e[2]-t[2];return Math.sqrt(n*n+r*r+i*i)}function _(t,e){var n=e[0]-t[0],r=e[1]-t[1],i=e[2]-t[2];return n*n+r*r+i*i}function A(t){var e=t[0],n=t[1],r=t[2];return e*e+n*n+r*r}function x(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t}function k(t,e){return t[0]=1/e[0],t[1]=1/e[1],t[2]=1/e[2],t}function T(t,e){var n=e[0],r=e[1],i=e[2],o=n*n+r*r+i*i;return o>0&&(o=1/Math.sqrt(o)),t[0]=e[0]*o,t[1]=e[1]*o,t[2]=e[2]*o,t}function S(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function C(t,e,n){var r=e[0],i=e[1],o=e[2],a=n[0],s=n[1],u=n[2];return t[0]=i*u-o*s,t[1]=o*a-r*u,t[2]=r*s-i*a,t}function R(t,e,n,r){var i=e[0],o=e[1],a=e[2];return t[0]=i+r*(n[0]-i),t[1]=o+r*(n[1]-o),t[2]=a+r*(n[2]-a),t}function P(t,e,n,r,i,o){var a=o*o,s=a*(2*o-3)+1,u=a*(o-2)+o,c=a*(o-1),h=a*(3-2*o);return t[0]=e[0]*s+n[0]*u+r[0]*c+i[0]*h,t[1]=e[1]*s+n[1]*u+r[1]*c+i[1]*h,t[2]=e[2]*s+n[2]*u+r[2]*c+i[2]*h,t}function I(t,e,n,r,i,o){var a=1-o,s=a*a,u=o*o,c=s*a,h=3*o*s,f=3*u*a,l=u*o;return t[0]=e[0]*c+n[0]*h+r[0]*f+i[0]*l,t[1]=e[1]*c+n[1]*h+r[1]*f+i[1]*l,t[2]=e[2]*c+n[2]*h+r[2]*f+i[2]*l,t}function M(t,e){e=e||1;var n=2*r.RANDOM()*Math.PI,i=2*r.RANDOM()-1,o=Math.sqrt(1-i*i)*e;return t[0]=Math.cos(n)*o,t[1]=Math.sin(n)*o,t[2]=i*e,t}function U(t,e,n){var r=e[0],i=e[1],o=e[2],a=n[3]*r+n[7]*i+n[11]*o+n[15];return a=a||1,t[0]=(n[0]*r+n[4]*i+n[8]*o+n[12])/a,t[1]=(n[1]*r+n[5]*i+n[9]*o+n[13])/a,t[2]=(n[2]*r+n[6]*i+n[10]*o+n[14])/a,t}function O(t,e,n){var r=e[0],i=e[1],o=e[2];return t[0]=r*n[0]+i*n[3]+o*n[6],t[1]=r*n[1]+i*n[4]+o*n[7],t[2]=r*n[2]+i*n[5]+o*n[8],t}function D(t,e,n){var r=n[0],i=n[1],o=n[2],a=n[3],s=e[0],u=e[1],c=e[2],h=i*c-o*u,f=o*s-r*c,l=r*u-i*s,p=i*l-o*f,d=o*h-r*l,v=r*f-i*h,y=2*a;return h*=y,f*=y,l*=y,p*=2,d*=2,v*=2,t[0]=s+h+p,t[1]=u+f+d,t[2]=c+l+v,t}function L(t,e,n,r){var i=[],o=[];return i[0]=e[0]-n[0],i[1]=e[1]-n[1],i[2]=e[2]-n[2],o[0]=i[0],o[1]=i[1]*Math.cos(r)-i[2]*Math.sin(r),o[2]=i[1]*Math.sin(r)+i[2]*Math.cos(r),t[0]=o[0]+n[0],t[1]=o[1]+n[1],t[2]=o[2]+n[2],t}function N(t,e,n,r){var i=[],o=[];return i[0]=e[0]-n[0],i[1]=e[1]-n[1],i[2]=e[2]-n[2],o[0]=i[2]*Math.sin(r)+i[0]*Math.cos(r),o[1]=i[1],o[2]=i[2]*Math.cos(r)-i[0]*Math.sin(r),t[0]=o[0]+n[0],t[1]=o[1]+n[1],t[2]=o[2]+n[2],t}function F(t,e,n,r){var i=[],o=[];return i[0]=e[0]-n[0],i[1]=e[1]-n[1],i[2]=e[2]-n[2],o[0]=i[0]*Math.cos(r)-i[1]*Math.sin(r),o[1]=i[0]*Math.sin(r)+i[1]*Math.cos(r),o[2]=i[2],t[0]=o[0]+n[0],t[1]=o[1]+n[1],t[2]=o[2]+n[2],t}function B(t,e){var n=s(t[0],t[1],t[2]),r=s(e[0],e[1],e[2]);T(n,n),T(r,r);var i=S(n,r);return i>1?0:i<-1?Math.PI:Math.acos(i)}function V(t){return t[0]=0,t[1]=0,t[2]=0,t}function j(t){return"vec3("+t[0]+", "+t[1]+", "+t[2]+")"}function Y(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]}function G(t,e){var n=t[0],i=t[1],o=t[2],a=e[0],s=e[1],u=e[2];return Math.abs(n-a)<=r.EPSILON*Math.max(1,Math.abs(n),Math.abs(a))&&Math.abs(i-s)<=r.EPSILON*Math.max(1,Math.abs(i),Math.abs(s))&&Math.abs(o-u)<=r.EPSILON*Math.max(1,Math.abs(o),Math.abs(u))}var W,q=f,z=l,X=p,H=E,K=_,J=a,Q=A,$=(W=i(),function(t,e,n,r,i,o){var a,s;for(e||(e=3),n||(n=0),s=r?Math.min(r*e+n,t.length):t.length,a=n;a<s;a+=e)W[0]=t[a],W[1]=t[a+1],W[2]=t[a+2],i(W,W,o),t[a]=W[0],t[a+1]=W[1],t[a+2]=W[2];return t})},function(t,e,n){var r=n(32);t.exports=function(t,e,n){if(r(t),void 0===e)return t;switch(n){case 1:return function(n){return t.call(e,n)};case 2:return function(n,r){return t.call(e,n,r)};case 3:return function(n,r,i){return t.call(e,n,r,i)}}return function(){return t.apply(e,arguments)}}},function(t,e,n){"use strict";(function(t,r,i,o){n.d(e,"a",(function(){return l}));n(38),n(39),n(21),n(90),n(55),n(56),n(122),n(126);var a=n(89),s=n.n(a),u=n(61),c=n(104);function h(t){return(h="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function f(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var l=function(){function e(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e)}var n,a,l;return n=e,l=[{key:"clone",value:function(t){var n;if(null==t||"object"!=h(t))return t;if(t instanceof Date)return(n=new Date).setTime(t.getTime()),n;if(t instanceof Array){n=[];for(var r=0,i=t.length;r<i;r++)n[r]=e.clone(t[r]);return n}if(t instanceof c.a)return{};if(t instanceof u.a)return{};if(t instanceof Object){for(var o in n={},t)t.hasOwnProperty(o)&&(n[o]=e.clone(t[o]));return n}throw new Error("Unable to copy obj! Its type isn't supported.")}},{key:"fillMousePosBuffer",value:function(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:8,i=new ArrayBuffer(r),o=new DataView(i),a=t.getClientRects()[0],s=(e-a.left)/a.width,u=(n-a.top)/a.height;return o.setFloat32(0,s,!0),o.setFloat32(4,u,!0),i}},{key:"fillPinchPosBuffer",value:function(t,e,n,r,i,o,a){var s=new ArrayBuffer(16),u=new DataView(s);if(document.body.clientWidth*(a/o)<=window.innerHeight)var c=document.body.clientWidth*(a/o),h=document.body.clientWidth,f=t.offsetTop+(window.innerHeight-c)/2,l=t.offsetLeft;else c=window.innerHeight,h=window.innerHeight*(o/a),f=t.offsetTop,l=t.offsetLeft+(document.body.clientWidth-h)/2;var p=Math.max(0,Math.min(1,(e-l)/h)),d=Math.max(0,Math.min(1,(n-f)/c)),v=Math.max(0,Math.min(1,(r-l)/h)),y=Math.max(0,Math.min(1,(i-f)/c));return u.setFloat32(0,p,!0),u.setFloat32(4,d,!0),u.setFloat32(8,v,!0),u.setFloat32(12,y,!0),s}},{key:"arrayBufferToString",value:function(t){for(var e="",n=new Uint8Array(t),r=0;r<t.byteLength;++r)e+=String.fromCharCode(n[r]);return e}},{key:"matrixToTransform",value:function(e){var n=t.create(),o=r.create(),a=t.create();return i.getTranslation(n,e),i.getRotation(o,e),i.getScaling(a,e),{position:Array.from(n),orientation:Array.from(o),scale:Array.from(a)}}},{key:"serializeUUID",value:function(t,e,n){var r=new o(t),i=new Uint8Array(r.export()),a=new DataView(i.buffer),s=a.getUint32(0,!1),u=a.getUint16(4,!1),c=a.getUint16(6,!1);e.setUint32(n+0,s,!0),e.setUint16(n+4,u,!0),e.setUint16(n+6,c,!0);for(var h=8;h<16;h++)e.setUint8(n+h,a.getUint8(h),!0)}},{key:"resolveComponentDependencies",value:function(t,n){var r=SDK3DVerse.engineAPI.getComponentDescription(n).dependencies;if(r)for(var i in r)t.hasOwnProperty(r[i])||e.resolveComponentDependencies(t,r[i]);t[n]=SDK3DVerse.engineAPI.getComponentDefaultValue(n)}},{key:"getAssetFromEvent",value:function(t){var e=t.dataTransfer.getData("3dverse/asset");return e?JSON.parse(e):null}},{key:"preventIfEventContainsAsset",value:function(t){var e=-1!=t.dataTransfer.types.indexOf("3dverse/asset");return e&&t.preventDefault(),e}},{key:"getComponentClassNameFromAssetLabel",value:function(t){switch(t){case"Scene":return"scene_ref";case"Mesh":return"mesh_ref";case"Material":return"material_ref";case"Shader":return"material";case"Texture3D":return"volume_ref";case"VolumeMaterial":return"volume_material_ref";case"Script":return"script_map";default:return}}},{key:"alignForYUV",value:function(t,e){return{width:t-t%16,height:e-e%16}}},{key:"uuidToUint8Array",value:function(t){var e=new o(t),n=new Uint8Array(e.export()),r=new Uint8Array(n),i=new DataView(n.buffer),a=new DataView(r.buffer),s=i.getUint32(0,!1),u=i.getUint16(4,!1),c=i.getUint16(6,!1);return a.setUint32(0,s,!0),a.setUint16(4,u,!0),a.setUint16(6,c,!0),r}},{key:"generateRTID",value:function(){var t;if(1==arguments.length)t=e.uuidToUint8Array(arguments.length<=0?void 0:arguments[0]);else{t=new Uint8Array(8);var n=new DataView(t.buffer);this.writeRTID(arguments.length<=0?void 0:arguments[0],n,0),this.writeRTID(arguments.length<=1?void 0:arguments[1],n,4)}return s.a.h32().update(t.buffer).digest()}},{key:"readRTID",value:function(t,e){return t.getUint32(e,!0)}},{key:"writeRTID",value:function(t,e,n){"number"==typeof t?e.setUint32(n,t,!0):(e.setUint16(n+0,t._low,!0),e.setUint16(n+2,t._high,!0))}},{key:"getIdentityTransform",value:function(){return{position:[0,0,0],orientation:[0,0,0,1],scale:[1,1,1]}}},{key:"getXXH",value:function(){return s.a}},{key:"appendByteArray",value:function(t,e){var n=new Uint8Array((0|t.byteLength)+(0|e.byteLength));return n.set(t,0),n.set(e,0|t.byteLength),n}},{key:"hexToRgb",value:function(t){var e=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(t);return e?{r:parseInt(e[1],16),g:parseInt(e[2],16),b:parseInt(e[3],16)}:(console.warn("Invalid hex color :",t),null)}}],(a=null)&&f(n.prototype,a),l&&f(n,l),e}()}).call(this,n(12),n(91),n(94),n(133))},function(t,e){var n={}.hasOwnProperty;t.exports=function(t,e){return n.call(t,e)}},function(t,e,n){var r=n(4),i=n(10),o=n(15),a=n(19)("src"),s=n(105),u=(""+s).split("toString");n(18).inspectSource=function(t){return s.call(t)},(t.exports=function(t,e,n,s){var c="function"==typeof n;c&&(o(n,"name")||i(n,"name",e)),t[e]!==n&&(c&&(o(n,a)||i(n,a,t[e]?""+t[e]:u.join(String(e)))),t===r?t[e]=n:s?t[e]?t[e]=n:i(t,e,n):(delete t[e],i(t,e,n)))})(Function.prototype,"toString",(function(){return"function"==typeof this&&this[a]||s.call(this)}))},function(t,e,n){var r=n(28),i=Math.min;t.exports=function(t){return t>0?i(r(t),9007199254740991):0}},function(t,e){var n=t.exports={version:"2.6.4"};"number"==typeof __e&&(__e=n)},function(t,e){var n=0,r=Math.random();t.exports=function(t){return"Symbol(".concat(void 0===t?"":t,")_",(++n+r).toString(36))}},function(t,e){t.exports=!1},function(t,e,n){var r=n(2);r(r.S+r.F*!n(7),"Object",{defineProperty:n(6).f})},function(t,e,n){var r=n(29);t.exports=function(t){return Object(r(t))}},function(t,e,n){var r=n(66),i=n(29);t.exports=function(t){return r(i(t))}},function(t,e){var n={}.toString;t.exports=function(t){return n.call(t).slice(8,-1)}},function(t,e){t.exports={}},function(t,e){t.exports=function(t,e){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:e}}},function(t,e,n){var r=n(6).f,i=n(15),o=n(3)("toStringTag");t.exports=function(t,e,n){t&&!i(t=n?t:t.prototype,o)&&r(t,o,{configurable:!0,value:e})}},function(t,e){var n=Math.ceil,r=Math.floor;t.exports=function(t){return isNaN(t=+t)?0:(t>0?r:n)(t)}},function(t,e){t.exports=function(t){if(null==t)throw TypeError("Can't call method on  "+t);return t}},function(t,e,n){var r=n(69),i=n(50);t.exports=Object.keys||function(t){return r(t,i)}},function(t,e,n){var r=n(13),i=n(66),o=n(22),a=n(17),s=n(112);t.exports=function(t,e){var n=1==t,u=2==t,c=3==t,h=4==t,f=6==t,l=5==t||f,p=e||s;return function(e,s,d){for(var v,y,m=o(e),g=i(m),w=r(s,d,3),b=a(g.length),E=0,_=n?p(e,b):u?p(e,0):void 0;b>E;E++)if((l||E in g)&&(y=w(v=g[E],E,m),t))if(n)_[E]=y;else if(y)switch(t){case 3:return!0;case 5:return v;case 6:return E;case 2:_.push(v)}else if(h)return!1;return f?-1:c||h?h:_}}},function(t,e){t.exports=function(t){if("function"!=typeof t)throw TypeError(t+" is not a function!");return t}},function(t,e,n){var r=n(8),i=n(100),o=n(50),a=n(49)("IE_PROTO"),s=function(){},u=function(){var t,e=n(48)("iframe"),r=o.length;for(e.style.display="none",n(70).appendChild(e),e.src="javascript:",(t=e.contentWindow.document).open(),t.write("<script>document.F=Object<\/script>"),t.close(),u=t.F;r--;)delete u.prototype[o[r]];return u()};t.exports=Object.create||function(t,e){var n;return null!==t?(s.prototype=r(t),n=new s,s.prototype=null,n[a]=t):n=u(),void 0===e?n:i(n,e)}},function(t,e,n){var r=n(18),i=n(4),o=i["__core-js_shared__"]||(i["__core-js_shared__"]={});(t.exports=function(t,e){return o[t]||(o[t]=void 0!==e?e:{})})("versions",[]).push({version:r.version,mode:n(20)?"pure":"global",copyright:"© 2019 Denis Pushkarev (zloirock.ru)"})},function(t,e,n){"use strict";var r=n(44),i=n(82),o=n(25),a=n(23);t.exports=n(58)(Array,"Array",(function(t,e){this._t=a(t),this._i=0,this._k=e}),(function(){var t=this._t,e=this._k,n=this._i++;return!t||n>=t.length?(this._t=void 0,i(1)):i(0,"keys"==e?n:"values"==e?t[n]:[n,t[n]])}),"values"),o.Arguments=o.Array,r("keys"),r("values"),r("entries")},function(t,e,n){"use strict";var r=n(9);t.exports=function(t,e){return!!t&&r((function(){e?t.call(null,(function(){}),1):t.call(null)}))}},function(t,e,n){var r=n(5);t.exports=function(t,e){if(!r(t))return t;var n,i;if(e&&"function"==typeof(n=t.toString)&&!r(i=n.call(t)))return i;if("function"==typeof(n=t.valueOf)&&!r(i=n.call(t)))return i;if(!e&&"function"==typeof(n=t.toString)&&!r(i=n.call(t)))return i;throw TypeError("Can't convert object to primitive value")}},function(t,e,n){n(73)("asyncIterator")},function(t,e,n){"use strict";var r=n(4),i=n(15),o=n(7),a=n(2),s=n(16),u=n(65).KEY,c=n(9),h=n(34),f=n(27),l=n(19),p=n(3),d=n(74),v=n(73),y=n(114),m=n(53),g=n(8),w=n(5),b=n(23),E=n(37),_=n(26),A=n(33),x=n(115),k=n(54),T=n(6),S=n(30),C=k.f,R=T.f,P=x.f,I=r.Symbol,M=r.JSON,U=M&&M.stringify,O=p("_hidden"),D=p("toPrimitive"),L={}.propertyIsEnumerable,N=h("symbol-registry"),F=h("symbols"),B=h("op-symbols"),V=Object.prototype,j="function"==typeof I,Y=r.QObject,G=!Y||!Y.prototype||!Y.prototype.findChild,W=o&&c((function(){return 7!=A(R({},"a",{get:function(){return R(this,"a",{value:7}).a}})).a}))?function(t,e,n){var r=C(V,e);r&&delete V[e],R(t,e,n),r&&t!==V&&R(V,e,r)}:R,q=function(t){var e=F[t]=A(I.prototype);return e._k=t,e},z=j&&"symbol"==typeof I.iterator?function(t){return"symbol"==typeof t}:function(t){return t instanceof I},X=function(t,e,n){return t===V&&X(B,e,n),g(t),e=E(e,!0),g(n),i(F,e)?(n.enumerable?(i(t,O)&&t[O][e]&&(t[O][e]=!1),n=A(n,{enumerable:_(0,!1)})):(i(t,O)||R(t,O,_(1,{})),t[O][e]=!0),W(t,e,n)):R(t,e,n)},H=function(t,e){g(t);for(var n,r=y(e=b(e)),i=0,o=r.length;o>i;)X(t,n=r[i++],e[n]);return t},K=function(t){var e=L.call(this,t=E(t,!0));return!(this===V&&i(F,t)&&!i(B,t))&&(!(e||!i(this,t)||!i(F,t)||i(this,O)&&this[O][t])||e)},J=function(t,e){if(t=b(t),e=E(e,!0),t!==V||!i(F,e)||i(B,e)){var n=C(t,e);return!n||!i(F,e)||i(t,O)&&t[O][e]||(n.enumerable=!0),n}},Q=function(t){for(var e,n=P(b(t)),r=[],o=0;n.length>o;)i(F,e=n[o++])||e==O||e==u||r.push(e);return r},$=function(t){for(var e,n=t===V,r=P(n?B:b(t)),o=[],a=0;r.length>a;)!i(F,e=r[a++])||n&&!i(V,e)||o.push(F[e]);return o};j||(s((I=function(){if(this instanceof I)throw TypeError("Symbol is not a constructor!");var t=l(arguments.length>0?arguments[0]:void 0),e=function(n){this===V&&e.call(B,n),i(this,O)&&i(this[O],t)&&(this[O][t]=!1),W(this,t,_(1,n))};return o&&G&&W(V,t,{configurable:!0,set:e}),q(t)}).prototype,"toString",(function(){return this._k})),k.f=J,T.f=X,n(43).f=x.f=Q,n(47).f=K,n(67).f=$,o&&!n(20)&&s(V,"propertyIsEnumerable",K,!0),d.f=function(t){return q(p(t))}),a(a.G+a.W+a.F*!j,{Symbol:I});for(var Z="hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables".split(","),tt=0;Z.length>tt;)p(Z[tt++]);for(var et=S(p.store),nt=0;et.length>nt;)v(et[nt++]);a(a.S+a.F*!j,"Symbol",{for:function(t){return i(N,t+="")?N[t]:N[t]=I(t)},keyFor:function(t){if(!z(t))throw TypeError(t+" is not a symbol!");for(var e in N)if(N[e]===t)return e},useSetter:function(){G=!0},useSimple:function(){G=!1}}),a(a.S+a.F*!j,"Object",{create:function(t,e){return void 0===e?A(t):H(A(t),e)},defineProperty:X,defineProperties:H,getOwnPropertyDescriptor:J,getOwnPropertyNames:Q,getOwnPropertySymbols:$}),M&&a(a.S+a.F*(!j||c((function(){var t=I();return"[null]"!=U([t])||"{}"!=U({a:t})||"{}"!=U(Object(t))}))),"JSON",{stringify:function(t){for(var e,n,r=[t],i=1;arguments.length>i;)r.push(arguments[i++]);if(n=e=r[1],(w(e)||void 0!==t)&&!z(t))return m(e)||(e=function(t,e){if("function"==typeof n&&(e=n.call(this,t,e)),!z(e))return e}),r[1]=e,U.apply(M,r)}}),I.prototype[D]||n(10)(I.prototype,D,I.prototype.valueOf),f(I,"Symbol"),f(Math,"Math",!0),f(r.JSON,"JSON",!0)},function(t,e,n){for(var r=n(35),i=n(30),o=n(16),a=n(4),s=n(10),u=n(25),c=n(3),h=c("iterator"),f=c("toStringTag"),l=u.Array,p={CSSRuleList:!0,CSSStyleDeclaration:!1,CSSValueList:!1,ClientRectList:!1,DOMRectList:!1,DOMStringList:!1,DOMTokenList:!0,DataTransferItemList:!1,FileList:!1,HTMLAllCollection:!1,HTMLCollection:!1,HTMLFormElement:!1,HTMLSelectElement:!1,MediaList:!0,MimeTypeArray:!1,NamedNodeMap:!1,NodeList:!0,PaintRequestList:!1,Plugin:!1,PluginArray:!1,SVGLengthList:!1,SVGNumberList:!1,SVGPathSegList:!1,SVGPointList:!1,SVGStringList:!1,SVGTransformList:!1,SourceBufferList:!1,StyleSheetList:!0,TextTrackCueList:!1,TextTrackList:!1,TouchList:!1},d=i(p),v=0;v<d.length;v++){var y,m=d[v],g=p[m],w=a[m],b=w&&w.prototype;if(b&&(b[h]||s(b,h,l),b[f]||s(b,f,m),u[m]=l,g))for(y in r)b[y]||o(b,y,r[y],!0)}},function(t,e){t.exports=function(t,e,n,r){if(!(t instanceof e)||void 0!==r&&r in t)throw TypeError(n+": incorrect invocation!");return t}},function(t,e,n){var r=n(16);t.exports=function(t,e,n){for(var i in e)r(t,i,e[i],n);return t}},function(t,e,n){var r=n(69),i=n(50).concat("length","prototype");e.f=Object.getOwnPropertyNames||function(t){return r(t,i)}},function(t,e,n){var r=n(3)("unscopables"),i=Array.prototype;null==i[r]&&n(10)(i,r,{}),t.exports=function(t){i[r][t]=!0}},function(t,e,n){var r=n(23),i=n(17),o=n(51);t.exports=function(t){return function(e,n,a){var s,u=r(e),c=i(u.length),h=o(a,c);if(t&&n!=n){for(;c>h;)if((s=u[h++])!=s)return!0}else for(;c>h;h++)if((t||h in u)&&u[h]===n)return t||h||0;return!t&&-1}}},function(t,e,n){var r=n(3)("iterator"),i=!1;try{var o=[7][r]();o.return=function(){i=!0},Array.from(o,(function(){throw 2}))}catch(t){}t.exports=function(t,e){if(!e&&!i)return!1;var n=!1;try{var o=[7],a=o[r]();a.next=function(){return{done:n=!0}},o[r]=function(){return a},t(o)}catch(t){}return n}},function(t,e){e.f={}.propertyIsEnumerable},function(t,e,n){var r=n(5),i=n(4).document,o=r(i)&&r(i.createElement);t.exports=function(t){return o?i.createElement(t):{}}},function(t,e,n){var r=n(34)("keys"),i=n(19);t.exports=function(t){return r[t]||(r[t]=i(t))}},function(t,e){t.exports="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",")},function(t,e,n){var r=n(28),i=Math.max,o=Math.min;t.exports=function(t,e){return(t=r(t))<0?i(t+e,0):o(t,e)}},function(t,e,n){var r=n(24),i=n(3)("toStringTag"),o="Arguments"==r(function(){return arguments}());t.exports=function(t){var e,n,a;return void 0===t?"Undefined":null===t?"Null":"string"==typeof(n=function(t,e){try{return t[e]}catch(t){}}(e=Object(t),i))?n:o?r(e):"Object"==(a=r(e))&&"function"==typeof e.callee?"Arguments":a}},function(t,e,n){var r=n(24);t.exports=Array.isArray||function(t){return"Array"==r(t)}},function(t,e,n){var r=n(47),i=n(26),o=n(23),a=n(37),s=n(15),u=n(68),c=Object.getOwnPropertyDescriptor;e.f=n(7)?c:function(t,e){if(t=o(t),e=a(e,!0),u)try{return c(t,e)}catch(t){}if(s(t,e))return i(!r.f.call(t,e),t[e])}},function(t,e,n){"use strict";var r=n(121)(!0);n(58)(String,"String",(function(t){this._t=String(t),this._i=0}),(function(){var t,e=this._t,n=this._i;return n>=e.length?{value:void 0,done:!0}:(t=r(e,n),this._i+=t.length,{value:t,done:!1})}))},function(t,e,n){"use strict";var r=n(13),i=n(2),o=n(22),a=n(77),s=n(59),u=n(17),c=n(125),h=n(60);i(i.S+i.F*!n(46)((function(t){Array.from(t)})),"Array",{from:function(t){var e,n,i,f,l=o(t),p="function"==typeof this?this:Array,d=arguments.length,v=d>1?arguments[1]:void 0,y=void 0!==v,m=0,g=h(l);if(y&&(v=r(v,d>2?arguments[2]:void 0,2)),null==g||p==Array&&s(g))for(n=new p(e=u(l.length));e>m;m++)c(n,m,y?v(l[m],m):l[m]);else for(f=g.call(l),n=new p;!(i=f.next()).done;m++)c(n,m,y?a(f,v,[i.value,m],!0):i.value);return n.length=m,n}})},function(t,e,n){"use strict";var r,i,o,a,s=n(20),u=n(4),c=n(13),h=n(52),f=n(2),l=n(5),p=n(32),d=n(41),v=n(63),y=n(79),m=n(71).set,g=n(107)(),w=n(72),b=n(108),E=n(102),_=n(109),A=u.TypeError,x=u.process,k=x&&x.versions,T=k&&k.v8||"",S=u.Promise,C="process"==h(x),R=function(){},P=i=w.f,I=!!function(){try{var t=S.resolve(1),e=(t.constructor={})[n(3)("species")]=function(t){t(R,R)};return(C||"function"==typeof PromiseRejectionEvent)&&t.then(R)instanceof e&&0!==T.indexOf("6.6")&&-1===E.indexOf("Chrome/66")}catch(t){}}(),M=function(t){var e;return!(!l(t)||"function"!=typeof(e=t.then))&&e},U=function(t,e){if(!t._n){t._n=!0;var n=t._c;g((function(){for(var r=t._v,i=1==t._s,o=0,a=function(e){var n,o,a,s=i?e.ok:e.fail,u=e.resolve,c=e.reject,h=e.domain;try{s?(i||(2==t._h&&L(t),t._h=1),!0===s?n=r:(h&&h.enter(),n=s(r),h&&(h.exit(),a=!0)),n===e.promise?c(A("Promise-chain cycle")):(o=M(n))?o.call(n,u,c):u(n)):c(r)}catch(t){h&&!a&&h.exit(),c(t)}};n.length>o;)a(n[o++]);t._c=[],t._n=!1,e&&!t._h&&O(t)}))}},O=function(t){m.call(u,(function(){var e,n,r,i=t._v,o=D(t);if(o&&(e=b((function(){C?x.emit("unhandledRejection",i,t):(n=u.onunhandledrejection)?n({promise:t,reason:i}):(r=u.console)&&r.error&&r.error("Unhandled promise rejection",i)})),t._h=C||D(t)?2:1),t._a=void 0,o&&e.e)throw e.v}))},D=function(t){return 1!==t._h&&0===(t._a||t._c).length},L=function(t){m.call(u,(function(){var e;C?x.emit("rejectionHandled",t):(e=u.onrejectionhandled)&&e({promise:t,reason:t._v})}))},N=function(t){var e=this;e._d||(e._d=!0,(e=e._w||e)._v=t,e._s=2,e._a||(e._a=e._c.slice()),U(e,!0))},F=function(t){var e,n=this;if(!n._d){n._d=!0,n=n._w||n;try{if(n===t)throw A("Promise can't be resolved itself");(e=M(t))?g((function(){var r={_w:n,_d:!1};try{e.call(t,c(F,r,1),c(N,r,1))}catch(t){N.call(r,t)}})):(n._v=t,n._s=1,U(n,!1))}catch(t){N.call({_w:n,_d:!1},t)}}};I||(S=function(t){d(this,S,"Promise","_h"),p(t),r.call(this);try{t(c(F,this,1),c(N,this,1))}catch(t){N.call(this,t)}},(r=function(t){this._c=[],this._a=void 0,this._s=0,this._d=!1,this._v=void 0,this._h=0,this._n=!1}).prototype=n(42)(S.prototype,{then:function(t,e){var n=P(y(this,S));return n.ok="function"!=typeof t||t,n.fail="function"==typeof e&&e,n.domain=C?x.domain:void 0,this._c.push(n),this._a&&this._a.push(n),this._s&&U(this,!1),n.promise},catch:function(t){return this.then(void 0,t)}}),o=function(){var t=new r;this.promise=t,this.resolve=c(F,t,1),this.reject=c(N,t,1)},w.f=P=function(t){return t===S||t===a?new o(t):i(t)}),f(f.G+f.W+f.F*!I,{Promise:S}),n(27)(S,"Promise"),n(64)("Promise"),a=n(18).Promise,f(f.S+f.F*!I,"Promise",{reject:function(t){var e=P(this);return(0,e.reject)(t),e.promise}}),f(f.S+f.F*(s||!I),"Promise",{resolve:function(t){return _(s&&this===a?S:this,t)}}),f(f.S+f.F*!(I&&n(46)((function(t){S.all(t).catch(R)}))),"Promise",{all:function(t){var e=this,n=P(e),r=n.resolve,i=n.reject,o=b((function(){var n=[],o=0,a=1;v(t,!1,(function(t){var s=o++,u=!1;n.push(void 0),a++,e.resolve(t).then((function(t){u||(u=!0,n[s]=t,--a||r(n))}),i)})),--a||r(n)}));return o.e&&i(o.v),n.promise},race:function(t){var e=this,n=P(e),r=n.reject,i=b((function(){v(t,!1,(function(t){e.resolve(t).then(n.resolve,r)}))}));return i.e&&r(i.v),n.promise}})},function(t,e,n){"use strict";var r=n(20),i=n(2),o=n(16),a=n(10),s=n(25),u=n(106),c=n(27),h=n(78),f=n(3)("iterator"),l=!([].keys&&"next"in[].keys()),p=function(){return this};t.exports=function(t,e,n,d,v,y,m){u(n,e,d);var g,w,b,E=function(t){if(!l&&t in k)return k[t];switch(t){case"keys":case"values":return function(){return new n(this,t)}}return function(){return new n(this,t)}},_=e+" Iterator",A="values"==v,x=!1,k=t.prototype,T=k[f]||k["@@iterator"]||v&&k[v],S=T||E(v),C=v?A?E("entries"):S:void 0,R="Array"==e&&k.entries||T;if(R&&(b=h(R.call(new t)))!==Object.prototype&&b.next&&(c(b,_,!0),r||"function"==typeof b[f]||a(b,f,p)),A&&T&&"values"!==T.name&&(x=!0,S=function(){return T.call(this)}),r&&!m||!l&&!x&&k[f]||a(k,f,S),s[e]=S,s[_]=p,v)if(g={values:A?S:E("values"),keys:y?S:E("keys"),entries:C},m)for(w in g)w in k||o(k,w,g[w]);else i(i.P+i.F*(l||x),e,g);return g}},function(t,e,n){var r=n(25),i=n(3)("iterator"),o=Array.prototype;t.exports=function(t){return void 0!==t&&(r.Array===t||o[i]===t)}},function(t,e,n){var r=n(52),i=n(3)("iterator"),o=n(25);t.exports=n(18).getIteratorMethod=function(t){if(null!=t)return t[i]||t["@@iterator"]||o[r(t)]}},function(t,e,n){"use strict";(function(t,r,i){n(85),n(86),n(38),n(39),n(95),n(92),n(40),n(35),n(103),n(21),n(99),n(55),n(56),n(96),n(75),n(97);var o=n(14);function a(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function s(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(t){return Object.getOwnPropertyDescriptor(n,t).enumerable})))),r.forEach((function(e){u(t,e,n[e])}))}return t}function u(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function c(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var h=t.fromValues(0,0,1),f=function(){function e(t,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),this.registry=t,this.rtid=n.rtid,this.children=n.children,this.components=n.components,this.visible=n.isVisible,this.external=n.isExternal,this.runtime=n.isRuntime,this.transient=n.isTransient,this.selected=!1,this.overrider=null,this.overriddenEntity=null,this.linker=null,this.attachedComponents=[],this.detachedComponents=[],this.dirtyComponents=[],this.unsavedComponents=[]}var n,u,f;return n=e,(u=[{key:"getID",value:function(){return this.rtid}},{key:"getEUID",value:function(){return this.components.euid.value}},{key:"isVisible",value:function(){return this.visible}},{key:"isExternal",value:function(){return this.external}},{key:"isRuntime",value:function(){return this.runtime}},{key:"isSelected",value:function(){return this.selected}},{key:"getName",value:function(){return(this.components.debug_name?this.components.debug_name.value:"")||"No name"}},{key:"getParent",value:function(){if(!this.hasParent())return null;var t=this.getComponent("lineage").ancestorRTID,e=this.registry.getEntity(t);return e||void 0}},{key:"getAncestors",value:function(){for(var t=this,e=[];t=t.getParent();)e.push(t);return e}},{key:"hasParent",value:function(){return this.isAttached("lineage")&&this.getComponent("lineage").hasOwnProperty("ancestorRTID")}},{key:"hasChildren",value:function(){return this.children.length>0||this.isLinker()}},{key:"getLinkerLineage",value:function(){for(var t=this.linker,e=[];t;)e.push(t.getEUID()),t=t.linker;return e}},{key:"resolveLinker",value:function(){this.linker=this.getLinker(),this.linker&&!this.components.lineage.ancestorRTID&&(this.components.lineage.ancestorRTID=this.linker.rtid)}},{key:"getLinker",value:function(){var t=this.getComponent("lineage");if(!t||0==t.value.length)return null;var e=t.value[0],n=this.registry.getEntitiesByEUID(e);if(0==n.length)return console.warn("Cannot find linker EUID ".concat(e)),null;if(1==n.length)return n[0];var r=t.value.slice(1);for(var i in n){var o=n[i],a=o.components.lineage.value;if(a.length==r.length){var s=!0;for(var u in a)if(a[u]!=r[u]){s=!1;break}if(s)return o}}console.warn("Cannot find appropriate linker for ".concat(this.getEUID()))}},{key:"isLinker",value:function(){return!!this.components.scene_ref}},{key:"isOverrider",value:function(){return!!this.components.overrider}},{key:"isOverridden",value:function(){return this.components.overridden&&this.overrider}},{key:"isMarkedAsDeleted",value:function(){return this.isOverridden()&&this.overrider.getComponent("overrider").deleter||this.getParent()&&this.getParent().isMarkedAsDeleted()}},{key:"isAttached",value:function(t){return this.components.hasOwnProperty(t)||this.isComponentOverridden(t)}},{key:"getComponent",value:function(t){return this.isComponentOverridden(t)?this.overrider.getComponent(t):this.isAttached(t)?s({},this.registry.getComponentDefaultValue(t),this.components[t]):(console.warn("Attempt to get the value of an unattached component (".concat(t,") on ").concat(this.getName()," (").concat(this.getID(),")")),null)}},{key:"UNSAFE_getComponent",value:function(t){return this.components[t]}},{key:"getComponents",value:function(){var t=this.isOverridden()?this.overrider.getComponents():{},e={};for(var n in this.components)e[n]=this.getComponent(n);for(var n in t)this.isComponentOverridable(n)&&(e[n]=t[n]);return e}},{key:"isComponentOverridden",value:function(t){return this.isComponentOverridable(t)&&this.overrider&&this.overrider.isAttached(t)}},{key:"isComponentOverridable",value:function(t){return!["lineage","euid","overrider"].includes(t)}},{key:"attachComponent",value:function(t,e){this.isAttached(t)?console.warn("Cannot attach component ".concat(t," that is already attached")):(this.UNSAFE_attachComponent(t,e),this.attachedComponents.push(t),this.registry.setDirtyEntity(this))}},{key:"detachComponent",value:function(t){this.isAttached(t)?(this.UNSAFE_detachComponent(t),this.unsavedComponents=this.unsavedComponents.filter((function(e){return e!=t})),this.detachedComponents.push(t),this.registry.setDirtyEntity(this)):console.warn("Cannot detach component ".concat(t," that is not attached"))}},{key:"setComponent",value:function(t,e){this.isAttached(t)?this.isComponentOverridden(t)?this.overrider.setComponent(t,e):(this.UNSAFE_setComponent(t,e),this.setDirty(t)):console.warn("Cannot update component ".concat(t," that is not attached"))}},{key:"UNSAFE_setComponent",value:function(t,e){this.components[t]=s({},this.components[t],e)}},{key:"UNSAFE_attachComponent",value:function(t,e){this.components[t]=e}},{key:"UNSAFE_detachComponent",value:function(t){delete this.components[t]}},{key:"setDirty",value:function(t){this.transient||(this.UNSAFE_setDirty(t),this.unsavedComponents.includes(t)||this.unsavedComponents.push(t),this.registry.setDirtyEntity(this))}},{key:"UNSAFE_setDirty",value:function(t){this.dirtyComponents.includes(t)||this.dirtyComponents.push(t)}},{key:"isSame",value:function(t){return t&&this.getID()==t.getID()}},{key:"getLocalMatrix",value:function(){var e=r.create(),n=this.getComponent("local_transform");return r.fromRotationTranslationScale(e,i.fromValues(n.orientation[0],n.orientation[1],n.orientation[2],n.orientation[3]),t.fromValues(n.position[0],n.position[1],n.position[2]),t.fromValues(n.scale[0],n.scale[1],n.scale[2])),e}},{key:"getParentGlobalMatrix",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=this.getParent();return e?e.getGlobalMatrix(t):r.create()}},{key:"getGlobalMatrix",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=this.getLocalMatrix();if(t&&t.isSame(this.getParent()))return e;var n=r.create(),i=this.getParentGlobalMatrix(t);return r.mul(n,i,e),n}},{key:"getParentGlobalTransform",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=this.getParent();return e?e.getGlobalTransform(t):o.a.getIdentityTransform()}},{key:"getGlobalTransform",value:function(){var e,n,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,o=this.getComponent("local_transform");if(r&&r.isSame(this.getParent()))return o;var s=this.getParentGlobalTransform(r),u=this.getParentGlobalMatrix(r),c=t.fromValues(o.position[0],o.position[1],o.position[2]),h=i.fromValues(o.orientation[0],o.orientation[1],o.orientation[2],o.orientation[3]),f=t.fromValues(o.scale[0],o.scale[1],o.scale[2]),l=t.create(),p=i.create(),d=t.create();return t.transformMat4(l,c,u),i.mul(p,(e=i).fromValues.apply(e,a(s.orientation)),h),t.mul(d,(n=t).fromValues.apply(n,a(s.scale)),f),{position:Array.from(l),orientation:Array.from(p),scale:Array.from(d)}}},{key:"setGlobalTransform",value:function(t){t.position&&this.setPosition(t.position),t.orientation&&this.setOrientation(t.orientation),t.scale&&this.setScale(t.scale)}},{key:"computeGlobalTransformFromEntity",value:function(e,n){var s,u,c=n?n.getGlobalTransform():o.a.getIdentityTransform(),h=n?n.getGlobalMatrix():r.create();e.position&&this.setPosition(e.position,h),e.orientation&&this.setOrientation(e.orientation,(s=i).fromValues.apply(s,a(c.orientation))),e.scale&&this.setScale(e.scale,(u=t).fromValues.apply(u,a(c.scale)))}},{key:"setPosition",value:function(e){var n,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,o=t.create(),s=r.create(),u=i||this.getParentGlobalMatrix();r.invert(s,u),t.transformMat4(o,(n=t).fromValues.apply(n,a(e)),s),this.setComponent("local_transform",{position:Array.from(o)})}},{key:"setOrientation",value:function(t,e){var n,r,o=i.create(),s=i.create(),u=e||(n=i).fromValues.apply(n,a(this.getParentGlobalTransform().orientation));i.conjugate(s,u),i.mul(o,s,(r=i).fromValues.apply(r,a(t))),this.setComponent("local_transform",{orientation:Array.from(o)})}},{key:"setScale",value:function(e,n){var r,i,o=t.create(),s=n||(r=t).fromValues.apply(r,a(this.getParentGlobalTransform().scale));t.div(o,(i=t).fromValues.apply(i,a(e)),s),this.setComponent("local_transform",{scale:Array.from(o)})}},{key:"lookAt",value:function(e){var n,r=(n=t).fromValues.apply(n,a(e)),o=this.getGlobalTransform().position,s=t.create();t.sub(s,r,o),t.normalize(s,s);var u=i.create();i.rotationTo(u,h,s),this.setOrientation(u)}},{key:"focusOn",value:function(e){if(this.isAttached("local_transform")){var n=e.getTransform(),o=this.getGlobalTransform().position,a=t.create();t.sub(a,o,n.position),t.normalize(a,a);var s=t.distance(n.position,o),u=t.create();t.scaleAndAdd(u,n.position,a,.9*s);var c=t.create();t.cross(c,a,t.fromValues(0,1,0));var h=t.create();t.cross(h,c,a);var f=r.create();r.targetTo(f,u,o,h);var l=i.create();r.getRotation(l,f);var p=.5*s;SDK3DVerse.engineAPI.cameraAPI.travel(e,u,l,p)}}}])&&c(n.prototype,u),f&&c(n,f),e}();e.a=f}).call(this,n(12),n(94),n(91))},function(t,e){!function(e){"use strict";var n=Object.prototype,r=n.hasOwnProperty,i="function"==typeof Symbol?Symbol:{},o=i.iterator||"@@iterator",a=i.asyncIterator||"@@asyncIterator",s=i.toStringTag||"@@toStringTag",u="object"==typeof t,c=e.regeneratorRuntime;if(c)u&&(t.exports=c);else{(c=e.regeneratorRuntime=u?t.exports:{}).wrap=v;var h={},f={};f[o]=function(){return this};var l=Object.getPrototypeOf,p=l&&l(l(T([])));p&&p!==n&&r.call(p,o)&&(f=p);var d=w.prototype=m.prototype=Object.create(f);g.prototype=d.constructor=w,w.constructor=g,w[s]=g.displayName="GeneratorFunction",c.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===g||"GeneratorFunction"===(e.displayName||e.name))},c.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,w):(t.__proto__=w,s in t||(t[s]="GeneratorFunction")),t.prototype=Object.create(d),t},c.awrap=function(t){return{__await:t}},b(E.prototype),E.prototype[a]=function(){return this},c.AsyncIterator=E,c.async=function(t,e,n,r){var i=new E(v(t,e,n,r));return c.isGeneratorFunction(e)?i:i.next().then((function(t){return t.done?t.value:i.next()}))},b(d),d[s]="Generator",d[o]=function(){return this},d.toString=function(){return"[object Generator]"},c.keys=function(t){var e=[];for(var n in t)e.push(n);return e.reverse(),function n(){for(;e.length;){var r=e.pop();if(r in t)return n.value=r,n.done=!1,n}return n.done=!0,n}},c.values=T,k.prototype={constructor:k,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(x),!t)for(var e in this)"t"===e.charAt(0)&&r.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function n(n,r){return a.type="throw",a.arg=t,e.next=n,r&&(e.method="next",e.arg=void 0),!!r}for(var i=this.tryEntries.length-1;i>=0;--i){var o=this.tryEntries[i],a=o.completion;if("root"===o.tryLoc)return n("end");if(o.tryLoc<=this.prev){var s=r.call(o,"catchLoc"),u=r.call(o,"finallyLoc");if(s&&u){if(this.prev<o.catchLoc)return n(o.catchLoc,!0);if(this.prev<o.finallyLoc)return n(o.finallyLoc)}else if(s){if(this.prev<o.catchLoc)return n(o.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return n(o.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&r.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===t||"continue"===t)&&o.tryLoc<=e&&e<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=t,a.arg=e,o?(this.method="next",this.next=o.finallyLoc,h):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),h},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),x(n),h}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var i=r.arg;x(n)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,n){return this.delegate={iterator:T(t),resultName:e,nextLoc:n},"next"===this.method&&(this.arg=void 0),h}}}function v(t,e,n,r){var i=e&&e.prototype instanceof m?e:m,o=Object.create(i.prototype),a=new k(r||[]);return o._invoke=function(t,e,n){var r="suspendedStart";return function(i,o){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===i)throw o;return S()}for(n.method=i,n.arg=o;;){var a=n.delegate;if(a){var s=_(a,n);if(s){if(s===h)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r="executing";var u=y(t,e,n);if("normal"===u.type){if(r=n.done?"completed":"suspendedYield",u.arg===h)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(r="completed",n.method="throw",n.arg=u.arg)}}}(t,n,a),o}function y(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}function m(){}function g(){}function w(){}function b(t){["next","throw","return"].forEach((function(e){t[e]=function(t){return this._invoke(e,t)}}))}function E(t){var e;this._invoke=function(n,i){function o(){return new Promise((function(e,o){!function e(n,i,o,a){var s=y(t[n],t,i);if("throw"!==s.type){var u=s.arg,c=u.value;return c&&"object"==typeof c&&r.call(c,"__await")?Promise.resolve(c.__await).then((function(t){e("next",t,o,a)}),(function(t){e("throw",t,o,a)})):Promise.resolve(c).then((function(t){u.value=t,o(u)}),(function(t){return e("throw",t,o,a)}))}a(s.arg)}(n,i,e,o)}))}return e=e?e.then(o,o):o()}}function _(t,e){var n=t.iterator[e.method];if(void 0===n){if(e.delegate=null,"throw"===e.method){if(t.iterator.return&&(e.method="return",e.arg=void 0,_(t,e),"throw"===e.method))return h;e.method="throw",e.arg=new TypeError("The iterator does not provide a 'throw' method")}return h}var r=y(n,t.iterator,e.arg);if("throw"===r.type)return e.method="throw",e.arg=r.arg,e.delegate=null,h;var i=r.arg;return i?i.done?(e[t.resultName]=i.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,h):i:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,h)}function A(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function x(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function k(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(A,this),this.reset(!0)}function T(t){if(t){var e=t[o];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var n=-1,i=function e(){for(;++n<t.length;)if(r.call(t,n))return e.value=t[n],e.done=!1,e;return e.value=void 0,e.done=!0,e};return i.next=i}}return{next:S}}function S(){return{value:void 0,done:!0}}}(function(){return this||"object"==typeof self&&self}()||Function("return this")())},function(t,e,n){var r=n(13),i=n(77),o=n(59),a=n(8),s=n(17),u=n(60),c={},h={};(e=t.exports=function(t,e,n,f,l){var p,d,v,y,m=l?function(){return t}:u(t),g=r(n,f,e?2:1),w=0;if("function"!=typeof m)throw TypeError(t+" is not iterable!");if(o(m)){for(p=s(t.length);p>w;w++)if((y=e?g(a(d=t[w])[0],d[1]):g(t[w]))===c||y===h)return y}else for(v=m.call(t);!(d=v.next()).done;)if((y=i(v,g,d.value,e))===c||y===h)return y}).BREAK=c,e.RETURN=h},function(t,e,n){"use strict";var r=n(4),i=n(6),o=n(7),a=n(3)("species");t.exports=function(t){var e=r[t];o&&e&&!e[a]&&i.f(e,a,{configurable:!0,get:function(){return this}})}},function(t,e,n){var r=n(19)("meta"),i=n(5),o=n(15),a=n(6).f,s=0,u=Object.isExtensible||function(){return!0},c=!n(9)((function(){return u(Object.preventExtensions({}))})),h=function(t){a(t,r,{value:{i:"O"+ ++s,w:{}}})},f=t.exports={KEY:r,NEED:!1,fastKey:function(t,e){if(!i(t))return"symbol"==typeof t?t:("string"==typeof t?"S":"P")+t;if(!o(t,r)){if(!u(t))return"F";if(!e)return"E";h(t)}return t[r].i},getWeak:function(t,e){if(!o(t,r)){if(!u(t))return!0;if(!e)return!1;h(t)}return t[r].w},onFreeze:function(t){return c&&f.NEED&&u(t)&&!o(t,r)&&h(t),t}}},function(t,e,n){var r=n(24);t.exports=Object("z").propertyIsEnumerable(0)?Object:function(t){return"String"==r(t)?t.split(""):Object(t)}},function(t,e){e.f=Object.getOwnPropertySymbols},function(t,e,n){t.exports=!n(7)&&!n(9)((function(){return 7!=Object.defineProperty(n(48)("div"),"a",{get:function(){return 7}}).a}))},function(t,e,n){var r=n(15),i=n(23),o=n(45)(!1),a=n(49)("IE_PROTO");t.exports=function(t,e){var n,s=i(t),u=0,c=[];for(n in s)n!=a&&r(s,n)&&c.push(n);for(;e.length>u;)r(s,n=e[u++])&&(~o(c,n)||c.push(n));return c}},function(t,e,n){var r=n(4).document;t.exports=r&&r.documentElement},function(t,e,n){var r,i,o,a=n(13),s=n(101),u=n(70),c=n(48),h=n(4),f=h.process,l=h.setImmediate,p=h.clearImmediate,d=h.MessageChannel,v=h.Dispatch,y=0,m={},g=function(){var t=+this;if(m.hasOwnProperty(t)){var e=m[t];delete m[t],e()}},w=function(t){g.call(t.data)};l&&p||(l=function(t){for(var e=[],n=1;arguments.length>n;)e.push(arguments[n++]);return m[++y]=function(){s("function"==typeof t?t:Function(t),e)},r(y),y},p=function(t){delete m[t]},"process"==n(24)(f)?r=function(t){f.nextTick(a(g,t,1))}:v&&v.now?r=function(t){v.now(a(g,t,1))}:d?(o=(i=new d).port2,i.port1.onmessage=w,r=a(o.postMessage,o,1)):h.addEventListener&&"function"==typeof postMessage&&!h.importScripts?(r=function(t){h.postMessage(t+"","*")},h.addEventListener("message",w,!1)):r="onreadystatechange"in c("script")?function(t){u.appendChild(c("script")).onreadystatechange=function(){u.removeChild(this),g.call(t)}}:function(t){setTimeout(a(g,t,1),0)}),t.exports={set:l,clear:p}},function(t,e,n){"use strict";var r=n(32);function i(t){var e,n;this.promise=new t((function(t,r){if(void 0!==e||void 0!==n)throw TypeError("Bad Promise constructor");e=t,n=r})),this.resolve=r(e),this.reject=r(n)}t.exports.f=function(t){return new i(t)}},function(t,e,n){var r=n(4),i=n(18),o=n(20),a=n(74),s=n(6).f;t.exports=function(t){var e=i.Symbol||(i.Symbol=o?{}:r.Symbol||{});"_"==t.charAt(0)||t in e||s(e,t,{value:a.f(t)})}},function(t,e,n){e.f=n(3)},function(t,e,n){"use strict";var r=n(2),i=n(31)(2);r(r.P+r.F*!n(36)([].filter,!0),"Array",{filter:function(t){return i(this,t,arguments[1])}})},function(t,e,n){"use strict";var r=n(0);n.d(e,"a",(function(){return r}));var i=n(94);n.d(e,"b",(function(){return i}));var o=n(12);n.d(e,"c",(function(){return o}))},function(t,e,n){var r=n(8);t.exports=function(t,e,n,i){try{return i?e(r(n)[0],n[1]):e(n)}catch(e){var o=t.return;throw void 0!==o&&r(o.call(t)),e}}},function(t,e,n){var r=n(15),i=n(22),o=n(49)("IE_PROTO"),a=Object.prototype;t.exports=Object.getPrototypeOf||function(t){return t=i(t),r(t,o)?t[o]:"function"==typeof t.constructor&&t instanceof t.constructor?t.constructor.prototype:t instanceof Object?a:null}},function(t,e,n){var r=n(8),i=n(32),o=n(3)("species");t.exports=function(t,e){var n,a=r(t).constructor;return void 0===a||null==(n=r(a)[o])?e:i(n)}},function(t,e,n){var r=n(2);r(r.S,"Object",{create:n(33)})},,function(t,e){t.exports=function(t,e){return{value:e,done:!!t}}},function(t,e,n){var r=n(5),i=n(8),o=function(t,e){if(i(t),!r(e)&&null!==e)throw TypeError(e+": can't set as prototype!")};t.exports={set:Object.setPrototypeOf||("__proto__"in{}?function(t,e,r){try{(r=n(13)(Function.call,n(54).f(Object.prototype,"__proto__").set,2))(t,[]),e=!(t instanceof Array)}catch(t){e=!0}return function(t,n){return o(t,n),e?t.__proto__=n:r(t,n),t}}({},!1):void 0),check:o}},function(t,e,n){var r=n(2);r(r.S,"Object",{setPrototypeOf:n(83).set})},function(t,e,n){"use strict";n(131);var r=n(8),i=n(93),o=n(7),a=/./.toString,s=function(t){n(16)(RegExp.prototype,"toString",t,!0)};n(9)((function(){return"/a/b"!=a.call({source:"a",flags:"b"})}))?s((function(){var t=r(this);return"/".concat(t.source,"/","flags"in t?t.flags:!o&&t instanceof RegExp?i.call(t):void 0)})):"toString"!=a.name&&s((function(){return a.call(this)}))},function(t,e,n){var r=Date.prototype,i=r.toString,o=r.getTime;new Date(NaN)+""!="Invalid Date"&&n(16)(r,"toString",(function(){var t=o.call(this);return t==t?i.call(this):"Invalid Date"}))},function(t,e,n){"use strict";(function(t){
/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <feross@feross.org> <http://feross.org>
 * @license  MIT
 */
var r=n(137),i=n(138),o=n(139);function a(){return u.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function s(t,e){if(a()<e)throw new RangeError("Invalid typed array length");return u.TYPED_ARRAY_SUPPORT?(t=new Uint8Array(e)).__proto__=u.prototype:(null===t&&(t=new u(e)),t.length=e),t}function u(t,e,n){if(!(u.TYPED_ARRAY_SUPPORT||this instanceof u))return new u(t,e,n);if("number"==typeof t){if("string"==typeof e)throw new Error("If encoding is specified then the first argument must be a string");return f(this,t)}return c(this,t,e,n)}function c(t,e,n,r){if("number"==typeof e)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&e instanceof ArrayBuffer?function(t,e,n,r){if(e.byteLength,n<0||e.byteLength<n)throw new RangeError("'offset' is out of bounds");if(e.byteLength<n+(r||0))throw new RangeError("'length' is out of bounds");e=void 0===n&&void 0===r?new Uint8Array(e):void 0===r?new Uint8Array(e,n):new Uint8Array(e,n,r);u.TYPED_ARRAY_SUPPORT?(t=e).__proto__=u.prototype:t=l(t,e);return t}(t,e,n,r):"string"==typeof e?function(t,e,n){"string"==typeof n&&""!==n||(n="utf8");if(!u.isEncoding(n))throw new TypeError('"encoding" must be a valid string encoding');var r=0|d(e,n),i=(t=s(t,r)).write(e,n);i!==r&&(t=t.slice(0,i));return t}(t,e,n):function(t,e){if(u.isBuffer(e)){var n=0|p(e.length);return 0===(t=s(t,n)).length?t:(e.copy(t,0,0,n),t)}if(e){if("undefined"!=typeof ArrayBuffer&&e.buffer instanceof ArrayBuffer||"length"in e)return"number"!=typeof e.length||(r=e.length)!=r?s(t,0):l(t,e);if("Buffer"===e.type&&o(e.data))return l(t,e.data)}var r;throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}(t,e)}function h(t){if("number"!=typeof t)throw new TypeError('"size" argument must be a number');if(t<0)throw new RangeError('"size" argument must not be negative')}function f(t,e){if(h(e),t=s(t,e<0?0:0|p(e)),!u.TYPED_ARRAY_SUPPORT)for(var n=0;n<e;++n)t[n]=0;return t}function l(t,e){var n=e.length<0?0:0|p(e.length);t=s(t,n);for(var r=0;r<n;r+=1)t[r]=255&e[r];return t}function p(t){if(t>=a())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+a().toString(16)+" bytes");return 0|t}function d(t,e){if(u.isBuffer(t))return t.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(t)||t instanceof ArrayBuffer))return t.byteLength;"string"!=typeof t&&(t=""+t);var n=t.length;if(0===n)return 0;for(var r=!1;;)switch(e){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":case void 0:return V(t).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return j(t).length;default:if(r)return V(t).length;e=(""+e).toLowerCase(),r=!0}}function v(t,e,n){var r=!1;if((void 0===e||e<0)&&(e=0),e>this.length)return"";if((void 0===n||n>this.length)&&(n=this.length),n<=0)return"";if((n>>>=0)<=(e>>>=0))return"";for(t||(t="utf8");;)switch(t){case"hex":return R(this,e,n);case"utf8":case"utf-8":return T(this,e,n);case"ascii":return S(this,e,n);case"latin1":case"binary":return C(this,e,n);case"base64":return k(this,e,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return P(this,e,n);default:if(r)throw new TypeError("Unknown encoding: "+t);t=(t+"").toLowerCase(),r=!0}}function y(t,e,n){var r=t[e];t[e]=t[n],t[n]=r}function m(t,e,n,r,i){if(0===t.length)return-1;if("string"==typeof n?(r=n,n=0):n>2147483647?n=2147483647:n<-2147483648&&(n=-2147483648),n=+n,isNaN(n)&&(n=i?0:t.length-1),n<0&&(n=t.length+n),n>=t.length){if(i)return-1;n=t.length-1}else if(n<0){if(!i)return-1;n=0}if("string"==typeof e&&(e=u.from(e,r)),u.isBuffer(e))return 0===e.length?-1:g(t,e,n,r,i);if("number"==typeof e)return e&=255,u.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?i?Uint8Array.prototype.indexOf.call(t,e,n):Uint8Array.prototype.lastIndexOf.call(t,e,n):g(t,[e],n,r,i);throw new TypeError("val must be string, number or Buffer")}function g(t,e,n,r,i){var o,a=1,s=t.length,u=e.length;if(void 0!==r&&("ucs2"===(r=String(r).toLowerCase())||"ucs-2"===r||"utf16le"===r||"utf-16le"===r)){if(t.length<2||e.length<2)return-1;a=2,s/=2,u/=2,n/=2}function c(t,e){return 1===a?t[e]:t.readUInt16BE(e*a)}if(i){var h=-1;for(o=n;o<s;o++)if(c(t,o)===c(e,-1===h?0:o-h)){if(-1===h&&(h=o),o-h+1===u)return h*a}else-1!==h&&(o-=o-h),h=-1}else for(n+u>s&&(n=s-u),o=n;o>=0;o--){for(var f=!0,l=0;l<u;l++)if(c(t,o+l)!==c(e,l)){f=!1;break}if(f)return o}return-1}function w(t,e,n,r){n=Number(n)||0;var i=t.length-n;r?(r=Number(r))>i&&(r=i):r=i;var o=e.length;if(o%2!=0)throw new TypeError("Invalid hex string");r>o/2&&(r=o/2);for(var a=0;a<r;++a){var s=parseInt(e.substr(2*a,2),16);if(isNaN(s))return a;t[n+a]=s}return a}function b(t,e,n,r){return Y(V(e,t.length-n),t,n,r)}function E(t,e,n,r){return Y(function(t){for(var e=[],n=0;n<t.length;++n)e.push(255&t.charCodeAt(n));return e}(e),t,n,r)}function _(t,e,n,r){return E(t,e,n,r)}function A(t,e,n,r){return Y(j(e),t,n,r)}function x(t,e,n,r){return Y(function(t,e){for(var n,r,i,o=[],a=0;a<t.length&&!((e-=2)<0);++a)n=t.charCodeAt(a),r=n>>8,i=n%256,o.push(i),o.push(r);return o}(e,t.length-n),t,n,r)}function k(t,e,n){return 0===e&&n===t.length?r.fromByteArray(t):r.fromByteArray(t.slice(e,n))}function T(t,e,n){n=Math.min(t.length,n);for(var r=[],i=e;i<n;){var o,a,s,u,c=t[i],h=null,f=c>239?4:c>223?3:c>191?2:1;if(i+f<=n)switch(f){case 1:c<128&&(h=c);break;case 2:128==(192&(o=t[i+1]))&&(u=(31&c)<<6|63&o)>127&&(h=u);break;case 3:o=t[i+1],a=t[i+2],128==(192&o)&&128==(192&a)&&(u=(15&c)<<12|(63&o)<<6|63&a)>2047&&(u<55296||u>57343)&&(h=u);break;case 4:o=t[i+1],a=t[i+2],s=t[i+3],128==(192&o)&&128==(192&a)&&128==(192&s)&&(u=(15&c)<<18|(63&o)<<12|(63&a)<<6|63&s)>65535&&u<1114112&&(h=u)}null===h?(h=65533,f=1):h>65535&&(h-=65536,r.push(h>>>10&1023|55296),h=56320|1023&h),r.push(h),i+=f}return function(t){var e=t.length;if(e<=4096)return String.fromCharCode.apply(String,t);var n="",r=0;for(;r<e;)n+=String.fromCharCode.apply(String,t.slice(r,r+=4096));return n}(r)}e.Buffer=u,e.SlowBuffer=function(t){+t!=t&&(t=0);return u.alloc(+t)},e.INSPECT_MAX_BYTES=50,u.TYPED_ARRAY_SUPPORT=void 0!==t.TYPED_ARRAY_SUPPORT?t.TYPED_ARRAY_SUPPORT:function(){try{var t=new Uint8Array(1);return t.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===t.foo()&&"function"==typeof t.subarray&&0===t.subarray(1,1).byteLength}catch(t){return!1}}(),e.kMaxLength=a(),u.poolSize=8192,u._augment=function(t){return t.__proto__=u.prototype,t},u.from=function(t,e,n){return c(null,t,e,n)},u.TYPED_ARRAY_SUPPORT&&(u.prototype.__proto__=Uint8Array.prototype,u.__proto__=Uint8Array,"undefined"!=typeof Symbol&&Symbol.species&&u[Symbol.species]===u&&Object.defineProperty(u,Symbol.species,{value:null,configurable:!0})),u.alloc=function(t,e,n){return function(t,e,n,r){return h(e),e<=0?s(t,e):void 0!==n?"string"==typeof r?s(t,e).fill(n,r):s(t,e).fill(n):s(t,e)}(null,t,e,n)},u.allocUnsafe=function(t){return f(null,t)},u.allocUnsafeSlow=function(t){return f(null,t)},u.isBuffer=function(t){return!(null==t||!t._isBuffer)},u.compare=function(t,e){if(!u.isBuffer(t)||!u.isBuffer(e))throw new TypeError("Arguments must be Buffers");if(t===e)return 0;for(var n=t.length,r=e.length,i=0,o=Math.min(n,r);i<o;++i)if(t[i]!==e[i]){n=t[i],r=e[i];break}return n<r?-1:r<n?1:0},u.isEncoding=function(t){switch(String(t).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},u.concat=function(t,e){if(!o(t))throw new TypeError('"list" argument must be an Array of Buffers');if(0===t.length)return u.alloc(0);var n;if(void 0===e)for(e=0,n=0;n<t.length;++n)e+=t[n].length;var r=u.allocUnsafe(e),i=0;for(n=0;n<t.length;++n){var a=t[n];if(!u.isBuffer(a))throw new TypeError('"list" argument must be an Array of Buffers');a.copy(r,i),i+=a.length}return r},u.byteLength=d,u.prototype._isBuffer=!0,u.prototype.swap16=function(){var t=this.length;if(t%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var e=0;e<t;e+=2)y(this,e,e+1);return this},u.prototype.swap32=function(){var t=this.length;if(t%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var e=0;e<t;e+=4)y(this,e,e+3),y(this,e+1,e+2);return this},u.prototype.swap64=function(){var t=this.length;if(t%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var e=0;e<t;e+=8)y(this,e,e+7),y(this,e+1,e+6),y(this,e+2,e+5),y(this,e+3,e+4);return this},u.prototype.toString=function(){var t=0|this.length;return 0===t?"":0===arguments.length?T(this,0,t):v.apply(this,arguments)},u.prototype.equals=function(t){if(!u.isBuffer(t))throw new TypeError("Argument must be a Buffer");return this===t||0===u.compare(this,t)},u.prototype.inspect=function(){var t="",n=e.INSPECT_MAX_BYTES;return this.length>0&&(t=this.toString("hex",0,n).match(/.{2}/g).join(" "),this.length>n&&(t+=" ... ")),"<Buffer "+t+">"},u.prototype.compare=function(t,e,n,r,i){if(!u.isBuffer(t))throw new TypeError("Argument must be a Buffer");if(void 0===e&&(e=0),void 0===n&&(n=t?t.length:0),void 0===r&&(r=0),void 0===i&&(i=this.length),e<0||n>t.length||r<0||i>this.length)throw new RangeError("out of range index");if(r>=i&&e>=n)return 0;if(r>=i)return-1;if(e>=n)return 1;if(this===t)return 0;for(var o=(i>>>=0)-(r>>>=0),a=(n>>>=0)-(e>>>=0),s=Math.min(o,a),c=this.slice(r,i),h=t.slice(e,n),f=0;f<s;++f)if(c[f]!==h[f]){o=c[f],a=h[f];break}return o<a?-1:a<o?1:0},u.prototype.includes=function(t,e,n){return-1!==this.indexOf(t,e,n)},u.prototype.indexOf=function(t,e,n){return m(this,t,e,n,!0)},u.prototype.lastIndexOf=function(t,e,n){return m(this,t,e,n,!1)},u.prototype.write=function(t,e,n,r){if(void 0===e)r="utf8",n=this.length,e=0;else if(void 0===n&&"string"==typeof e)r=e,n=this.length,e=0;else{if(!isFinite(e))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");e|=0,isFinite(n)?(n|=0,void 0===r&&(r="utf8")):(r=n,n=void 0)}var i=this.length-e;if((void 0===n||n>i)&&(n=i),t.length>0&&(n<0||e<0)||e>this.length)throw new RangeError("Attempt to write outside buffer bounds");r||(r="utf8");for(var o=!1;;)switch(r){case"hex":return w(this,t,e,n);case"utf8":case"utf-8":return b(this,t,e,n);case"ascii":return E(this,t,e,n);case"latin1":case"binary":return _(this,t,e,n);case"base64":return A(this,t,e,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return x(this,t,e,n);default:if(o)throw new TypeError("Unknown encoding: "+r);r=(""+r).toLowerCase(),o=!0}},u.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function S(t,e,n){var r="";n=Math.min(t.length,n);for(var i=e;i<n;++i)r+=String.fromCharCode(127&t[i]);return r}function C(t,e,n){var r="";n=Math.min(t.length,n);for(var i=e;i<n;++i)r+=String.fromCharCode(t[i]);return r}function R(t,e,n){var r=t.length;(!e||e<0)&&(e=0),(!n||n<0||n>r)&&(n=r);for(var i="",o=e;o<n;++o)i+=B(t[o]);return i}function P(t,e,n){for(var r=t.slice(e,n),i="",o=0;o<r.length;o+=2)i+=String.fromCharCode(r[o]+256*r[o+1]);return i}function I(t,e,n){if(t%1!=0||t<0)throw new RangeError("offset is not uint");if(t+e>n)throw new RangeError("Trying to access beyond buffer length")}function M(t,e,n,r,i,o){if(!u.isBuffer(t))throw new TypeError('"buffer" argument must be a Buffer instance');if(e>i||e<o)throw new RangeError('"value" argument is out of bounds');if(n+r>t.length)throw new RangeError("Index out of range")}function U(t,e,n,r){e<0&&(e=65535+e+1);for(var i=0,o=Math.min(t.length-n,2);i<o;++i)t[n+i]=(e&255<<8*(r?i:1-i))>>>8*(r?i:1-i)}function O(t,e,n,r){e<0&&(e=4294967295+e+1);for(var i=0,o=Math.min(t.length-n,4);i<o;++i)t[n+i]=e>>>8*(r?i:3-i)&255}function D(t,e,n,r,i,o){if(n+r>t.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("Index out of range")}function L(t,e,n,r,o){return o||D(t,0,n,4),i.write(t,e,n,r,23,4),n+4}function N(t,e,n,r,o){return o||D(t,0,n,8),i.write(t,e,n,r,52,8),n+8}u.prototype.slice=function(t,e){var n,r=this.length;if((t=~~t)<0?(t+=r)<0&&(t=0):t>r&&(t=r),(e=void 0===e?r:~~e)<0?(e+=r)<0&&(e=0):e>r&&(e=r),e<t&&(e=t),u.TYPED_ARRAY_SUPPORT)(n=this.subarray(t,e)).__proto__=u.prototype;else{var i=e-t;n=new u(i,void 0);for(var o=0;o<i;++o)n[o]=this[o+t]}return n},u.prototype.readUIntLE=function(t,e,n){t|=0,e|=0,n||I(t,e,this.length);for(var r=this[t],i=1,o=0;++o<e&&(i*=256);)r+=this[t+o]*i;return r},u.prototype.readUIntBE=function(t,e,n){t|=0,e|=0,n||I(t,e,this.length);for(var r=this[t+--e],i=1;e>0&&(i*=256);)r+=this[t+--e]*i;return r},u.prototype.readUInt8=function(t,e){return e||I(t,1,this.length),this[t]},u.prototype.readUInt16LE=function(t,e){return e||I(t,2,this.length),this[t]|this[t+1]<<8},u.prototype.readUInt16BE=function(t,e){return e||I(t,2,this.length),this[t]<<8|this[t+1]},u.prototype.readUInt32LE=function(t,e){return e||I(t,4,this.length),(this[t]|this[t+1]<<8|this[t+2]<<16)+16777216*this[t+3]},u.prototype.readUInt32BE=function(t,e){return e||I(t,4,this.length),16777216*this[t]+(this[t+1]<<16|this[t+2]<<8|this[t+3])},u.prototype.readIntLE=function(t,e,n){t|=0,e|=0,n||I(t,e,this.length);for(var r=this[t],i=1,o=0;++o<e&&(i*=256);)r+=this[t+o]*i;return r>=(i*=128)&&(r-=Math.pow(2,8*e)),r},u.prototype.readIntBE=function(t,e,n){t|=0,e|=0,n||I(t,e,this.length);for(var r=e,i=1,o=this[t+--r];r>0&&(i*=256);)o+=this[t+--r]*i;return o>=(i*=128)&&(o-=Math.pow(2,8*e)),o},u.prototype.readInt8=function(t,e){return e||I(t,1,this.length),128&this[t]?-1*(255-this[t]+1):this[t]},u.prototype.readInt16LE=function(t,e){e||I(t,2,this.length);var n=this[t]|this[t+1]<<8;return 32768&n?4294901760|n:n},u.prototype.readInt16BE=function(t,e){e||I(t,2,this.length);var n=this[t+1]|this[t]<<8;return 32768&n?4294901760|n:n},u.prototype.readInt32LE=function(t,e){return e||I(t,4,this.length),this[t]|this[t+1]<<8|this[t+2]<<16|this[t+3]<<24},u.prototype.readInt32BE=function(t,e){return e||I(t,4,this.length),this[t]<<24|this[t+1]<<16|this[t+2]<<8|this[t+3]},u.prototype.readFloatLE=function(t,e){return e||I(t,4,this.length),i.read(this,t,!0,23,4)},u.prototype.readFloatBE=function(t,e){return e||I(t,4,this.length),i.read(this,t,!1,23,4)},u.prototype.readDoubleLE=function(t,e){return e||I(t,8,this.length),i.read(this,t,!0,52,8)},u.prototype.readDoubleBE=function(t,e){return e||I(t,8,this.length),i.read(this,t,!1,52,8)},u.prototype.writeUIntLE=function(t,e,n,r){(t=+t,e|=0,n|=0,r)||M(this,t,e,n,Math.pow(2,8*n)-1,0);var i=1,o=0;for(this[e]=255&t;++o<n&&(i*=256);)this[e+o]=t/i&255;return e+n},u.prototype.writeUIntBE=function(t,e,n,r){(t=+t,e|=0,n|=0,r)||M(this,t,e,n,Math.pow(2,8*n)-1,0);var i=n-1,o=1;for(this[e+i]=255&t;--i>=0&&(o*=256);)this[e+i]=t/o&255;return e+n},u.prototype.writeUInt8=function(t,e,n){return t=+t,e|=0,n||M(this,t,e,1,255,0),u.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),this[e]=255&t,e+1},u.prototype.writeUInt16LE=function(t,e,n){return t=+t,e|=0,n||M(this,t,e,2,65535,0),u.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8):U(this,t,e,!0),e+2},u.prototype.writeUInt16BE=function(t,e,n){return t=+t,e|=0,n||M(this,t,e,2,65535,0),u.TYPED_ARRAY_SUPPORT?(this[e]=t>>>8,this[e+1]=255&t):U(this,t,e,!1),e+2},u.prototype.writeUInt32LE=function(t,e,n){return t=+t,e|=0,n||M(this,t,e,4,4294967295,0),u.TYPED_ARRAY_SUPPORT?(this[e+3]=t>>>24,this[e+2]=t>>>16,this[e+1]=t>>>8,this[e]=255&t):O(this,t,e,!0),e+4},u.prototype.writeUInt32BE=function(t,e,n){return t=+t,e|=0,n||M(this,t,e,4,4294967295,0),u.TYPED_ARRAY_SUPPORT?(this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t):O(this,t,e,!1),e+4},u.prototype.writeIntLE=function(t,e,n,r){if(t=+t,e|=0,!r){var i=Math.pow(2,8*n-1);M(this,t,e,n,i-1,-i)}var o=0,a=1,s=0;for(this[e]=255&t;++o<n&&(a*=256);)t<0&&0===s&&0!==this[e+o-1]&&(s=1),this[e+o]=(t/a>>0)-s&255;return e+n},u.prototype.writeIntBE=function(t,e,n,r){if(t=+t,e|=0,!r){var i=Math.pow(2,8*n-1);M(this,t,e,n,i-1,-i)}var o=n-1,a=1,s=0;for(this[e+o]=255&t;--o>=0&&(a*=256);)t<0&&0===s&&0!==this[e+o+1]&&(s=1),this[e+o]=(t/a>>0)-s&255;return e+n},u.prototype.writeInt8=function(t,e,n){return t=+t,e|=0,n||M(this,t,e,1,127,-128),u.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),t<0&&(t=255+t+1),this[e]=255&t,e+1},u.prototype.writeInt16LE=function(t,e,n){return t=+t,e|=0,n||M(this,t,e,2,32767,-32768),u.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8):U(this,t,e,!0),e+2},u.prototype.writeInt16BE=function(t,e,n){return t=+t,e|=0,n||M(this,t,e,2,32767,-32768),u.TYPED_ARRAY_SUPPORT?(this[e]=t>>>8,this[e+1]=255&t):U(this,t,e,!1),e+2},u.prototype.writeInt32LE=function(t,e,n){return t=+t,e|=0,n||M(this,t,e,4,2147483647,-2147483648),u.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8,this[e+2]=t>>>16,this[e+3]=t>>>24):O(this,t,e,!0),e+4},u.prototype.writeInt32BE=function(t,e,n){return t=+t,e|=0,n||M(this,t,e,4,2147483647,-2147483648),t<0&&(t=4294967295+t+1),u.TYPED_ARRAY_SUPPORT?(this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t):O(this,t,e,!1),e+4},u.prototype.writeFloatLE=function(t,e,n){return L(this,t,e,!0,n)},u.prototype.writeFloatBE=function(t,e,n){return L(this,t,e,!1,n)},u.prototype.writeDoubleLE=function(t,e,n){return N(this,t,e,!0,n)},u.prototype.writeDoubleBE=function(t,e,n){return N(this,t,e,!1,n)},u.prototype.copy=function(t,e,n,r){if(n||(n=0),r||0===r||(r=this.length),e>=t.length&&(e=t.length),e||(e=0),r>0&&r<n&&(r=n),r===n)return 0;if(0===t.length||0===this.length)return 0;if(e<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("sourceStart out of bounds");if(r<0)throw new RangeError("sourceEnd out of bounds");r>this.length&&(r=this.length),t.length-e<r-n&&(r=t.length-e+n);var i,o=r-n;if(this===t&&n<e&&e<r)for(i=o-1;i>=0;--i)t[i+e]=this[i+n];else if(o<1e3||!u.TYPED_ARRAY_SUPPORT)for(i=0;i<o;++i)t[i+e]=this[i+n];else Uint8Array.prototype.set.call(t,this.subarray(n,n+o),e);return o},u.prototype.fill=function(t,e,n,r){if("string"==typeof t){if("string"==typeof e?(r=e,e=0,n=this.length):"string"==typeof n&&(r=n,n=this.length),1===t.length){var i=t.charCodeAt(0);i<256&&(t=i)}if(void 0!==r&&"string"!=typeof r)throw new TypeError("encoding must be a string");if("string"==typeof r&&!u.isEncoding(r))throw new TypeError("Unknown encoding: "+r)}else"number"==typeof t&&(t&=255);if(e<0||this.length<e||this.length<n)throw new RangeError("Out of range index");if(n<=e)return this;var o;if(e>>>=0,n=void 0===n?this.length:n>>>0,t||(t=0),"number"==typeof t)for(o=e;o<n;++o)this[o]=t;else{var a=u.isBuffer(t)?t:V(new u(t,r).toString()),s=a.length;for(o=0;o<n-e;++o)this[o+e]=a[o%s]}return this};var F=/[^+\/0-9A-Za-z-_]/g;function B(t){return t<16?"0"+t.toString(16):t.toString(16)}function V(t,e){var n;e=e||1/0;for(var r=t.length,i=null,o=[],a=0;a<r;++a){if((n=t.charCodeAt(a))>55295&&n<57344){if(!i){if(n>56319){(e-=3)>-1&&o.push(239,191,189);continue}if(a+1===r){(e-=3)>-1&&o.push(239,191,189);continue}i=n;continue}if(n<56320){(e-=3)>-1&&o.push(239,191,189),i=n;continue}n=65536+(i-55296<<10|n-56320)}else i&&(e-=3)>-1&&o.push(239,191,189);if(i=null,n<128){if((e-=1)<0)break;o.push(n)}else if(n<2048){if((e-=2)<0)break;o.push(n>>6|192,63&n|128)}else if(n<65536){if((e-=3)<0)break;o.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(n<1114112))throw new Error("Invalid code point");if((e-=4)<0)break;o.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return o}function j(t){return r.toByteArray(function(t){if((t=function(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")}(t).replace(F,"")).length<2)return"";for(;t.length%4!=0;)t+="=";return t}(t))}function Y(t,e,n,r){for(var i=0;i<r&&!(i+n>=e.length||i>=t.length);++i)e[i+n]=t[i];return i}}).call(this,n(136))},function(t,e,n){for(var r,i=n(4),o=n(10),a=n(19),s=a("typed_array"),u=a("view"),c=!(!i.ArrayBuffer||!i.DataView),h=c,f=0,l="Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array".split(",");f<9;)(r=i[l[f++]])?(o(r.prototype,s,!0),o(r.prototype,u,!0)):h=!1;t.exports={ABV:c,CONSTR:h,TYPED:s,VIEW:u}},function(t,e,n){t.exports={h32:n(141),h64:n(144)}},function(t,e,n){"use strict";var r=n(2),i=n(45)(!1),o=[].indexOf,a=!!o&&1/[1].indexOf(1,-0)<0;r(r.P+r.F*(a||!n(36)(o)),"Array",{indexOf:function(t){return a?o.apply(this,arguments)||0:i(this,t,arguments[1])}})},function(t,e,n){"use strict";n.r(e),n.d(e,"create",(function(){return s})),n.d(e,"identity",(function(){return u})),n.d(e,"setAxisAngle",(function(){return c})),n.d(e,"getAxisAngle",(function(){return h})),n.d(e,"multiply",(function(){return f})),n.d(e,"rotateX",(function(){return l})),n.d(e,"rotateY",(function(){return p})),n.d(e,"rotateZ",(function(){return d})),n.d(e,"calculateW",(function(){return v})),n.d(e,"slerp",(function(){return y})),n.d(e,"random",(function(){return m})),n.d(e,"invert",(function(){return g})),n.d(e,"conjugate",(function(){return w})),n.d(e,"fromMat3",(function(){return b})),n.d(e,"fromEuler",(function(){return E})),n.d(e,"str",(function(){return _})),n.d(e,"clone",(function(){return R})),n.d(e,"fromValues",(function(){return P})),n.d(e,"copy",(function(){return I})),n.d(e,"set",(function(){return M})),n.d(e,"add",(function(){return U})),n.d(e,"mul",(function(){return O})),n.d(e,"scale",(function(){return D})),n.d(e,"dot",(function(){return L})),n.d(e,"lerp",(function(){return N})),n.d(e,"length",(function(){return F})),n.d(e,"len",(function(){return B})),n.d(e,"squaredLength",(function(){return V})),n.d(e,"sqrLen",(function(){return j})),n.d(e,"normalize",(function(){return Y})),n.d(e,"exactEquals",(function(){return G})),n.d(e,"equals",(function(){return W})),n.d(e,"rotationTo",(function(){return q})),n.d(e,"sqlerp",(function(){return z})),n.d(e,"setAxes",(function(){return X}));var r=n(0),i=n(98),o=n(12),a=n(11);function s(){var t=new r.ARRAY_TYPE(4);return r.ARRAY_TYPE!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t[3]=1,t}function u(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t}function c(t,e,n){n*=.5;var r=Math.sin(n);return t[0]=r*e[0],t[1]=r*e[1],t[2]=r*e[2],t[3]=Math.cos(n),t}function h(t,e){var n=2*Math.acos(e[3]),i=Math.sin(n/2);return i>r.EPSILON?(t[0]=e[0]/i,t[1]=e[1]/i,t[2]=e[2]/i):(t[0]=1,t[1]=0,t[2]=0),n}function f(t,e,n){var r=e[0],i=e[1],o=e[2],a=e[3],s=n[0],u=n[1],c=n[2],h=n[3];return t[0]=r*h+a*s+i*c-o*u,t[1]=i*h+a*u+o*s-r*c,t[2]=o*h+a*c+r*u-i*s,t[3]=a*h-r*s-i*u-o*c,t}function l(t,e,n){n*=.5;var r=e[0],i=e[1],o=e[2],a=e[3],s=Math.sin(n),u=Math.cos(n);return t[0]=r*u+a*s,t[1]=i*u+o*s,t[2]=o*u-i*s,t[3]=a*u-r*s,t}function p(t,e,n){n*=.5;var r=e[0],i=e[1],o=e[2],a=e[3],s=Math.sin(n),u=Math.cos(n);return t[0]=r*u-o*s,t[1]=i*u+a*s,t[2]=o*u+r*s,t[3]=a*u-i*s,t}function d(t,e,n){n*=.5;var r=e[0],i=e[1],o=e[2],a=e[3],s=Math.sin(n),u=Math.cos(n);return t[0]=r*u+i*s,t[1]=i*u-r*s,t[2]=o*u+a*s,t[3]=a*u-o*s,t}function v(t,e){var n=e[0],r=e[1],i=e[2];return t[0]=n,t[1]=r,t[2]=i,t[3]=Math.sqrt(Math.abs(1-n*n-r*r-i*i)),t}function y(t,e,n,i){var o,a,s,u,c,h=e[0],f=e[1],l=e[2],p=e[3],d=n[0],v=n[1],y=n[2],m=n[3];return(a=h*d+f*v+l*y+p*m)<0&&(a=-a,d=-d,v=-v,y=-y,m=-m),1-a>r.EPSILON?(o=Math.acos(a),s=Math.sin(o),u=Math.sin((1-i)*o)/s,c=Math.sin(i*o)/s):(u=1-i,c=i),t[0]=u*h+c*d,t[1]=u*f+c*v,t[2]=u*l+c*y,t[3]=u*p+c*m,t}function m(t){var e=r.RANDOM(),n=r.RANDOM(),i=r.RANDOM(),o=Math.sqrt(1-e),a=Math.sqrt(e);return t[0]=o*Math.sin(2*Math.PI*n),t[1]=o*Math.cos(2*Math.PI*n),t[2]=a*Math.sin(2*Math.PI*i),t[3]=a*Math.cos(2*Math.PI*i),t}function g(t,e){var n=e[0],r=e[1],i=e[2],o=e[3],a=n*n+r*r+i*i+o*o,s=a?1/a:0;return t[0]=-n*s,t[1]=-r*s,t[2]=-i*s,t[3]=o*s,t}function w(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=e[3],t}function b(t,e){var n,r=e[0]+e[4]+e[8];if(r>0)n=Math.sqrt(r+1),t[3]=.5*n,n=.5/n,t[0]=(e[5]-e[7])*n,t[1]=(e[6]-e[2])*n,t[2]=(e[1]-e[3])*n;else{var i=0;e[4]>e[0]&&(i=1),e[8]>e[3*i+i]&&(i=2);var o=(i+1)%3,a=(i+2)%3;n=Math.sqrt(e[3*i+i]-e[3*o+o]-e[3*a+a]+1),t[i]=.5*n,n=.5/n,t[3]=(e[3*o+a]-e[3*a+o])*n,t[o]=(e[3*o+i]+e[3*i+o])*n,t[a]=(e[3*a+i]+e[3*i+a])*n}return t}function E(t,e,n,r){var i=.5*Math.PI/180;e*=i,n*=i,r*=i;var o=Math.sin(e),a=Math.cos(e),s=Math.sin(n),u=Math.cos(n),c=Math.sin(r),h=Math.cos(r);return t[0]=o*u*h-a*s*c,t[1]=a*s*h+o*u*c,t[2]=a*u*c-o*s*h,t[3]=a*u*h+o*s*c,t}function _(t){return"quat("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"}var A,x,k,T,S,C,R=a.b,P=a.g,I=a.c,M=a.l,U=a.a,O=f,D=a.k,L=a.d,N=a.i,F=a.h,B=F,V=a.m,j=V,Y=a.j,G=a.f,W=a.e,q=(A=o.create(),x=o.fromValues(1,0,0),k=o.fromValues(0,1,0),function(t,e,n){var r=o.dot(e,n);return r<-.999999?(o.cross(A,x,e),o.len(A)<1e-6&&o.cross(A,k,e),o.normalize(A,A),c(t,A,Math.PI),t):r>.999999?(t[0]=0,t[1]=0,t[2]=0,t[3]=1,t):(o.cross(A,e,n),t[0]=A[0],t[1]=A[1],t[2]=A[2],t[3]=1+r,Y(t,t))}),z=(T=s(),S=s(),function(t,e,n,r,i,o){return y(T,e,i,o),y(S,n,r,o),y(t,T,S,2*o*(1-o)),t}),X=(C=i.a(),function(t,e,n,r){return C[0]=n[0],C[3]=n[1],C[6]=n[2],C[1]=r[0],C[4]=r[1],C[7]=r[2],C[2]=-e[0],C[5]=-e[1],C[8]=-e[2],Y(t,b(t,C))})},function(t,e,n){"use strict";var r=n(2),i=n(31)(0),o=n(36)([].forEach,!0);r(r.P+r.F*!o,"Array",{forEach:function(t){return i(this,t,arguments[1])}})},function(t,e,n){"use strict";var r=n(8);t.exports=function(){var t=r(this),e="";return t.global&&(e+="g"),t.ignoreCase&&(e+="i"),t.multiline&&(e+="m"),t.unicode&&(e+="u"),t.sticky&&(e+="y"),e}},function(t,e,n){"use strict";n.r(e),n.d(e,"create",(function(){return i})),n.d(e,"clone",(function(){return o})),n.d(e,"copy",(function(){return a})),n.d(e,"fromValues",(function(){return s})),n.d(e,"set",(function(){return u})),n.d(e,"identity",(function(){return c})),n.d(e,"transpose",(function(){return h})),n.d(e,"invert",(function(){return f})),n.d(e,"adjoint",(function(){return l})),n.d(e,"determinant",(function(){return p})),n.d(e,"multiply",(function(){return d})),n.d(e,"translate",(function(){return v})),n.d(e,"scale",(function(){return y})),n.d(e,"rotate",(function(){return m})),n.d(e,"rotateX",(function(){return g})),n.d(e,"rotateY",(function(){return w})),n.d(e,"rotateZ",(function(){return b})),n.d(e,"fromTranslation",(function(){return E})),n.d(e,"fromScaling",(function(){return _})),n.d(e,"fromRotation",(function(){return A})),n.d(e,"fromXRotation",(function(){return x})),n.d(e,"fromYRotation",(function(){return k})),n.d(e,"fromZRotation",(function(){return T})),n.d(e,"fromRotationTranslation",(function(){return S})),n.d(e,"fromQuat2",(function(){return C})),n.d(e,"getTranslation",(function(){return R})),n.d(e,"getScaling",(function(){return P})),n.d(e,"getRotation",(function(){return I})),n.d(e,"fromRotationTranslationScale",(function(){return M})),n.d(e,"fromRotationTranslationScaleOrigin",(function(){return U})),n.d(e,"fromQuat",(function(){return O})),n.d(e,"frustum",(function(){return D})),n.d(e,"perspective",(function(){return L})),n.d(e,"perspectiveFromFieldOfView",(function(){return N})),n.d(e,"ortho",(function(){return F})),n.d(e,"lookAt",(function(){return B})),n.d(e,"targetTo",(function(){return V})),n.d(e,"str",(function(){return j})),n.d(e,"frob",(function(){return Y})),n.d(e,"add",(function(){return G})),n.d(e,"subtract",(function(){return W})),n.d(e,"multiplyScalar",(function(){return q})),n.d(e,"multiplyScalarAndAdd",(function(){return z})),n.d(e,"exactEquals",(function(){return X})),n.d(e,"equals",(function(){return H})),n.d(e,"mul",(function(){return K})),n.d(e,"sub",(function(){return J}));var r=n(0);function i(){var t=new r.ARRAY_TYPE(16);return r.ARRAY_TYPE!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0),t[0]=1,t[5]=1,t[10]=1,t[15]=1,t}function o(t){var e=new r.ARRAY_TYPE(16);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}function a(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function s(t,e,n,i,o,a,s,u,c,h,f,l,p,d,v,y){var m=new r.ARRAY_TYPE(16);return m[0]=t,m[1]=e,m[2]=n,m[3]=i,m[4]=o,m[5]=a,m[6]=s,m[7]=u,m[8]=c,m[9]=h,m[10]=f,m[11]=l,m[12]=p,m[13]=d,m[14]=v,m[15]=y,m}function u(t,e,n,r,i,o,a,s,u,c,h,f,l,p,d,v,y){return t[0]=e,t[1]=n,t[2]=r,t[3]=i,t[4]=o,t[5]=a,t[6]=s,t[7]=u,t[8]=c,t[9]=h,t[10]=f,t[11]=l,t[12]=p,t[13]=d,t[14]=v,t[15]=y,t}function c(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function h(t,e){if(t===e){var n=e[1],r=e[2],i=e[3],o=e[6],a=e[7],s=e[11];t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=n,t[6]=e[9],t[7]=e[13],t[8]=r,t[9]=o,t[11]=e[14],t[12]=i,t[13]=a,t[14]=s}else t[0]=e[0],t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=e[1],t[5]=e[5],t[6]=e[9],t[7]=e[13],t[8]=e[2],t[9]=e[6],t[10]=e[10],t[11]=e[14],t[12]=e[3],t[13]=e[7],t[14]=e[11],t[15]=e[15];return t}function f(t,e){var n=e[0],r=e[1],i=e[2],o=e[3],a=e[4],s=e[5],u=e[6],c=e[7],h=e[8],f=e[9],l=e[10],p=e[11],d=e[12],v=e[13],y=e[14],m=e[15],g=n*s-r*a,w=n*u-i*a,b=n*c-o*a,E=r*u-i*s,_=r*c-o*s,A=i*c-o*u,x=h*v-f*d,k=h*y-l*d,T=h*m-p*d,S=f*y-l*v,C=f*m-p*v,R=l*m-p*y,P=g*R-w*C+b*S+E*T-_*k+A*x;return P?(P=1/P,t[0]=(s*R-u*C+c*S)*P,t[1]=(i*C-r*R-o*S)*P,t[2]=(v*A-y*_+m*E)*P,t[3]=(l*_-f*A-p*E)*P,t[4]=(u*T-a*R-c*k)*P,t[5]=(n*R-i*T+o*k)*P,t[6]=(y*b-d*A-m*w)*P,t[7]=(h*A-l*b+p*w)*P,t[8]=(a*C-s*T+c*x)*P,t[9]=(r*T-n*C-o*x)*P,t[10]=(d*_-v*b+m*g)*P,t[11]=(f*b-h*_-p*g)*P,t[12]=(s*k-a*S-u*x)*P,t[13]=(n*S-r*k+i*x)*P,t[14]=(v*w-d*E-y*g)*P,t[15]=(h*E-f*w+l*g)*P,t):null}function l(t,e){var n=e[0],r=e[1],i=e[2],o=e[3],a=e[4],s=e[5],u=e[6],c=e[7],h=e[8],f=e[9],l=e[10],p=e[11],d=e[12],v=e[13],y=e[14],m=e[15];return t[0]=s*(l*m-p*y)-f*(u*m-c*y)+v*(u*p-c*l),t[1]=-(r*(l*m-p*y)-f*(i*m-o*y)+v*(i*p-o*l)),t[2]=r*(u*m-c*y)-s*(i*m-o*y)+v*(i*c-o*u),t[3]=-(r*(u*p-c*l)-s*(i*p-o*l)+f*(i*c-o*u)),t[4]=-(a*(l*m-p*y)-h*(u*m-c*y)+d*(u*p-c*l)),t[5]=n*(l*m-p*y)-h*(i*m-o*y)+d*(i*p-o*l),t[6]=-(n*(u*m-c*y)-a*(i*m-o*y)+d*(i*c-o*u)),t[7]=n*(u*p-c*l)-a*(i*p-o*l)+h*(i*c-o*u),t[8]=a*(f*m-p*v)-h*(s*m-c*v)+d*(s*p-c*f),t[9]=-(n*(f*m-p*v)-h*(r*m-o*v)+d*(r*p-o*f)),t[10]=n*(s*m-c*v)-a*(r*m-o*v)+d*(r*c-o*s),t[11]=-(n*(s*p-c*f)-a*(r*p-o*f)+h*(r*c-o*s)),t[12]=-(a*(f*y-l*v)-h*(s*y-u*v)+d*(s*l-u*f)),t[13]=n*(f*y-l*v)-h*(r*y-i*v)+d*(r*l-i*f),t[14]=-(n*(s*y-u*v)-a*(r*y-i*v)+d*(r*u-i*s)),t[15]=n*(s*l-u*f)-a*(r*l-i*f)+h*(r*u-i*s),t}function p(t){var e=t[0],n=t[1],r=t[2],i=t[3],o=t[4],a=t[5],s=t[6],u=t[7],c=t[8],h=t[9],f=t[10],l=t[11],p=t[12],d=t[13],v=t[14],y=t[15];return(e*a-n*o)*(f*y-l*v)-(e*s-r*o)*(h*y-l*d)+(e*u-i*o)*(h*v-f*d)+(n*s-r*a)*(c*y-l*p)-(n*u-i*a)*(c*v-f*p)+(r*u-i*s)*(c*d-h*p)}function d(t,e,n){var r=e[0],i=e[1],o=e[2],a=e[3],s=e[4],u=e[5],c=e[6],h=e[7],f=e[8],l=e[9],p=e[10],d=e[11],v=e[12],y=e[13],m=e[14],g=e[15],w=n[0],b=n[1],E=n[2],_=n[3];return t[0]=w*r+b*s+E*f+_*v,t[1]=w*i+b*u+E*l+_*y,t[2]=w*o+b*c+E*p+_*m,t[3]=w*a+b*h+E*d+_*g,w=n[4],b=n[5],E=n[6],_=n[7],t[4]=w*r+b*s+E*f+_*v,t[5]=w*i+b*u+E*l+_*y,t[6]=w*o+b*c+E*p+_*m,t[7]=w*a+b*h+E*d+_*g,w=n[8],b=n[9],E=n[10],_=n[11],t[8]=w*r+b*s+E*f+_*v,t[9]=w*i+b*u+E*l+_*y,t[10]=w*o+b*c+E*p+_*m,t[11]=w*a+b*h+E*d+_*g,w=n[12],b=n[13],E=n[14],_=n[15],t[12]=w*r+b*s+E*f+_*v,t[13]=w*i+b*u+E*l+_*y,t[14]=w*o+b*c+E*p+_*m,t[15]=w*a+b*h+E*d+_*g,t}function v(t,e,n){var r,i,o,a,s,u,c,h,f,l,p,d,v=n[0],y=n[1],m=n[2];return e===t?(t[12]=e[0]*v+e[4]*y+e[8]*m+e[12],t[13]=e[1]*v+e[5]*y+e[9]*m+e[13],t[14]=e[2]*v+e[6]*y+e[10]*m+e[14],t[15]=e[3]*v+e[7]*y+e[11]*m+e[15]):(r=e[0],i=e[1],o=e[2],a=e[3],s=e[4],u=e[5],c=e[6],h=e[7],f=e[8],l=e[9],p=e[10],d=e[11],t[0]=r,t[1]=i,t[2]=o,t[3]=a,t[4]=s,t[5]=u,t[6]=c,t[7]=h,t[8]=f,t[9]=l,t[10]=p,t[11]=d,t[12]=r*v+s*y+f*m+e[12],t[13]=i*v+u*y+l*m+e[13],t[14]=o*v+c*y+p*m+e[14],t[15]=a*v+h*y+d*m+e[15]),t}function y(t,e,n){var r=n[0],i=n[1],o=n[2];return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t[4]=e[4]*i,t[5]=e[5]*i,t[6]=e[6]*i,t[7]=e[7]*i,t[8]=e[8]*o,t[9]=e[9]*o,t[10]=e[10]*o,t[11]=e[11]*o,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function m(t,e,n,i){var o,a,s,u,c,h,f,l,p,d,v,y,m,g,w,b,E,_,A,x,k,T,S,C,R=i[0],P=i[1],I=i[2],M=Math.sqrt(R*R+P*P+I*I);return M<r.EPSILON?null:(R*=M=1/M,P*=M,I*=M,o=Math.sin(n),s=1-(a=Math.cos(n)),u=e[0],c=e[1],h=e[2],f=e[3],l=e[4],p=e[5],d=e[6],v=e[7],y=e[8],m=e[9],g=e[10],w=e[11],b=R*R*s+a,E=P*R*s+I*o,_=I*R*s-P*o,A=R*P*s-I*o,x=P*P*s+a,k=I*P*s+R*o,T=R*I*s+P*o,S=P*I*s-R*o,C=I*I*s+a,t[0]=u*b+l*E+y*_,t[1]=c*b+p*E+m*_,t[2]=h*b+d*E+g*_,t[3]=f*b+v*E+w*_,t[4]=u*A+l*x+y*k,t[5]=c*A+p*x+m*k,t[6]=h*A+d*x+g*k,t[7]=f*A+v*x+w*k,t[8]=u*T+l*S+y*C,t[9]=c*T+p*S+m*C,t[10]=h*T+d*S+g*C,t[11]=f*T+v*S+w*C,e!==t&&(t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t)}function g(t,e,n){var r=Math.sin(n),i=Math.cos(n),o=e[4],a=e[5],s=e[6],u=e[7],c=e[8],h=e[9],f=e[10],l=e[11];return e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[4]=o*i+c*r,t[5]=a*i+h*r,t[6]=s*i+f*r,t[7]=u*i+l*r,t[8]=c*i-o*r,t[9]=h*i-a*r,t[10]=f*i-s*r,t[11]=l*i-u*r,t}function w(t,e,n){var r=Math.sin(n),i=Math.cos(n),o=e[0],a=e[1],s=e[2],u=e[3],c=e[8],h=e[9],f=e[10],l=e[11];return e!==t&&(t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=o*i-c*r,t[1]=a*i-h*r,t[2]=s*i-f*r,t[3]=u*i-l*r,t[8]=o*r+c*i,t[9]=a*r+h*i,t[10]=s*r+f*i,t[11]=u*r+l*i,t}function b(t,e,n){var r=Math.sin(n),i=Math.cos(n),o=e[0],a=e[1],s=e[2],u=e[3],c=e[4],h=e[5],f=e[6],l=e[7];return e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=o*i+c*r,t[1]=a*i+h*r,t[2]=s*i+f*r,t[3]=u*i+l*r,t[4]=c*i-o*r,t[5]=h*i-a*r,t[6]=f*i-s*r,t[7]=l*i-u*r,t}function E(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=e[0],t[13]=e[1],t[14]=e[2],t[15]=1,t}function _(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=e[1],t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=e[2],t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function A(t,e,n){var i,o,a,s=n[0],u=n[1],c=n[2],h=Math.sqrt(s*s+u*u+c*c);return h<r.EPSILON?null:(s*=h=1/h,u*=h,c*=h,i=Math.sin(e),a=1-(o=Math.cos(e)),t[0]=s*s*a+o,t[1]=u*s*a+c*i,t[2]=c*s*a-u*i,t[3]=0,t[4]=s*u*a-c*i,t[5]=u*u*a+o,t[6]=c*u*a+s*i,t[7]=0,t[8]=s*c*a+u*i,t[9]=u*c*a-s*i,t[10]=c*c*a+o,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t)}function x(t,e){var n=Math.sin(e),r=Math.cos(e);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=r,t[6]=n,t[7]=0,t[8]=0,t[9]=-n,t[10]=r,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function k(t,e){var n=Math.sin(e),r=Math.cos(e);return t[0]=r,t[1]=0,t[2]=-n,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=n,t[9]=0,t[10]=r,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function T(t,e){var n=Math.sin(e),r=Math.cos(e);return t[0]=r,t[1]=n,t[2]=0,t[3]=0,t[4]=-n,t[5]=r,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function S(t,e,n){var r=e[0],i=e[1],o=e[2],a=e[3],s=r+r,u=i+i,c=o+o,h=r*s,f=r*u,l=r*c,p=i*u,d=i*c,v=o*c,y=a*s,m=a*u,g=a*c;return t[0]=1-(p+v),t[1]=f+g,t[2]=l-m,t[3]=0,t[4]=f-g,t[5]=1-(h+v),t[6]=d+y,t[7]=0,t[8]=l+m,t[9]=d-y,t[10]=1-(h+p),t[11]=0,t[12]=n[0],t[13]=n[1],t[14]=n[2],t[15]=1,t}function C(t,e){var n=new r.ARRAY_TYPE(3),i=-e[0],o=-e[1],a=-e[2],s=e[3],u=e[4],c=e[5],h=e[6],f=e[7],l=i*i+o*o+a*a+s*s;return l>0?(n[0]=2*(u*s+f*i+c*a-h*o)/l,n[1]=2*(c*s+f*o+h*i-u*a)/l,n[2]=2*(h*s+f*a+u*o-c*i)/l):(n[0]=2*(u*s+f*i+c*a-h*o),n[1]=2*(c*s+f*o+h*i-u*a),n[2]=2*(h*s+f*a+u*o-c*i)),S(t,e,n),t}function R(t,e){return t[0]=e[12],t[1]=e[13],t[2]=e[14],t}function P(t,e){var n=e[0],r=e[1],i=e[2],o=e[4],a=e[5],s=e[6],u=e[8],c=e[9],h=e[10];return t[0]=Math.sqrt(n*n+r*r+i*i),t[1]=Math.sqrt(o*o+a*a+s*s),t[2]=Math.sqrt(u*u+c*c+h*h),t}function I(t,e){var n=e[0]+e[5]+e[10],r=0;return n>0?(r=2*Math.sqrt(n+1),t[3]=.25*r,t[0]=(e[6]-e[9])/r,t[1]=(e[8]-e[2])/r,t[2]=(e[1]-e[4])/r):e[0]>e[5]&&e[0]>e[10]?(r=2*Math.sqrt(1+e[0]-e[5]-e[10]),t[3]=(e[6]-e[9])/r,t[0]=.25*r,t[1]=(e[1]+e[4])/r,t[2]=(e[8]+e[2])/r):e[5]>e[10]?(r=2*Math.sqrt(1+e[5]-e[0]-e[10]),t[3]=(e[8]-e[2])/r,t[0]=(e[1]+e[4])/r,t[1]=.25*r,t[2]=(e[6]+e[9])/r):(r=2*Math.sqrt(1+e[10]-e[0]-e[5]),t[3]=(e[1]-e[4])/r,t[0]=(e[8]+e[2])/r,t[1]=(e[6]+e[9])/r,t[2]=.25*r),t}function M(t,e,n,r){var i=e[0],o=e[1],a=e[2],s=e[3],u=i+i,c=o+o,h=a+a,f=i*u,l=i*c,p=i*h,d=o*c,v=o*h,y=a*h,m=s*u,g=s*c,w=s*h,b=r[0],E=r[1],_=r[2];return t[0]=(1-(d+y))*b,t[1]=(l+w)*b,t[2]=(p-g)*b,t[3]=0,t[4]=(l-w)*E,t[5]=(1-(f+y))*E,t[6]=(v+m)*E,t[7]=0,t[8]=(p+g)*_,t[9]=(v-m)*_,t[10]=(1-(f+d))*_,t[11]=0,t[12]=n[0],t[13]=n[1],t[14]=n[2],t[15]=1,t}function U(t,e,n,r,i){var o=e[0],a=e[1],s=e[2],u=e[3],c=o+o,h=a+a,f=s+s,l=o*c,p=o*h,d=o*f,v=a*h,y=a*f,m=s*f,g=u*c,w=u*h,b=u*f,E=r[0],_=r[1],A=r[2],x=i[0],k=i[1],T=i[2],S=(1-(v+m))*E,C=(p+b)*E,R=(d-w)*E,P=(p-b)*_,I=(1-(l+m))*_,M=(y+g)*_,U=(d+w)*A,O=(y-g)*A,D=(1-(l+v))*A;return t[0]=S,t[1]=C,t[2]=R,t[3]=0,t[4]=P,t[5]=I,t[6]=M,t[7]=0,t[8]=U,t[9]=O,t[10]=D,t[11]=0,t[12]=n[0]+x-(S*x+P*k+U*T),t[13]=n[1]+k-(C*x+I*k+O*T),t[14]=n[2]+T-(R*x+M*k+D*T),t[15]=1,t}function O(t,e){var n=e[0],r=e[1],i=e[2],o=e[3],a=n+n,s=r+r,u=i+i,c=n*a,h=r*a,f=r*s,l=i*a,p=i*s,d=i*u,v=o*a,y=o*s,m=o*u;return t[0]=1-f-d,t[1]=h+m,t[2]=l-y,t[3]=0,t[4]=h-m,t[5]=1-c-d,t[6]=p+v,t[7]=0,t[8]=l+y,t[9]=p-v,t[10]=1-c-f,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function D(t,e,n,r,i,o,a){var s=1/(n-e),u=1/(i-r),c=1/(o-a);return t[0]=2*o*s,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=2*o*u,t[6]=0,t[7]=0,t[8]=(n+e)*s,t[9]=(i+r)*u,t[10]=(a+o)*c,t[11]=-1,t[12]=0,t[13]=0,t[14]=a*o*2*c,t[15]=0,t}function L(t,e,n,r,i){var o,a=1/Math.tan(e/2);return t[0]=a/n,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=a,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,null!=i&&i!==1/0?(o=1/(r-i),t[10]=(i+r)*o,t[14]=2*i*r*o):(t[10]=-1,t[14]=-2*r),t}function N(t,e,n,r){var i=Math.tan(e.upDegrees*Math.PI/180),o=Math.tan(e.downDegrees*Math.PI/180),a=Math.tan(e.leftDegrees*Math.PI/180),s=Math.tan(e.rightDegrees*Math.PI/180),u=2/(a+s),c=2/(i+o);return t[0]=u,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=c,t[6]=0,t[7]=0,t[8]=-(a-s)*u*.5,t[9]=(i-o)*c*.5,t[10]=r/(n-r),t[11]=-1,t[12]=0,t[13]=0,t[14]=r*n/(n-r),t[15]=0,t}function F(t,e,n,r,i,o,a){var s=1/(e-n),u=1/(r-i),c=1/(o-a);return t[0]=-2*s,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*u,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*c,t[11]=0,t[12]=(e+n)*s,t[13]=(i+r)*u,t[14]=(a+o)*c,t[15]=1,t}function B(t,e,n,i){var o,a,s,u,h,f,l,p,d,v,y=e[0],m=e[1],g=e[2],w=i[0],b=i[1],E=i[2],_=n[0],A=n[1],x=n[2];return Math.abs(y-_)<r.EPSILON&&Math.abs(m-A)<r.EPSILON&&Math.abs(g-x)<r.EPSILON?c(t):(l=y-_,p=m-A,d=g-x,o=b*(d*=v=1/Math.sqrt(l*l+p*p+d*d))-E*(p*=v),a=E*(l*=v)-w*d,s=w*p-b*l,(v=Math.sqrt(o*o+a*a+s*s))?(o*=v=1/v,a*=v,s*=v):(o=0,a=0,s=0),u=p*s-d*a,h=d*o-l*s,f=l*a-p*o,(v=Math.sqrt(u*u+h*h+f*f))?(u*=v=1/v,h*=v,f*=v):(u=0,h=0,f=0),t[0]=o,t[1]=u,t[2]=l,t[3]=0,t[4]=a,t[5]=h,t[6]=p,t[7]=0,t[8]=s,t[9]=f,t[10]=d,t[11]=0,t[12]=-(o*y+a*m+s*g),t[13]=-(u*y+h*m+f*g),t[14]=-(l*y+p*m+d*g),t[15]=1,t)}function V(t,e,n,r){var i=e[0],o=e[1],a=e[2],s=r[0],u=r[1],c=r[2],h=i-n[0],f=o-n[1],l=a-n[2],p=h*h+f*f+l*l;p>0&&(h*=p=1/Math.sqrt(p),f*=p,l*=p);var d=u*l-c*f,v=c*h-s*l,y=s*f-u*h;return(p=d*d+v*v+y*y)>0&&(d*=p=1/Math.sqrt(p),v*=p,y*=p),t[0]=d,t[1]=v,t[2]=y,t[3]=0,t[4]=f*y-l*v,t[5]=l*d-h*y,t[6]=h*v-f*d,t[7]=0,t[8]=h,t[9]=f,t[10]=l,t[11]=0,t[12]=i,t[13]=o,t[14]=a,t[15]=1,t}function j(t){return"mat4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+", "+t[9]+", "+t[10]+", "+t[11]+", "+t[12]+", "+t[13]+", "+t[14]+", "+t[15]+")"}function Y(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2)+Math.pow(t[2],2)+Math.pow(t[3],2)+Math.pow(t[4],2)+Math.pow(t[5],2)+Math.pow(t[6],2)+Math.pow(t[7],2)+Math.pow(t[8],2)+Math.pow(t[9],2)+Math.pow(t[10],2)+Math.pow(t[11],2)+Math.pow(t[12],2)+Math.pow(t[13],2)+Math.pow(t[14],2)+Math.pow(t[15],2))}function G(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t[4]=e[4]+n[4],t[5]=e[5]+n[5],t[6]=e[6]+n[6],t[7]=e[7]+n[7],t[8]=e[8]+n[8],t[9]=e[9]+n[9],t[10]=e[10]+n[10],t[11]=e[11]+n[11],t[12]=e[12]+n[12],t[13]=e[13]+n[13],t[14]=e[14]+n[14],t[15]=e[15]+n[15],t}function W(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t[3]=e[3]-n[3],t[4]=e[4]-n[4],t[5]=e[5]-n[5],t[6]=e[6]-n[6],t[7]=e[7]-n[7],t[8]=e[8]-n[8],t[9]=e[9]-n[9],t[10]=e[10]-n[10],t[11]=e[11]-n[11],t[12]=e[12]-n[12],t[13]=e[13]-n[13],t[14]=e[14]-n[14],t[15]=e[15]-n[15],t}function q(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t[4]=e[4]*n,t[5]=e[5]*n,t[6]=e[6]*n,t[7]=e[7]*n,t[8]=e[8]*n,t[9]=e[9]*n,t[10]=e[10]*n,t[11]=e[11]*n,t[12]=e[12]*n,t[13]=e[13]*n,t[14]=e[14]*n,t[15]=e[15]*n,t}function z(t,e,n,r){return t[0]=e[0]+n[0]*r,t[1]=e[1]+n[1]*r,t[2]=e[2]+n[2]*r,t[3]=e[3]+n[3]*r,t[4]=e[4]+n[4]*r,t[5]=e[5]+n[5]*r,t[6]=e[6]+n[6]*r,t[7]=e[7]+n[7]*r,t[8]=e[8]+n[8]*r,t[9]=e[9]+n[9]*r,t[10]=e[10]+n[10]*r,t[11]=e[11]+n[11]*r,t[12]=e[12]+n[12]*r,t[13]=e[13]+n[13]*r,t[14]=e[14]+n[14]*r,t[15]=e[15]+n[15]*r,t}function X(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]&&t[6]===e[6]&&t[7]===e[7]&&t[8]===e[8]&&t[9]===e[9]&&t[10]===e[10]&&t[11]===e[11]&&t[12]===e[12]&&t[13]===e[13]&&t[14]===e[14]&&t[15]===e[15]}function H(t,e){var n=t[0],i=t[1],o=t[2],a=t[3],s=t[4],u=t[5],c=t[6],h=t[7],f=t[8],l=t[9],p=t[10],d=t[11],v=t[12],y=t[13],m=t[14],g=t[15],w=e[0],b=e[1],E=e[2],_=e[3],A=e[4],x=e[5],k=e[6],T=e[7],S=e[8],C=e[9],R=e[10],P=e[11],I=e[12],M=e[13],U=e[14],O=e[15];return Math.abs(n-w)<=r.EPSILON*Math.max(1,Math.abs(n),Math.abs(w))&&Math.abs(i-b)<=r.EPSILON*Math.max(1,Math.abs(i),Math.abs(b))&&Math.abs(o-E)<=r.EPSILON*Math.max(1,Math.abs(o),Math.abs(E))&&Math.abs(a-_)<=r.EPSILON*Math.max(1,Math.abs(a),Math.abs(_))&&Math.abs(s-A)<=r.EPSILON*Math.max(1,Math.abs(s),Math.abs(A))&&Math.abs(u-x)<=r.EPSILON*Math.max(1,Math.abs(u),Math.abs(x))&&Math.abs(c-k)<=r.EPSILON*Math.max(1,Math.abs(c),Math.abs(k))&&Math.abs(h-T)<=r.EPSILON*Math.max(1,Math.abs(h),Math.abs(T))&&Math.abs(f-S)<=r.EPSILON*Math.max(1,Math.abs(f),Math.abs(S))&&Math.abs(l-C)<=r.EPSILON*Math.max(1,Math.abs(l),Math.abs(C))&&Math.abs(p-R)<=r.EPSILON*Math.max(1,Math.abs(p),Math.abs(R))&&Math.abs(d-P)<=r.EPSILON*Math.max(1,Math.abs(d),Math.abs(P))&&Math.abs(v-I)<=r.EPSILON*Math.max(1,Math.abs(v),Math.abs(I))&&Math.abs(y-M)<=r.EPSILON*Math.max(1,Math.abs(y),Math.abs(M))&&Math.abs(m-U)<=r.EPSILON*Math.max(1,Math.abs(m),Math.abs(U))&&Math.abs(g-O)<=r.EPSILON*Math.max(1,Math.abs(g),Math.abs(O))}var K=d,J=W},function(t,e,n){var r=n(2);r(r.S,"Array",{isArray:n(53)})},function(t,e,n){"use strict";var r=n(2),i=n(129);r(r.P+r.F*n(130)("includes"),"String",{includes:function(t){return!!~i(this,t,"includes").indexOf(t,arguments.length>1?arguments[1]:void 0)}})},function(t,e,n){"use strict";var r=n(2),i=n(45)(!0);r(r.P,"Array",{includes:function(t){return i(this,t,arguments.length>1?arguments[1]:void 0)}}),n(44)("includes")},function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var r=n(0);function i(){var t=new r.ARRAY_TYPE(9);return r.ARRAY_TYPE!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[5]=0,t[6]=0,t[7]=0),t[0]=1,t[4]=1,t[8]=1,t}},function(t,e,n){"use strict";n(128)("sub",(function(t){return function(){return t(this,"sub","","")}}))},function(t,e,n){var r=n(6),i=n(8),o=n(30);t.exports=n(7)?Object.defineProperties:function(t,e){i(t);for(var n,a=o(e),s=a.length,u=0;s>u;)r.f(t,n=a[u++],e[n]);return t}},function(t,e){t.exports=function(t,e,n){var r=void 0===n;switch(e.length){case 0:return r?t():t.call(n);case 1:return r?t(e[0]):t.call(n,e[0]);case 2:return r?t(e[0],e[1]):t.call(n,e[0],e[1]);case 3:return r?t(e[0],e[1],e[2]):t.call(n,e[0],e[1],e[2]);case 4:return r?t(e[0],e[1],e[2],e[3]):t.call(n,e[0],e[1],e[2],e[3])}return t.apply(n,e)}},function(t,e,n){var r=n(4).navigator;t.exports=r&&r.userAgent||""},function(t,e,n){var r=n(22),i=n(30);n(132)("keys",(function(){return function(t){return i(r(t))}}))},function(t,e,n){"use strict";n.d(e,"a",(function(){return u}));n(57),n(21),n(97),n(96),n(124),n(90),n(116),n(75),n(56),n(62),n(40),n(35),n(55),n(145);var r=n(61),i=n(14);function o(t,e,n,r,i,o,a){try{var s=t[o](a),u=s.value}catch(t){return void n(t)}s.done?e(u):Promise.resolve(u).then(r,i)}function a(t){return function(){var e=this,n=arguments;return new Promise((function(r,i){var a=t.apply(e,n);function s(t){o(a,r,i,s,u,"next",t)}function u(t){o(a,r,i,s,u,"throw",t)}s(void 0)}))}}function s(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var u=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.entities=new Map,this.euidMap=new Map,this.dirtyEntities={},this.unsavedEntities={},this.componentDefaultValues={},this.rootLinkerEntity=null,this.resolveEntity=e}var e,n,o,u,c;return e=t,(n=[{key:"addEntity",value:(c=a(regeneratorRuntime.mark((function t(e){var n,i,o;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!(n=this.getEntity(e.rtid))){t.next=5;break}console.warn("Attempt to add an existing entity in the registry"),t.next=18;break;case 5:if((n=new r.a(this,e)).resolveLinker(),this.entities.set(n.getID(),n),this.euidMap.has(n.getEUID())||this.euidMap.set(n.getEUID(),[]),this.euidMap.get(n.getEUID()).push(n),!n.components.hasOwnProperty("overridden")){t.next=18;break}if(i=n.components.overridden.overriderEntityRTID,o=this.getEntity(i)){t.next=17;break}return t.next=16,this.resolveEntity(i);case 16:o=t.sent;case 17:o?(n.overrider=o,o.overriddenEntity=n):console.warn("Cannot find the overrider entity ".concat(JSON.stringify(n.components.overridden)));case 18:return t.abrupt("return",n);case 19:case"end":return t.stop()}}),t,this)}))),function(t){return c.apply(this,arguments)})},{key:"deleteEntity",value:function(t){var e=(this.entities.size>0?Array.from(this.entities.values()):[]).filter((function(e){return t.isSame(e.getParent())}));e.length>0&&this.deleteEntities(e);var n=t.getID(),r=this.euidMap.get(t.getEUID());if(r){var i=r.findIndex((function(t){return t.getID()==n}));-1!=i&&r.splice(i,1)}this.entities.delete(n),delete this.dirtyEntities[n],delete this.unsavedEntities[n]}},{key:"deleteEntities",value:function(t){for(var e in t)this.deleteEntity(t[e])}},{key:"getEntity",value:function(t){return this.entities.get(t)||null}},{key:"getOrAddEntity",value:(u=a(regeneratorRuntime.mark((function t(e,n){var r;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=this.getEntity(e)){t.next=5;break}return t.next=4,this.addEntity(n);case 4:r=t.sent;case 5:return t.abrupt("return",r);case 6:case"end":return t.stop()}}),t,this)}))),function(t,e){return u.apply(this,arguments)})},{key:"getEntitiesByEUID",value:function(t){return this.euidMap.get(t)||[]}},{key:"getRootEntities",value:function(){return(this.entities.size>0?Array.from(this.entities.values()):[]).filter((function(t){return!t.hasParent()}))}},{key:"getLinkers",value:function(){return(this.entities.size>0?Array.from(this.entities.values()):[]).filter((function(t){return t.isLinker()}))}},{key:"hasEntity",value:function(t){return this.entities.has(t)}},{key:"setDirtyEntity",value:function(t){this.UNSAFE_setDirtyEntity(t),this.unsavedEntities[t.getID()]=t}},{key:"UNSAFE_setDirtyEntity",value:function(t){this.dirtyEntities[t.getID()]=t}},{key:"setComponentDescriptions",value:function(t){this.componentDescriptions=t}},{key:"getComponentDefaultValue",value:function(t){return this.componentDefaultValues.hasOwnProperty(t)||this.addComponentDefaultValueToCache(t),i.a.clone(this.componentDefaultValues[t])}},{key:"addComponentDefaultValueToCache",value:function(t){var e=this.componentDescriptions[t];if(e){var n={};for(var r in e.attributes){var i=e.attributes[r];i.mods&&i.mods.indexOf("engine-only")>-1||(i.default?n[i.name]=i.default:"string"==i.type?n[i.name]="":"json"==i.type?n[i.name]={}:"uuid"==i.type||i.type.includes("_ref")?n[i.name]="00000000-0000-0000-0000-000000000000":"bool"==i.type?n[i.name]=!1:i.type.includes("array")?n[i.name]=[]:"float"==i.type||i.type.includes("int")?n[i.name]=0:i.type.includes("map<")?n[i.name]={}:console.warn("Unrecognized attribute type : ".concat(i.type)))}this.componentDefaultValues[t]=n}else console.warn("Unrecognized component : ".concat(t))}}])&&s(e.prototype,n),o&&s(e,o),t}()},function(t,e,n){t.exports=n(34)("native-function-to-string",Function.toString)},function(t,e,n){"use strict";var r=n(33),i=n(26),o=n(27),a={};n(10)(a,n(3)("iterator"),(function(){return this})),t.exports=function(t,e,n){t.prototype=r(a,{next:i(1,n)}),o(t,e+" Iterator")}},function(t,e,n){var r=n(4),i=n(71).set,o=r.MutationObserver||r.WebKitMutationObserver,a=r.process,s=r.Promise,u="process"==n(24)(a);t.exports=function(){var t,e,n,c=function(){var r,i;for(u&&(r=a.domain)&&r.exit();t;){i=t.fn,t=t.next;try{i()}catch(r){throw t?n():e=void 0,r}}e=void 0,r&&r.enter()};if(u)n=function(){a.nextTick(c)};else if(!o||r.navigator&&r.navigator.standalone)if(s&&s.resolve){var h=s.resolve(void 0);n=function(){h.then(c)}}else n=function(){i.call(r,c)};else{var f=!0,l=document.createTextNode("");new o(c).observe(l,{characterData:!0}),n=function(){l.data=f=!f}}return function(r){var i={fn:r,next:void 0};e&&(e.next=i),t||(t=i,n()),e=i}}},function(t,e){t.exports=function(t){try{return{e:!1,v:t()}}catch(t){return{e:!0,v:t}}}},function(t,e,n){var r=n(8),i=n(5),o=n(72);t.exports=function(t,e){if(r(t),i(e)&&e.constructor===t)return e;var n=o.f(t);return(0,n.resolve)(e),n.promise}},function(t,e,n){"use strict";if(n(7)){var r=n(20),i=n(4),o=n(9),a=n(2),s=n(88),u=n(117),c=n(13),h=n(41),f=n(26),l=n(10),p=n(42),d=n(28),v=n(17),y=n(118),m=n(51),g=n(37),w=n(15),b=n(52),E=n(5),_=n(22),A=n(59),x=n(33),k=n(78),T=n(43).f,S=n(60),C=n(19),R=n(3),P=n(31),I=n(45),M=n(79),U=n(35),O=n(25),D=n(46),L=n(64),N=n(111),F=n(140),B=n(6),V=n(54),j=B.f,Y=V.f,G=i.RangeError,W=i.TypeError,q=i.Uint8Array,z=Array.prototype,X=u.ArrayBuffer,H=u.DataView,K=P(0),J=P(2),Q=P(3),$=P(4),Z=P(5),tt=P(6),et=I(!0),nt=I(!1),rt=U.values,it=U.keys,ot=U.entries,at=z.lastIndexOf,st=z.reduce,ut=z.reduceRight,ct=z.join,ht=z.sort,ft=z.slice,lt=z.toString,pt=z.toLocaleString,dt=R("iterator"),vt=R("toStringTag"),yt=C("typed_constructor"),mt=C("def_constructor"),gt=s.CONSTR,wt=s.TYPED,bt=s.VIEW,Et=P(1,(function(t,e){return Tt(M(t,t[mt]),e)})),_t=o((function(){return 1===new q(new Uint16Array([1]).buffer)[0]})),At=!!q&&!!q.prototype.set&&o((function(){new q(1).set({})})),xt=function(t,e){var n=d(t);if(n<0||n%e)throw G("Wrong offset!");return n},kt=function(t){if(E(t)&&wt in t)return t;throw W(t+" is not a typed array!")},Tt=function(t,e){if(!(E(t)&&yt in t))throw W("It is not a typed array constructor!");return new t(e)},St=function(t,e){return Ct(M(t,t[mt]),e)},Ct=function(t,e){for(var n=0,r=e.length,i=Tt(t,r);r>n;)i[n]=e[n++];return i},Rt=function(t,e,n){j(t,e,{get:function(){return this._d[n]}})},Pt=function(t){var e,n,r,i,o,a,s=_(t),u=arguments.length,h=u>1?arguments[1]:void 0,f=void 0!==h,l=S(s);if(null!=l&&!A(l)){for(a=l.call(s),r=[],e=0;!(o=a.next()).done;e++)r.push(o.value);s=r}for(f&&u>2&&(h=c(h,arguments[2],2)),e=0,n=v(s.length),i=Tt(this,n);n>e;e++)i[e]=f?h(s[e],e):s[e];return i},It=function(){for(var t=0,e=arguments.length,n=Tt(this,e);e>t;)n[t]=arguments[t++];return n},Mt=!!q&&o((function(){pt.call(new q(1))})),Ut=function(){return pt.apply(Mt?ft.call(kt(this)):kt(this),arguments)},Ot={copyWithin:function(t,e){return F.call(kt(this),t,e,arguments.length>2?arguments[2]:void 0)},every:function(t){return $(kt(this),t,arguments.length>1?arguments[1]:void 0)},fill:function(t){return N.apply(kt(this),arguments)},filter:function(t){return St(this,J(kt(this),t,arguments.length>1?arguments[1]:void 0))},find:function(t){return Z(kt(this),t,arguments.length>1?arguments[1]:void 0)},findIndex:function(t){return tt(kt(this),t,arguments.length>1?arguments[1]:void 0)},forEach:function(t){K(kt(this),t,arguments.length>1?arguments[1]:void 0)},indexOf:function(t){return nt(kt(this),t,arguments.length>1?arguments[1]:void 0)},includes:function(t){return et(kt(this),t,arguments.length>1?arguments[1]:void 0)},join:function(t){return ct.apply(kt(this),arguments)},lastIndexOf:function(t){return at.apply(kt(this),arguments)},map:function(t){return Et(kt(this),t,arguments.length>1?arguments[1]:void 0)},reduce:function(t){return st.apply(kt(this),arguments)},reduceRight:function(t){return ut.apply(kt(this),arguments)},reverse:function(){for(var t,e=kt(this).length,n=Math.floor(e/2),r=0;r<n;)t=this[r],this[r++]=this[--e],this[e]=t;return this},some:function(t){return Q(kt(this),t,arguments.length>1?arguments[1]:void 0)},sort:function(t){return ht.call(kt(this),t)},subarray:function(t,e){var n=kt(this),r=n.length,i=m(t,r);return new(M(n,n[mt]))(n.buffer,n.byteOffset+i*n.BYTES_PER_ELEMENT,v((void 0===e?r:m(e,r))-i))}},Dt=function(t,e){return St(this,ft.call(kt(this),t,e))},Lt=function(t){kt(this);var e=xt(arguments[1],1),n=this.length,r=_(t),i=v(r.length),o=0;if(i+e>n)throw G("Wrong length!");for(;o<i;)this[e+o]=r[o++]},Nt={entries:function(){return ot.call(kt(this))},keys:function(){return it.call(kt(this))},values:function(){return rt.call(kt(this))}},Ft=function(t,e){return E(t)&&t[wt]&&"symbol"!=typeof e&&e in t&&String(+e)==String(e)},Bt=function(t,e){return Ft(t,e=g(e,!0))?f(2,t[e]):Y(t,e)},Vt=function(t,e,n){return!(Ft(t,e=g(e,!0))&&E(n)&&w(n,"value"))||w(n,"get")||w(n,"set")||n.configurable||w(n,"writable")&&!n.writable||w(n,"enumerable")&&!n.enumerable?j(t,e,n):(t[e]=n.value,t)};gt||(V.f=Bt,B.f=Vt),a(a.S+a.F*!gt,"Object",{getOwnPropertyDescriptor:Bt,defineProperty:Vt}),o((function(){lt.call({})}))&&(lt=pt=function(){return ct.call(this)});var jt=p({},Ot);p(jt,Nt),l(jt,dt,Nt.values),p(jt,{slice:Dt,set:Lt,constructor:function(){},toString:lt,toLocaleString:Ut}),Rt(jt,"buffer","b"),Rt(jt,"byteOffset","o"),Rt(jt,"byteLength","l"),Rt(jt,"length","e"),j(jt,vt,{get:function(){return this[wt]}}),t.exports=function(t,e,n,u){var c=t+((u=!!u)?"Clamped":"")+"Array",f="get"+t,p="set"+t,d=i[c],m=d||{},g=d&&k(d),w=!d||!s.ABV,_={},A=d&&d.prototype,S=function(t,n){j(t,n,{get:function(){return function(t,n){var r=t._d;return r.v[f](n*e+r.o,_t)}(this,n)},set:function(t){return function(t,n,r){var i=t._d;u&&(r=(r=Math.round(r))<0?0:r>255?255:255&r),i.v[p](n*e+i.o,r,_t)}(this,n,t)},enumerable:!0})};w?(d=n((function(t,n,r,i){h(t,d,c,"_d");var o,a,s,u,f=0,p=0;if(E(n)){if(!(n instanceof X||"ArrayBuffer"==(u=b(n))||"SharedArrayBuffer"==u))return wt in n?Ct(d,n):Pt.call(d,n);o=n,p=xt(r,e);var m=n.byteLength;if(void 0===i){if(m%e)throw G("Wrong length!");if((a=m-p)<0)throw G("Wrong length!")}else if((a=v(i)*e)+p>m)throw G("Wrong length!");s=a/e}else s=y(n),o=new X(a=s*e);for(l(t,"_d",{b:o,o:p,l:a,e:s,v:new H(o)});f<s;)S(t,f++)})),A=d.prototype=x(jt),l(A,"constructor",d)):o((function(){d(1)}))&&o((function(){new d(-1)}))&&D((function(t){new d,new d(null),new d(1.5),new d(t)}),!0)||(d=n((function(t,n,r,i){var o;return h(t,d,c),E(n)?n instanceof X||"ArrayBuffer"==(o=b(n))||"SharedArrayBuffer"==o?void 0!==i?new m(n,xt(r,e),i):void 0!==r?new m(n,xt(r,e)):new m(n):wt in n?Ct(d,n):Pt.call(d,n):new m(y(n))})),K(g!==Function.prototype?T(m).concat(T(g)):T(m),(function(t){t in d||l(d,t,m[t])})),d.prototype=A,r||(A.constructor=d));var C=A[dt],R=!!C&&("values"==C.name||null==C.name),P=Nt.values;l(d,yt,!0),l(A,wt,c),l(A,bt,!0),l(A,mt,d),(u?new d(1)[vt]==c:vt in A)||j(A,vt,{get:function(){return c}}),_[c]=d,a(a.G+a.W+a.F*(d!=m),_),a(a.S,c,{BYTES_PER_ELEMENT:e}),a(a.S+a.F*o((function(){m.of.call(d,1)})),c,{from:Pt,of:It}),"BYTES_PER_ELEMENT"in A||l(A,"BYTES_PER_ELEMENT",e),a(a.P,c,Ot),L(c),a(a.P+a.F*At,c,{set:Lt}),a(a.P+a.F*!R,c,Nt),r||A.toString==lt||(A.toString=lt),a(a.P+a.F*o((function(){new d(1).slice()})),c,{slice:Dt}),a(a.P+a.F*(o((function(){return[1,2].toLocaleString()!=new d([1,2]).toLocaleString()}))||!o((function(){A.toLocaleString.call([1,2])}))),c,{toLocaleString:Ut}),O[c]=R?C:P,r||R||l(A,dt,P)}}else t.exports=function(){}},function(t,e,n){"use strict";var r=n(22),i=n(51),o=n(17);t.exports=function(t){for(var e=r(this),n=o(e.length),a=arguments.length,s=i(a>1?arguments[1]:void 0,n),u=a>2?arguments[2]:void 0,c=void 0===u?n:i(u,n);c>s;)e[s++]=t;return e}},function(t,e,n){var r=n(113);t.exports=function(t,e){return new(r(t))(e)}},function(t,e,n){var r=n(5),i=n(53),o=n(3)("species");t.exports=function(t){var e;return i(t)&&("function"!=typeof(e=t.constructor)||e!==Array&&!i(e.prototype)||(e=void 0),r(e)&&null===(e=e[o])&&(e=void 0)),void 0===e?Array:e}},function(t,e,n){var r=n(30),i=n(67),o=n(47);t.exports=function(t){var e=r(t),n=i.f;if(n)for(var a,s=n(t),u=o.f,c=0;s.length>c;)u.call(t,a=s[c++])&&e.push(a);return e}},function(t,e,n){var r=n(23),i=n(43).f,o={}.toString,a="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[];t.exports.f=function(t){return a&&"[object Window]"==o.call(t)?function(t){try{return i(t)}catch(t){return a.slice()}}(t):i(r(t))}},function(t,e,n){"use strict";var r=n(2),i=n(31)(6),o="findIndex",a=!0;o in[]&&Array(1)[o]((function(){a=!1})),r(r.P+r.F*a,"Array",{findIndex:function(t){return i(this,t,arguments.length>1?arguments[1]:void 0)}}),n(44)(o)},function(t,e,n){"use strict";var r=n(4),i=n(7),o=n(20),a=n(88),s=n(10),u=n(42),c=n(9),h=n(41),f=n(28),l=n(17),p=n(118),d=n(43).f,v=n(6).f,y=n(111),m=n(27),g=r.ArrayBuffer,w=r.DataView,b=r.Math,E=r.RangeError,_=r.Infinity,A=g,x=b.abs,k=b.pow,T=b.floor,S=b.log,C=b.LN2,R=i?"_b":"buffer",P=i?"_l":"byteLength",I=i?"_o":"byteOffset";function M(t,e,n){var r,i,o,a=new Array(n),s=8*n-e-1,u=(1<<s)-1,c=u>>1,h=23===e?k(2,-24)-k(2,-77):0,f=0,l=t<0||0===t&&1/t<0?1:0;for((t=x(t))!=t||t===_?(i=t!=t?1:0,r=u):(r=T(S(t)/C),t*(o=k(2,-r))<1&&(r--,o*=2),(t+=r+c>=1?h/o:h*k(2,1-c))*o>=2&&(r++,o/=2),r+c>=u?(i=0,r=u):r+c>=1?(i=(t*o-1)*k(2,e),r+=c):(i=t*k(2,c-1)*k(2,e),r=0));e>=8;a[f++]=255&i,i/=256,e-=8);for(r=r<<e|i,s+=e;s>0;a[f++]=255&r,r/=256,s-=8);return a[--f]|=128*l,a}function U(t,e,n){var r,i=8*n-e-1,o=(1<<i)-1,a=o>>1,s=i-7,u=n-1,c=t[u--],h=127&c;for(c>>=7;s>0;h=256*h+t[u],u--,s-=8);for(r=h&(1<<-s)-1,h>>=-s,s+=e;s>0;r=256*r+t[u],u--,s-=8);if(0===h)h=1-a;else{if(h===o)return r?NaN:c?-_:_;r+=k(2,e),h-=a}return(c?-1:1)*r*k(2,h-e)}function O(t){return t[3]<<24|t[2]<<16|t[1]<<8|t[0]}function D(t){return[255&t]}function L(t){return[255&t,t>>8&255]}function N(t){return[255&t,t>>8&255,t>>16&255,t>>24&255]}function F(t){return M(t,52,8)}function B(t){return M(t,23,4)}function V(t,e,n){v(t.prototype,e,{get:function(){return this[n]}})}function j(t,e,n,r){var i=p(+n);if(i+e>t[P])throw E("Wrong index!");var o=t[R]._b,a=i+t[I],s=o.slice(a,a+e);return r?s:s.reverse()}function Y(t,e,n,r,i,o){var a=p(+n);if(a+e>t[P])throw E("Wrong index!");for(var s=t[R]._b,u=a+t[I],c=r(+i),h=0;h<e;h++)s[u+h]=c[o?h:e-h-1]}if(a.ABV){if(!c((function(){g(1)}))||!c((function(){new g(-1)}))||c((function(){return new g,new g(1.5),new g(NaN),"ArrayBuffer"!=g.name}))){for(var G,W=(g=function(t){return h(this,g),new A(p(t))}).prototype=A.prototype,q=d(A),z=0;q.length>z;)(G=q[z++])in g||s(g,G,A[G]);o||(W.constructor=g)}var X=new w(new g(2)),H=w.prototype.setInt8;X.setInt8(0,2147483648),X.setInt8(1,2147483649),!X.getInt8(0)&&X.getInt8(1)||u(w.prototype,{setInt8:function(t,e){H.call(this,t,e<<24>>24)},setUint8:function(t,e){H.call(this,t,e<<24>>24)}},!0)}else g=function(t){h(this,g,"ArrayBuffer");var e=p(t);this._b=y.call(new Array(e),0),this[P]=e},w=function(t,e,n){h(this,w,"DataView"),h(t,g,"DataView");var r=t[P],i=f(e);if(i<0||i>r)throw E("Wrong offset!");if(i+(n=void 0===n?r-i:l(n))>r)throw E("Wrong length!");this[R]=t,this[I]=i,this[P]=n},i&&(V(g,"byteLength","_l"),V(w,"buffer","_b"),V(w,"byteLength","_l"),V(w,"byteOffset","_o")),u(w.prototype,{getInt8:function(t){return j(this,1,t)[0]<<24>>24},getUint8:function(t){return j(this,1,t)[0]},getInt16:function(t){var e=j(this,2,t,arguments[1]);return(e[1]<<8|e[0])<<16>>16},getUint16:function(t){var e=j(this,2,t,arguments[1]);return e[1]<<8|e[0]},getInt32:function(t){return O(j(this,4,t,arguments[1]))},getUint32:function(t){return O(j(this,4,t,arguments[1]))>>>0},getFloat32:function(t){return U(j(this,4,t,arguments[1]),23,4)},getFloat64:function(t){return U(j(this,8,t,arguments[1]),52,8)},setInt8:function(t,e){Y(this,1,t,D,e)},setUint8:function(t,e){Y(this,1,t,D,e)},setInt16:function(t,e){Y(this,2,t,L,e,arguments[2])},setUint16:function(t,e){Y(this,2,t,L,e,arguments[2])},setInt32:function(t,e){Y(this,4,t,N,e,arguments[2])},setUint32:function(t,e){Y(this,4,t,N,e,arguments[2])},setFloat32:function(t,e){Y(this,4,t,B,e,arguments[2])},setFloat64:function(t,e){Y(this,8,t,F,e,arguments[2])}});m(g,"ArrayBuffer"),m(w,"DataView"),s(w.prototype,a.VIEW,!0),e.ArrayBuffer=g,e.DataView=w},function(t,e,n){var r=n(28),i=n(17);t.exports=function(t){if(void 0===t)return 0;var e=r(t),n=i(e);if(e!==n)throw RangeError("Wrong length!");return n}},function(t,e,n){e.UINT32=n(142),e.UINT64=n(143)},function(t,e,n){var r=n(5);t.exports=function(t,e){if(!r(t)||t._t!==e)throw TypeError("Incompatible receiver, "+e+" required!");return t}},function(t,e,n){var r=n(28),i=n(29);t.exports=function(t){return function(e,n){var o,a,s=String(i(e)),u=r(n),c=s.length;return u<0||u>=c?t?"":void 0:(o=s.charCodeAt(u))<55296||o>56319||u+1===c||(a=s.charCodeAt(u+1))<56320||a>57343?t?s.charAt(u):o:t?s.slice(u,u+2):a-56320+(o-55296<<10)+65536}}},function(t,e,n){n(110)("Uint8",1,(function(t){return function(e,n,r){return t(this,e,n,r)}}))},function(t,e,n){"use strict";e.a={registration:1,video_stream:2,inputs:3,viewer_control:4,client_remote_operations:5,editor_remote_operations:6,camera_sharing:7,broadcast_clients:8,broadcast_video_stream:9,spatial_anchor:10,heartbeat:11,video_stream_header:12}},function(t,e,n){var r=n(6).f,i=Function.prototype,o=/^\s*function ([^ (]*)/;"name"in i||n(7)&&r(i,"name",{configurable:!0,get:function(){try{return(""+this).match(o)[1]}catch(t){return""}}})},function(t,e,n){"use strict";var r=n(6),i=n(26);t.exports=function(t,e,n){e in t?r.f(t,e,i(0,n)):t[e]=n}},function(t,e,n){var r=n(2);r(r.G+r.W+r.F*!n(88).ABV,{DataView:n(117).DataView})},function(t,e,n){var r=n(5),i=n(24),o=n(3)("match");t.exports=function(t){var e;return r(t)&&(void 0!==(e=t[o])?!!e:"RegExp"==i(t))}},function(t,e,n){var r=n(2),i=n(9),o=n(29),a=/"/g,s=function(t,e,n,r){var i=String(o(t)),s="<"+e;return""!==n&&(s+=" "+n+'="'+String(r).replace(a,"&quot;")+'"'),s+">"+i+"</"+e+">"};t.exports=function(t,e){var n={};n[t]=e(s),r(r.P+r.F*i((function(){var e=""[t]('"');return e!==e.toLowerCase()||e.split('"').length>3})),"String",n)}},function(t,e,n){var r=n(127),i=n(29);t.exports=function(t,e,n){if(r(e))throw TypeError("String#"+n+" doesn't accept regex!");return String(i(t))}},function(t,e,n){var r=n(3)("match");t.exports=function(t){var e=/./;try{"/./"[t](e)}catch(n){try{return e[r]=!1,!"/./"[t](e)}catch(t){}}return!0}},function(t,e,n){n(7)&&"g"!=/./g.flags&&n(6).f(RegExp.prototype,"flags",{configurable:!0,get:n(93)})},function(t,e,n){var r=n(2),i=n(18),o=n(9);t.exports=function(t,e){var n=(i.Object||{})[t]||Object[t],a={};a[t]=e(n),r(r.S+r.F*o((function(){n(1)})),"Object",a)}},function(t,e,n){(function(r){var i;
/*!
**  Pure-UUID -- Pure JavaScript Based Universally Unique Identifier (UUID)
**  Copyright (c) 2004-2018 Ralf S. Engelschall <rse@engelschall.com>
**
**  Permission is hereby granted, free of charge, to any person obtaining
**  a copy of this software and associated documentation files (the
**  "Software"), to deal in the Software without restriction, including
**  without limitation the rights to use, copy, modify, merge, publish,
**  distribute, sublicense, and/or sell copies of the Software, and to
**  permit persons to whom the Software is furnished to do so, subject to
**  the following conditions:
**
**  The above copyright notice and this permission notice shall be included
**  in all copies or substantial portions of the Software.
**
**  THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
**  EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
**  MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.
**  IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY
**  CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT,
**  TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE
**  SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
*/void 0===(i=function(){return function(){var t=function(t,e,n,r,i,o){for(var a=function(t,e){var n=t.toString(16);return n.length<2&&(n="0"+n),e&&(n=n.toUpperCase()),n},s=e;s<=n;s++)i[o++]=a(t[s],r);return i},e=function(t,e,n,r,i){for(var o=e;o<=n;o+=2)r[i++]=parseInt(t.substr(o,2),16)},n="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ.-:+=^!/*?&<>()[]{}@%$#".split(""),i=[0,68,0,84,83,82,72,0,75,76,70,65,0,63,62,69,0,1,2,3,4,5,6,7,8,9,64,0,73,66,74,71,81,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,77,0,78,67,0,0,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,79,0,80,0,0],o=function(t,e){var n={ibits:8,obits:8,obigendian:!0};for(var r in e)void 0!==n[r]&&(n[r]=e[r]);for(var i,o,a,s=[],u=0,c=0,h=0,f=t.length;0===c&&(o=t.charCodeAt(u++)),i=o>>n.ibits-(c+8)&255,c=(c+8)%n.ibits,n.obigendian?0===h?a=i<<n.obits-8:a|=i<<n.obits-8-h:0===h?a=i:a|=i<<h,!(0==(h=(h+8)%n.obits)&&(s.push(a),u>=f)););return s},a=function(t,e){var n={ibits:32,ibigendian:!0};for(var r in e)void 0!==n[r]&&(n[r]=e[r]);var i="",o=4294967295;n.ibits<32&&(o=(1<<n.ibits)-1);for(var a=t.length,s=0;s<a;s++)for(var u=t[s]&o,c=0;c<n.ibits;c+=8)n.ibigendian?i+=String.fromCharCode(u>>n.ibits-8-c&255):i+=String.fromCharCode(u>>c&255);return i},s=function(t,e,n,r,i,o,a,s){return[s,a,o,i,r,n,e,t]},u=function(){return s(0,0,0,0,0,0,0,0)},c=function(t){return t.slice(0)},h=function(t){for(var e=u(),n=0;n<8;n++)e[n]=Math.floor(t%256),t/=256;return e},f=function(t){for(var e=0,n=7;n>=0;n--)e*=256,e+=t[n];return Math.floor(e)},l=function(t,e){for(var n=0,r=0;r<8;r++)n+=t[r]+e[r],t[r]=Math.floor(n%256),n=Math.floor(n/256);return n},p=function(t,e){for(var n=0,r=0;r<8;r++)n+=t[r]*e,t[r]=Math.floor(n%256),n=Math.floor(n/256);return n},d=function(t,e){for(var n=0;n<8;n++)t[n]&=e[n];return t},v=function(t,e){var n=u();if(e%8!=0)throw new Error("ui64_rorn: only bit rotations supported with a multiple of digit bits");for(var r=Math.floor(e/8),i=0;i<r;i++){for(var o=6;o>=0;o--)n[o+1]=n[o];for(n[0]=t[0],o=0;o<7;o++)t[o]=t[o+1];t[o]=0}return f(n)},y=function(t,e){if(e>64)throw new Error("ui64_ror: invalid number of bits to shift");var n,r=new Array(16);for(n=0;n<8;n++)r[n+8]=t[n],r[n]=0;var i=Math.floor(e/8),o=e%8;for(n=i;n<15;n++)r[n-i]=255&(r[n]>>>o|r[n+1]<<8-o);for(r[15-i]=r[15]>>>o&255,n=15-i+1;n<16;n++)r[n]=0;for(n=0;n<8;n++)t[n]=r[n+8];return r.slice(0,8)},m=function(t,e){for(var n=0;n<8;n++)t[n]^=e[n]},g=function(t,e){var n=(65535&t)+(65535&e);return(t>>16)+(e>>16)+(n>>16)<<16|65535&n},w=function(t,e){return t<<e&4294967295|t>>>32-e&4294967295},b=function(t){return a(function(t,e){function n(t,e,n,r){return t<20?e&n|~e&r:t<40?e^n^r:t<60?e&n|e&r|n&r:e^n^r}function r(t){return t<20?1518500249:t<40?1859775393:t<60?-1894007588:-899497514}t[e>>5]|=128<<24-e%32,t[15+(e+64>>9<<4)]=e;for(var i=Array(80),o=1732584193,a=-271733879,s=-1732584194,u=271733878,c=-1009589776,h=0;h<t.length;h+=16){for(var f=o,l=a,p=s,d=u,v=c,y=0;y<80;y++){i[y]=y<16?t[h+y]:w(i[y-3]^i[y-8]^i[y-14]^i[y-16],1);var m=g(g(w(o,5),n(y,a,s,u)),g(g(c,i[y]),r(y)));c=u,u=s,s=w(a,30),a=o,o=m}o=g(o,f),a=g(a,l),s=g(s,p),u=g(u,d),c=g(c,v)}return[o,a,s,u,c]}(o(t,{ibits:8,obits:32,obigendian:!0}),8*t.length),{ibits:32,ibigendian:!0})},E=function(t){return a(function(t,e){function n(t,e,n,r,i,o){return g(w(g(g(e,t),g(r,o)),i),n)}function r(t,e,r,i,o,a,s){return n(e&r|~e&i,t,e,o,a,s)}function i(t,e,r,i,o,a,s){return n(e&i|r&~i,t,e,o,a,s)}function o(t,e,r,i,o,a,s){return n(e^r^i,t,e,o,a,s)}function a(t,e,r,i,o,a,s){return n(r^(e|~i),t,e,o,a,s)}t[e>>5]|=128<<e%32,t[14+(e+64>>>9<<4)]=e;for(var s=1732584193,u=-271733879,c=-1732584194,h=271733878,f=0;f<t.length;f+=16){var l=s,p=u,d=c,v=h;s=r(s,u,c,h,t[f+0],7,-680876936),h=r(h,s,u,c,t[f+1],12,-389564586),c=r(c,h,s,u,t[f+2],17,606105819),u=r(u,c,h,s,t[f+3],22,-1044525330),s=r(s,u,c,h,t[f+4],7,-176418897),h=r(h,s,u,c,t[f+5],12,1200080426),c=r(c,h,s,u,t[f+6],17,-1473231341),u=r(u,c,h,s,t[f+7],22,-45705983),s=r(s,u,c,h,t[f+8],7,1770035416),h=r(h,s,u,c,t[f+9],12,-1958414417),c=r(c,h,s,u,t[f+10],17,-42063),u=r(u,c,h,s,t[f+11],22,-1990404162),s=r(s,u,c,h,t[f+12],7,1804603682),h=r(h,s,u,c,t[f+13],12,-40341101),c=r(c,h,s,u,t[f+14],17,-1502002290),s=i(s,u=r(u,c,h,s,t[f+15],22,1236535329),c,h,t[f+1],5,-165796510),h=i(h,s,u,c,t[f+6],9,-1069501632),c=i(c,h,s,u,t[f+11],14,643717713),u=i(u,c,h,s,t[f+0],20,-373897302),s=i(s,u,c,h,t[f+5],5,-701558691),h=i(h,s,u,c,t[f+10],9,38016083),c=i(c,h,s,u,t[f+15],14,-660478335),u=i(u,c,h,s,t[f+4],20,-405537848),s=i(s,u,c,h,t[f+9],5,568446438),h=i(h,s,u,c,t[f+14],9,-1019803690),c=i(c,h,s,u,t[f+3],14,-187363961),u=i(u,c,h,s,t[f+8],20,1163531501),s=i(s,u,c,h,t[f+13],5,-1444681467),h=i(h,s,u,c,t[f+2],9,-51403784),c=i(c,h,s,u,t[f+7],14,1735328473),s=o(s,u=i(u,c,h,s,t[f+12],20,-1926607734),c,h,t[f+5],4,-378558),h=o(h,s,u,c,t[f+8],11,-2022574463),c=o(c,h,s,u,t[f+11],16,1839030562),u=o(u,c,h,s,t[f+14],23,-35309556),s=o(s,u,c,h,t[f+1],4,-1530992060),h=o(h,s,u,c,t[f+4],11,1272893353),c=o(c,h,s,u,t[f+7],16,-155497632),u=o(u,c,h,s,t[f+10],23,-1094730640),s=o(s,u,c,h,t[f+13],4,681279174),h=o(h,s,u,c,t[f+0],11,-358537222),c=o(c,h,s,u,t[f+3],16,-722521979),u=o(u,c,h,s,t[f+6],23,76029189),s=o(s,u,c,h,t[f+9],4,-640364487),h=o(h,s,u,c,t[f+12],11,-421815835),c=o(c,h,s,u,t[f+15],16,530742520),s=a(s,u=o(u,c,h,s,t[f+2],23,-995338651),c,h,t[f+0],6,-198630844),h=a(h,s,u,c,t[f+7],10,1126891415),c=a(c,h,s,u,t[f+14],15,-1416354905),u=a(u,c,h,s,t[f+5],21,-57434055),s=a(s,u,c,h,t[f+12],6,1700485571),h=a(h,s,u,c,t[f+3],10,-1894986606),c=a(c,h,s,u,t[f+10],15,-1051523),u=a(u,c,h,s,t[f+1],21,-2054922799),s=a(s,u,c,h,t[f+8],6,1873313359),h=a(h,s,u,c,t[f+15],10,-30611744),c=a(c,h,s,u,t[f+6],15,-1560198380),u=a(u,c,h,s,t[f+13],21,1309151649),s=a(s,u,c,h,t[f+4],6,-145523070),h=a(h,s,u,c,t[f+11],10,-1120210379),c=a(c,h,s,u,t[f+2],15,718787259),u=a(u,c,h,s,t[f+9],21,-343485551),s=g(s,l),u=g(u,p),c=g(c,d),h=g(h,v)}return[s,u,c,h]}(o(t,{ibits:8,obits:32,obigendian:!1}),8*t.length),{ibits:32,ibigendian:!1})},_=function(t){this.mul=s(88,81,244,45,76,149,127,45),this.inc=s(20,5,123,126,247,103,129,79),this.mask=s(0,0,0,0,255,255,255,255),this.state=c(this.inc),this.next(),d(this.state,this.mask),t=h(void 0!==t?t>>>0:4294967295*Math.random()>>>0),function(t,e){for(var n=0;n<8;n++)t[n]|=e[n]}(this.state,t),this.next()};_.prototype.next=function(){var t=c(this.state);!function(t,e){var n,r,i,o=new Array(16);for(n=0;n<16;n++)o[n]=0;for(n=0;n<8;n++){for(i=0,r=0;r<8;r++)i+=t[n]*e[r]+o[n+r],o[n+r]=i%256,i/=256;for(;r<16-n;r++)i+=o[n+r],o[n+r]=i%256,i/=256}for(n=0;n<8;n++)t[n]=o[n];o.slice(8,8)}(this.state,this.mul),l(this.state,this.inc);var e=c(t);y(e,18),m(e,t),y(e,27);var n=c(t);y(n,59),d(e,this.mask);var r=f(n),i=c(e);return function(t,e){if(e>64)throw new Error("ui64_rol: invalid number of bits to shift");var n,r=new Array(16);for(n=0;n<8;n++)r[n+8]=0,r[n]=t[n];var i=Math.floor(e/8),o=e%8;for(n=7-i;n>0;n--)r[n+i]=255&(r[n]<<o|r[n-1]>>>8-o);for(r[0+i]=r[0]<<o&255,n=0+i-1;n>=0;n--)r[n]=0;for(n=0;n<8;n++)t[n]=r[n];r.slice(8,8)}(i,32-r),y(e,r),m(e,i),f(e)};var A=new _,x=function(t,e){for(var n=[],r=0;r<t;r++)n[r]=A.next()%e;return n},k=0,T=0,S=function(){if(1===arguments.length&&"string"==typeof arguments[0])this.parse.apply(this,arguments);else if(arguments.length>=1&&"number"==typeof arguments[0])this.make.apply(this,arguments);else{if(arguments.length>=1)throw new Error("UUID: constructor: invalid arguments");for(var t=0;t<16;t++)this[t]=0}};return(S.prototype="undefined"!=typeof Uint8Array?new Uint8Array(16):r?new r(16):new Array(16)).constructor=S,S.prototype.make=function(t){var e,n=this;if(1===t){var r=new Date,i=r.getTime();i!==k?T=0:T++,k=i;var o,a=h(i);p(a,1e4),l(a,s(1,178,29,210,19,129,64,0)),T>0&&l(a,h(T)),o=v(a,8),n[3]=255&o,o=v(a,8),n[2]=255&o,o=v(a,8),n[1]=255&o,o=v(a,8),n[0]=255&o,o=v(a,8),n[5]=255&o,o=v(a,8),n[4]=255&o,o=v(a,8),n[7]=255&o,o=v(a,8),n[6]=15&o;var u=x(2,255);n[8]=u[0],n[9]=u[1];var c=x(6,255);for(c[0]|=1,c[0]|=2,e=0;e<6;e++)n[10+e]=c[e]}else if(4===t){var f=x(16,255);for(e=0;e<16;e++)this[e]=f[e]}else{if(3!==t&&5!==t)throw new Error("UUID: make: invalid version");var d="",y="object"==typeof arguments[1]&&arguments[1]instanceof S?arguments[1]:(new S).parse(arguments[1]);for(e=0;e<16;e++)d+=String.fromCharCode(y[e]);d+=arguments[2];var m=3===t?E(d):b(d);for(e=0;e<16;e++)n[e]=m.charCodeAt(e)}return n[6]&=15,n[6]|=t<<4,n[8]&=63,n[8]|=128,n},S.prototype.format=function(e){var r,i;return"z85"===e?r=function(t,e){if(e%4!=0)throw new Error("z85_encode: invalid input length (multiple of 4 expected)");for(var r="",i=0,o=0;i<e;)if(o=256*o+t[i++],i%4==0){for(var a=52200625;a>=1;){var s=Math.floor(o/a)%85;r+=n[s],a/=85}o=0}return r}(this,16):"b16"===e?(i=Array(32),t(this,0,15,!0,i,0),r=i.join("")):void 0!==e&&"std"!==e||(i=new Array(36),t(this,0,3,!1,i,0),i[8]="-",t(this,4,5,!1,i,9),i[13]="-",t(this,6,7,!1,i,14),i[18]="-",t(this,8,9,!1,i,19),i[23]="-",t(this,10,15,!1,i,24),r=i.join("")),r},S.prototype.toString=function(t){return this.format(t)},S.prototype.parse=function(t,n){if("string"!=typeof t)throw new Error("UUID: parse: invalid argument (type string expected)");if("z85"===n)!function(t,e){var n=t.length;if(n%5!=0)throw new Error("z85_decode: invalid input length (multiple of 5 expected)");void 0===e&&(e=new Array(4*n/5));for(var r=0,o=0,a=0;r<n;){var s=t.charCodeAt(r++)-32;if(s<0||s>=i.length)break;if(a=85*a+i[s],r%5==0){for(var u=16777216;u>=1;)e[o++]=Math.trunc(a/u%256),u/=256;a=0}}}(t,this);else if("b16"===n)e(t,0,35,this,0);else if(void 0===n||"std"===n){var r={nil:"00000000-0000-0000-0000-000000000000","ns:DNS":"6ba7b810-9dad-11d1-80b4-00c04fd430c8","ns:URL":"6ba7b811-9dad-11d1-80b4-00c04fd430c8","ns:OID":"6ba7b812-9dad-11d1-80b4-00c04fd430c8","ns:X500":"6ba7b814-9dad-11d1-80b4-00c04fd430c8"};if(void 0!==r[t])t=r[t];else if(!t.match(/^[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}$/))throw new Error('UUID: parse: invalid string representation (expected "xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx")');e(t,0,7,this,0),e(t,9,12,this,4),e(t,14,17,this,6),e(t,19,22,this,8),e(t,24,35,this,10)}return this},S.prototype.export=function(){for(var t=Array(16),e=0;e<16;e++)t[e]=this[e];return t},S.prototype.import=function(t){if(!("object"==typeof t&&t instanceof Array))throw new Error("UUID: import: invalid argument (type Array expected)");if(16!==t.length)throw new Error("UUID: import: invalid argument (Array of length 16 expected)");for(var e=0;e<16;e++){if("number"!=typeof t[e])throw new Error("UUID: import: invalid array element #"+e+" (type Number expected)");if(!isFinite(t[e])||Math.floor(t[e])!==t[e])throw new Error("UUID: import: invalid array element #"+e+" (Number with integer value expected)");if(!(t[e]>=0&&t[e]<=255))throw new Error("UUID: import: invalid array element #"+e+" (Number with integer value in range 0...255 expected)");this[e]=t[e]}return this},S.prototype.compare=function(t){if("object"!=typeof t)throw new Error("UUID: compare: invalid argument (type UUID expected)");if(!(t instanceof S))throw new Error("UUID: compare: invalid argument (type UUID expected)");for(var e=0;e<16;e++){if(this[e]<t[e])return-1;if(this[e]>t[e])return 1}return 0},S.prototype.fold=function(t){if(void 0===t)throw new Error("UUID: fold: invalid argument (number of fold operations expected)");if(t<1||t>4)throw new Error("UUID: fold: invalid argument (1-4 fold operations expected)");for(var e=16/Math.pow(2,t),n=new Array(e),r=0;r<e;r++){for(var i=0,o=0;r+o<16;o+=e)i^=this[r+o];n[r]=i}return n},S.PCG=_,S}()}.call(e,n,e,t))||(t.exports=i)}).call(this,n(87).Buffer)},function(t,e,n){var r=n(5),i=n(83).set;t.exports=function(t,e,n){var o,a=e.constructor;return a!==n&&"function"==typeof a&&(o=a.prototype)!==n.prototype&&r(o)&&i&&i(t,o),t}},function(t,e,n){"use strict";var r=n(2),i=n(31)(5),o=!0;"find"in[]&&Array(1).find((function(){o=!1})),r(r.P+r.F*o,"Array",{find:function(t){return i(this,t,arguments.length>1?arguments[1]:void 0)}}),n(44)("find")},function(t,e){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(t){"object"==typeof window&&(n=window)}t.exports=n},function(t,e,n){"use strict";e.byteLength=function(t){var e=c(t),n=e[0],r=e[1];return 3*(n+r)/4-r},e.toByteArray=function(t){for(var e,n=c(t),r=n[0],a=n[1],s=new o(function(t,e,n){return 3*(e+n)/4-n}(0,r,a)),u=0,h=a>0?r-4:r,f=0;f<h;f+=4)e=i[t.charCodeAt(f)]<<18|i[t.charCodeAt(f+1)]<<12|i[t.charCodeAt(f+2)]<<6|i[t.charCodeAt(f+3)],s[u++]=e>>16&255,s[u++]=e>>8&255,s[u++]=255&e;2===a&&(e=i[t.charCodeAt(f)]<<2|i[t.charCodeAt(f+1)]>>4,s[u++]=255&e);1===a&&(e=i[t.charCodeAt(f)]<<10|i[t.charCodeAt(f+1)]<<4|i[t.charCodeAt(f+2)]>>2,s[u++]=e>>8&255,s[u++]=255&e);return s},e.fromByteArray=function(t){for(var e,n=t.length,i=n%3,o=[],a=0,s=n-i;a<s;a+=16383)o.push(h(t,a,a+16383>s?s:a+16383));1===i?(e=t[n-1],o.push(r[e>>2]+r[e<<4&63]+"==")):2===i&&(e=(t[n-2]<<8)+t[n-1],o.push(r[e>>10]+r[e>>4&63]+r[e<<2&63]+"="));return o.join("")};for(var r=[],i=[],o="undefined"!=typeof Uint8Array?Uint8Array:Array,a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",s=0,u=a.length;s<u;++s)r[s]=a[s],i[a.charCodeAt(s)]=s;function c(t){var e=t.length;if(e%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var n=t.indexOf("=");return-1===n&&(n=e),[n,n===e?0:4-n%4]}function h(t,e,n){for(var i,o,a=[],s=e;s<n;s+=3)i=(t[s]<<16&16711680)+(t[s+1]<<8&65280)+(255&t[s+2]),a.push(r[(o=i)>>18&63]+r[o>>12&63]+r[o>>6&63]+r[63&o]);return a.join("")}i["-".charCodeAt(0)]=62,i["_".charCodeAt(0)]=63},function(t,e){e.read=function(t,e,n,r,i){var o,a,s=8*i-r-1,u=(1<<s)-1,c=u>>1,h=-7,f=n?i-1:0,l=n?-1:1,p=t[e+f];for(f+=l,o=p&(1<<-h)-1,p>>=-h,h+=s;h>0;o=256*o+t[e+f],f+=l,h-=8);for(a=o&(1<<-h)-1,o>>=-h,h+=r;h>0;a=256*a+t[e+f],f+=l,h-=8);if(0===o)o=1-c;else{if(o===u)return a?NaN:1/0*(p?-1:1);a+=Math.pow(2,r),o-=c}return(p?-1:1)*a*Math.pow(2,o-r)},e.write=function(t,e,n,r,i,o){var a,s,u,c=8*o-i-1,h=(1<<c)-1,f=h>>1,l=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,p=r?0:o-1,d=r?1:-1,v=e<0||0===e&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(s=isNaN(e)?1:0,a=h):(a=Math.floor(Math.log(e)/Math.LN2),e*(u=Math.pow(2,-a))<1&&(a--,u*=2),(e+=a+f>=1?l/u:l*Math.pow(2,1-f))*u>=2&&(a++,u/=2),a+f>=h?(s=0,a=h):a+f>=1?(s=(e*u-1)*Math.pow(2,i),a+=f):(s=e*Math.pow(2,f-1)*Math.pow(2,i),a=0));i>=8;t[n+p]=255&s,p+=d,s/=256,i-=8);for(a=a<<i|s,c+=i;c>0;t[n+p]=255&a,p+=d,a/=256,c-=8);t[n+p-d]|=128*v}},function(t,e){var n={}.toString;t.exports=Array.isArray||function(t){return"[object Array]"==n.call(t)}},function(t,e,n){"use strict";var r=n(22),i=n(51),o=n(17);t.exports=[].copyWithin||function(t,e){var n=r(this),a=o(n.length),s=i(t,a),u=i(e,a),c=arguments.length>2?arguments[2]:void 0,h=Math.min((void 0===c?a:i(c,a))-u,a-s),f=1;for(u<s&&s<u+h&&(f=-1,u+=h-1,s+=h-1);h-- >0;)u in n?n[s]=n[u]:delete n[s],s+=f,u+=f;return n}},function(t,e,n){(function(e){var r=n(119).UINT32;r.prototype.xxh_update=function(t,e){var n,r,a=o._low,s=o._high;n=(r=t*a)>>>16,n+=e*a,n&=65535,n+=t*s;var u=this._low+(65535&r),c=u>>>16,h=(c+=this._high+(65535&n))<<16|65535&u;c=(h=h<<13|h>>>19)>>>16,n=(r=(u=65535&h)*(a=i._low))>>>16,n+=c*a,n&=65535,n+=u*(s=i._high),this._low=65535&r,this._high=65535&n};var i=r("2654435761"),o=r("2246822519"),a=r("3266489917"),s=r("668265263"),u=r("374761393");function c(){return 2==arguments.length?new c(arguments[1]).update(arguments[0]).digest():this instanceof c?void h.call(this,arguments[0]):new c(arguments[0])}function h(t){return this.seed=t instanceof r?t.clone():r(t),this.v1=this.seed.clone().add(i).add(o),this.v2=this.seed.clone().add(o),this.v3=this.seed.clone(),this.v4=this.seed.clone().subtract(i),this.total_len=0,this.memsize=0,this.memory=null,this}c.prototype.init=h,c.prototype.update=function(t){var n,r="string"==typeof t;r&&(t=function(t){for(var e=[],n=0,r=t.length;n<r;n++){var i=t.charCodeAt(n);i<128?e.push(i):i<2048?e.push(192|i>>6,128|63&i):i<55296||i>=57344?e.push(224|i>>12,128|i>>6&63,128|63&i):(n++,i=65536+((1023&i)<<10|1023&t.charCodeAt(n)),e.push(240|i>>18,128|i>>12&63,128|i>>6&63,128|63&i))}return new Uint8Array(e)}(t),r=!1,n=!0),"undefined"!=typeof ArrayBuffer&&t instanceof ArrayBuffer&&(n=!0,t=new Uint8Array(t));var i=0,o=t.length,a=i+o;if(0==o)return this;if(this.total_len+=o,0==this.memsize&&(this.memory=r?"":n?new Uint8Array(16):new e(16)),this.memsize+o<16)return r?this.memory+=t:n?this.memory.set(t.subarray(0,o),this.memsize):t.copy(this.memory,this.memsize,0,o),this.memsize+=o,this;if(this.memsize>0){r?this.memory+=t.slice(0,16-this.memsize):n?this.memory.set(t.subarray(0,16-this.memsize),this.memsize):t.copy(this.memory,this.memsize,0,16-this.memsize);var s=0;r?(this.v1.xxh_update(this.memory.charCodeAt(s+1)<<8|this.memory.charCodeAt(s),this.memory.charCodeAt(s+3)<<8|this.memory.charCodeAt(s+2)),s+=4,this.v2.xxh_update(this.memory.charCodeAt(s+1)<<8|this.memory.charCodeAt(s),this.memory.charCodeAt(s+3)<<8|this.memory.charCodeAt(s+2)),s+=4,this.v3.xxh_update(this.memory.charCodeAt(s+1)<<8|this.memory.charCodeAt(s),this.memory.charCodeAt(s+3)<<8|this.memory.charCodeAt(s+2)),s+=4,this.v4.xxh_update(this.memory.charCodeAt(s+1)<<8|this.memory.charCodeAt(s),this.memory.charCodeAt(s+3)<<8|this.memory.charCodeAt(s+2))):(this.v1.xxh_update(this.memory[s+1]<<8|this.memory[s],this.memory[s+3]<<8|this.memory[s+2]),s+=4,this.v2.xxh_update(this.memory[s+1]<<8|this.memory[s],this.memory[s+3]<<8|this.memory[s+2]),s+=4,this.v3.xxh_update(this.memory[s+1]<<8|this.memory[s],this.memory[s+3]<<8|this.memory[s+2]),s+=4,this.v4.xxh_update(this.memory[s+1]<<8|this.memory[s],this.memory[s+3]<<8|this.memory[s+2])),i+=16-this.memsize,this.memsize=0,r&&(this.memory="")}if(i<=a-16){var u=a-16;do{r?(this.v1.xxh_update(t.charCodeAt(i+1)<<8|t.charCodeAt(i),t.charCodeAt(i+3)<<8|t.charCodeAt(i+2)),i+=4,this.v2.xxh_update(t.charCodeAt(i+1)<<8|t.charCodeAt(i),t.charCodeAt(i+3)<<8|t.charCodeAt(i+2)),i+=4,this.v3.xxh_update(t.charCodeAt(i+1)<<8|t.charCodeAt(i),t.charCodeAt(i+3)<<8|t.charCodeAt(i+2)),i+=4,this.v4.xxh_update(t.charCodeAt(i+1)<<8|t.charCodeAt(i),t.charCodeAt(i+3)<<8|t.charCodeAt(i+2))):(this.v1.xxh_update(t[i+1]<<8|t[i],t[i+3]<<8|t[i+2]),i+=4,this.v2.xxh_update(t[i+1]<<8|t[i],t[i+3]<<8|t[i+2]),i+=4,this.v3.xxh_update(t[i+1]<<8|t[i],t[i+3]<<8|t[i+2]),i+=4,this.v4.xxh_update(t[i+1]<<8|t[i],t[i+3]<<8|t[i+2])),i+=4}while(i<=u)}return i<a&&(r?this.memory+=t.slice(i):n?this.memory.set(t.subarray(i,a),this.memsize):t.copy(this.memory,this.memsize,i,a),this.memsize=a-i),this},c.prototype.digest=function(){var t,e,n=this.memory,c="string"==typeof n,h=0,f=this.memsize,l=new r;for((t=this.total_len>=16?this.v1.rotl(1).add(this.v2.rotl(7).add(this.v3.rotl(12).add(this.v4.rotl(18)))):this.seed.clone().add(u)).add(l.fromNumber(this.total_len));h<=f-4;)c?l.fromBits(n.charCodeAt(h+1)<<8|n.charCodeAt(h),n.charCodeAt(h+3)<<8|n.charCodeAt(h+2)):l.fromBits(n[h+1]<<8|n[h],n[h+3]<<8|n[h+2]),t.add(l.multiply(a)).rotl(17).multiply(s),h+=4;for(;h<f;)l.fromBits(c?n.charCodeAt(h++):n[h++],0),t.add(l.multiply(u)).rotl(11).multiply(i);return e=t.clone().shiftRight(15),t.xor(e).multiply(o),e=t.clone().shiftRight(13),t.xor(e).multiply(a),e=t.clone().shiftRight(16),t.xor(e),this.init(this.seed),t},t.exports=c}).call(this,n(87).Buffer)},function(t,e,n){var r;!function(n){i(Math.pow(36,5)),i(Math.pow(16,7)),i(Math.pow(10,9)),i(Math.pow(2,30)),i(36),i(16),i(10),i(2);function i(t,e){return this instanceof i?(this._low=0,this._high=0,this.remainder=null,void 0===e?a.call(this,t):"string"==typeof t?s.call(this,t,e):void o.call(this,t,e)):new i(t,e)}function o(t,e){return this._low=0|t,this._high=0|e,this}function a(t){return this._low=65535&t,this._high=t>>>16,this}function s(t,e){var n=parseInt(t,e||10);return this._low=65535&n,this._high=n>>>16,this}i.prototype.fromBits=o,i.prototype.fromNumber=a,i.prototype.fromString=s,i.prototype.toNumber=function(){return 65536*this._high+this._low},i.prototype.toString=function(t){return this.toNumber().toString(t||10)},i.prototype.add=function(t){var e=this._low+t._low,n=e>>>16;return n+=this._high+t._high,this._low=65535&e,this._high=65535&n,this},i.prototype.subtract=function(t){return this.add(t.clone().negate())},i.prototype.multiply=function(t){var e,n,r=this._high,i=this._low,o=t._high,a=t._low;return e=(n=i*a)>>>16,e+=r*a,e&=65535,e+=i*o,this._low=65535&n,this._high=65535&e,this},i.prototype.div=function(t){if(0==t._low&&0==t._high)throw Error("division by zero");if(0==t._high&&1==t._low)return this.remainder=new i(0),this;if(t.gt(this))return this.remainder=this.clone(),this._low=0,this._high=0,this;if(this.eq(t))return this.remainder=new i(0),this._low=1,this._high=0,this;for(var e=t.clone(),n=-1;!this.lt(e);)e.shiftLeft(1,!0),n++;for(this.remainder=this.clone(),this._low=0,this._high=0;n>=0;n--)e.shiftRight(1),this.remainder.lt(e)||(this.remainder.subtract(e),n>=16?this._high|=1<<n-16:this._low|=1<<n);return this},i.prototype.negate=function(){var t=1+(65535&~this._low);return this._low=65535&t,this._high=~this._high+(t>>>16)&65535,this},i.prototype.equals=i.prototype.eq=function(t){return this._low==t._low&&this._high==t._high},i.prototype.greaterThan=i.prototype.gt=function(t){return this._high>t._high||!(this._high<t._high)&&this._low>t._low},i.prototype.lessThan=i.prototype.lt=function(t){return this._high<t._high||!(this._high>t._high)&&this._low<t._low},i.prototype.or=function(t){return this._low|=t._low,this._high|=t._high,this},i.prototype.and=function(t){return this._low&=t._low,this._high&=t._high,this},i.prototype.not=function(){return this._low=65535&~this._low,this._high=65535&~this._high,this},i.prototype.xor=function(t){return this._low^=t._low,this._high^=t._high,this},i.prototype.shiftRight=i.prototype.shiftr=function(t){return t>16?(this._low=this._high>>t-16,this._high=0):16==t?(this._low=this._high,this._high=0):(this._low=this._low>>t|this._high<<16-t&65535,this._high>>=t),this},i.prototype.shiftLeft=i.prototype.shiftl=function(t,e){return t>16?(this._high=this._low<<t-16,this._low=0,e||(this._high&=65535)):16==t?(this._high=this._low,this._low=0):(this._high=this._high<<t|this._low>>16-t,this._low=this._low<<t&65535,e||(this._high&=65535)),this},i.prototype.rotateLeft=i.prototype.rotl=function(t){var e=this._high<<16|this._low;return e=e<<t|e>>>32-t,this._low=65535&e,this._high=e>>>16,this},i.prototype.rotateRight=i.prototype.rotr=function(t){var e=this._high<<16|this._low;return e=e>>>t|e<<32-t,this._low=65535&e,this._high=e>>>16,this},i.prototype.clone=function(){return new i(this._low,this._high)},void 0===(r=function(){return i}.apply(e,[]))||(t.exports=r)}()},function(t,e,n){var r;!function(n){var i={16:a(Math.pow(16,5)),10:a(Math.pow(10,5)),2:a(Math.pow(2,5))},o={16:a(16),10:a(10),2:a(2)};function a(t,e,n,r){return this instanceof a?(this.remainder=null,"string"==typeof t?c.call(this,t,e):void 0===e?u.call(this,t):void s.apply(this,arguments)):new a(t,e,n,r)}function s(t,e,n,r){return void 0===n?(this._a00=65535&t,this._a16=t>>>16,this._a32=65535&e,this._a48=e>>>16,this):(this._a00=0|t,this._a16=0|e,this._a32=0|n,this._a48=0|r,this)}function u(t){return this._a00=65535&t,this._a16=t>>>16,this._a32=0,this._a48=0,this}function c(t,e){e=e||10,this._a00=0,this._a16=0,this._a32=0,this._a48=0;for(var n=i[e]||new a(Math.pow(e,5)),r=0,o=t.length;r<o;r+=5){var s=Math.min(5,o-r),u=parseInt(t.slice(r,r+s),e);this.multiply(s<5?new a(Math.pow(e,s)):n).add(new a(u))}return this}a.prototype.fromBits=s,a.prototype.fromNumber=u,a.prototype.fromString=c,a.prototype.toNumber=function(){return 65536*this._a16+this._a00},a.prototype.toString=function(t){var e=o[t=t||10]||new a(t);if(!this.gt(e))return this.toNumber().toString(t);for(var n=this.clone(),r=new Array(64),i=63;i>=0&&(n.div(e),r[i]=n.remainder.toNumber().toString(t),n.gt(e));i--);return r[i-1]=n.toNumber().toString(t),r.join("")},a.prototype.add=function(t){var e=this._a00+t._a00,n=e>>>16,r=(n+=this._a16+t._a16)>>>16,i=(r+=this._a32+t._a32)>>>16;return i+=this._a48+t._a48,this._a00=65535&e,this._a16=65535&n,this._a32=65535&r,this._a48=65535&i,this},a.prototype.subtract=function(t){return this.add(t.clone().negate())},a.prototype.multiply=function(t){var e=this._a00,n=this._a16,r=this._a32,i=this._a48,o=t._a00,a=t._a16,s=t._a32,u=e*o,c=u>>>16,h=(c+=e*a)>>>16;c&=65535,h+=(c+=n*o)>>>16;var f=(h+=e*s)>>>16;return h&=65535,f+=(h+=n*a)>>>16,h&=65535,f+=(h+=r*o)>>>16,f+=e*t._a48,f&=65535,f+=n*s,f&=65535,f+=r*a,f&=65535,f+=i*o,this._a00=65535&u,this._a16=65535&c,this._a32=65535&h,this._a48=65535&f,this},a.prototype.div=function(t){if(0==t._a16&&0==t._a32&&0==t._a48){if(0==t._a00)throw Error("division by zero");if(1==t._a00)return this.remainder=new a(0),this}if(t.gt(this))return this.remainder=this.clone(),this._a00=0,this._a16=0,this._a32=0,this._a48=0,this;if(this.eq(t))return this.remainder=new a(0),this._a00=1,this._a16=0,this._a32=0,this._a48=0,this;for(var e=t.clone(),n=-1;!this.lt(e);)e.shiftLeft(1,!0),n++;for(this.remainder=this.clone(),this._a00=0,this._a16=0,this._a32=0,this._a48=0;n>=0;n--)e.shiftRight(1),this.remainder.lt(e)||(this.remainder.subtract(e),n>=48?this._a48|=1<<n-48:n>=32?this._a32|=1<<n-32:n>=16?this._a16|=1<<n-16:this._a00|=1<<n);return this},a.prototype.negate=function(){var t=1+(65535&~this._a00);return this._a00=65535&t,t=(65535&~this._a16)+(t>>>16),this._a16=65535&t,t=(65535&~this._a32)+(t>>>16),this._a32=65535&t,this._a48=~this._a48+(t>>>16)&65535,this},a.prototype.equals=a.prototype.eq=function(t){return this._a48==t._a48&&this._a00==t._a00&&this._a32==t._a32&&this._a16==t._a16},a.prototype.greaterThan=a.prototype.gt=function(t){return this._a48>t._a48||!(this._a48<t._a48)&&(this._a32>t._a32||!(this._a32<t._a32)&&(this._a16>t._a16||!(this._a16<t._a16)&&this._a00>t._a00))},a.prototype.lessThan=a.prototype.lt=function(t){return this._a48<t._a48||!(this._a48>t._a48)&&(this._a32<t._a32||!(this._a32>t._a32)&&(this._a16<t._a16||!(this._a16>t._a16)&&this._a00<t._a00))},a.prototype.or=function(t){return this._a00|=t._a00,this._a16|=t._a16,this._a32|=t._a32,this._a48|=t._a48,this},a.prototype.and=function(t){return this._a00&=t._a00,this._a16&=t._a16,this._a32&=t._a32,this._a48&=t._a48,this},a.prototype.xor=function(t){return this._a00^=t._a00,this._a16^=t._a16,this._a32^=t._a32,this._a48^=t._a48,this},a.prototype.not=function(){return this._a00=65535&~this._a00,this._a16=65535&~this._a16,this._a32=65535&~this._a32,this._a48=65535&~this._a48,this},a.prototype.shiftRight=a.prototype.shiftr=function(t){return(t%=64)>=48?(this._a00=this._a48>>t-48,this._a16=0,this._a32=0,this._a48=0):t>=32?(t-=32,this._a00=65535&(this._a32>>t|this._a48<<16-t),this._a16=this._a48>>t&65535,this._a32=0,this._a48=0):t>=16?(t-=16,this._a00=65535&(this._a16>>t|this._a32<<16-t),this._a16=65535&(this._a32>>t|this._a48<<16-t),this._a32=this._a48>>t&65535,this._a48=0):(this._a00=65535&(this._a00>>t|this._a16<<16-t),this._a16=65535&(this._a16>>t|this._a32<<16-t),this._a32=65535&(this._a32>>t|this._a48<<16-t),this._a48=this._a48>>t&65535),this},a.prototype.shiftLeft=a.prototype.shiftl=function(t,e){return(t%=64)>=48?(this._a48=this._a00<<t-48,this._a32=0,this._a16=0,this._a00=0):t>=32?(t-=32,this._a48=this._a16<<t|this._a00>>16-t,this._a32=this._a00<<t&65535,this._a16=0,this._a00=0):t>=16?(t-=16,this._a48=this._a32<<t|this._a16>>16-t,this._a32=65535&(this._a16<<t|this._a00>>16-t),this._a16=this._a00<<t&65535,this._a00=0):(this._a48=this._a48<<t|this._a32>>16-t,this._a32=65535&(this._a32<<t|this._a16>>16-t),this._a16=65535&(this._a16<<t|this._a00>>16-t),this._a00=this._a00<<t&65535),e||(this._a48&=65535),this},a.prototype.rotateLeft=a.prototype.rotl=function(t){if(0==(t%=64))return this;if(t>=32){var e=this._a00;if(this._a00=this._a32,this._a32=e,e=this._a48,this._a48=this._a16,this._a16=e,32==t)return this;t-=32}var n=this._a48<<16|this._a32,r=this._a16<<16|this._a00,i=n<<t|r>>>32-t,o=r<<t|n>>>32-t;return this._a00=65535&o,this._a16=o>>>16,this._a32=65535&i,this._a48=i>>>16,this},a.prototype.rotateRight=a.prototype.rotr=function(t){if(0==(t%=64))return this;if(t>=32){var e=this._a00;if(this._a00=this._a32,this._a32=e,e=this._a48,this._a48=this._a16,this._a16=e,32==t)return this;t-=32}var n=this._a48<<16|this._a32,r=this._a16<<16|this._a00,i=n>>>t|r<<32-t,o=r>>>t|n<<32-t;return this._a00=65535&o,this._a16=o>>>16,this._a32=65535&i,this._a48=i>>>16,this},a.prototype.clone=function(){return new a(this._a00,this._a16,this._a32,this._a48)},void 0===(r=function(){return a}.apply(e,[]))||(t.exports=r)}()},function(t,e,n){(function(e){var r=n(119).UINT64,i=r("11400714785074694791"),o=r("14029467366897019727"),a=r("1609587929392839161"),s=r("9650029242287828579"),u=r("2870177450012600261");function c(){return 2==arguments.length?new c(arguments[1]).update(arguments[0]).digest():this instanceof c?void h.call(this,arguments[0]):new c(arguments[0])}function h(t){return this.seed=t instanceof r?t.clone():r(t),this.v1=this.seed.clone().add(i).add(o),this.v2=this.seed.clone().add(o),this.v3=this.seed.clone(),this.v4=this.seed.clone().subtract(i),this.total_len=0,this.memsize=0,this.memory=null,this}c.prototype.init=h,c.prototype.update=function(t){var n,a="string"==typeof t;a&&(t=function(t){for(var e=[],n=0,r=t.length;n<r;n++){var i=t.charCodeAt(n);i<128?e.push(i):i<2048?e.push(192|i>>6,128|63&i):i<55296||i>=57344?e.push(224|i>>12,128|i>>6&63,128|63&i):(n++,i=65536+((1023&i)<<10|1023&t.charCodeAt(n)),e.push(240|i>>18,128|i>>12&63,128|i>>6&63,128|63&i))}return new Uint8Array(e)}(t),a=!1,n=!0),"undefined"!=typeof ArrayBuffer&&t instanceof ArrayBuffer&&(n=!0,t=new Uint8Array(t));var s=0,u=t.length,c=s+u;if(0==u)return this;if(this.total_len+=u,0==this.memsize&&(this.memory=a?"":n?new Uint8Array(32):new e(32)),this.memsize+u<32)return a?this.memory+=t:n?this.memory.set(t.subarray(0,u),this.memsize):t.copy(this.memory,this.memsize,0,u),this.memsize+=u,this;if(this.memsize>0){a?this.memory+=t.slice(0,32-this.memsize):n?this.memory.set(t.subarray(0,32-this.memsize),this.memsize):t.copy(this.memory,this.memsize,0,32-this.memsize);var h=0;if(a)l=r(this.memory.charCodeAt(h+1)<<8|this.memory.charCodeAt(h),this.memory.charCodeAt(h+3)<<8|this.memory.charCodeAt(h+2),this.memory.charCodeAt(h+5)<<8|this.memory.charCodeAt(h+4),this.memory.charCodeAt(h+7)<<8|this.memory.charCodeAt(h+6)),this.v1.add(l.multiply(o)).rotl(31).multiply(i),h+=8,l=r(this.memory.charCodeAt(h+1)<<8|this.memory.charCodeAt(h),this.memory.charCodeAt(h+3)<<8|this.memory.charCodeAt(h+2),this.memory.charCodeAt(h+5)<<8|this.memory.charCodeAt(h+4),this.memory.charCodeAt(h+7)<<8|this.memory.charCodeAt(h+6)),this.v2.add(l.multiply(o)).rotl(31).multiply(i),h+=8,l=r(this.memory.charCodeAt(h+1)<<8|this.memory.charCodeAt(h),this.memory.charCodeAt(h+3)<<8|this.memory.charCodeAt(h+2),this.memory.charCodeAt(h+5)<<8|this.memory.charCodeAt(h+4),this.memory.charCodeAt(h+7)<<8|this.memory.charCodeAt(h+6)),this.v3.add(l.multiply(o)).rotl(31).multiply(i),h+=8,l=r(this.memory.charCodeAt(h+1)<<8|this.memory.charCodeAt(h),this.memory.charCodeAt(h+3)<<8|this.memory.charCodeAt(h+2),this.memory.charCodeAt(h+5)<<8|this.memory.charCodeAt(h+4),this.memory.charCodeAt(h+7)<<8|this.memory.charCodeAt(h+6)),this.v4.add(l.multiply(o)).rotl(31).multiply(i);else l=r(this.memory[h+1]<<8|this.memory[h],this.memory[h+3]<<8|this.memory[h+2],this.memory[h+5]<<8|this.memory[h+4],this.memory[h+7]<<8|this.memory[h+6]),this.v1.add(l.multiply(o)).rotl(31).multiply(i),h+=8,l=r(this.memory[h+1]<<8|this.memory[h],this.memory[h+3]<<8|this.memory[h+2],this.memory[h+5]<<8|this.memory[h+4],this.memory[h+7]<<8|this.memory[h+6]),this.v2.add(l.multiply(o)).rotl(31).multiply(i),h+=8,l=r(this.memory[h+1]<<8|this.memory[h],this.memory[h+3]<<8|this.memory[h+2],this.memory[h+5]<<8|this.memory[h+4],this.memory[h+7]<<8|this.memory[h+6]),this.v3.add(l.multiply(o)).rotl(31).multiply(i),h+=8,l=r(this.memory[h+1]<<8|this.memory[h],this.memory[h+3]<<8|this.memory[h+2],this.memory[h+5]<<8|this.memory[h+4],this.memory[h+7]<<8|this.memory[h+6]),this.v4.add(l.multiply(o)).rotl(31).multiply(i);s+=32-this.memsize,this.memsize=0,a&&(this.memory="")}if(s<=c-32){var f=c-32;do{var l;if(a)l=r(t.charCodeAt(s+1)<<8|t.charCodeAt(s),t.charCodeAt(s+3)<<8|t.charCodeAt(s+2),t.charCodeAt(s+5)<<8|t.charCodeAt(s+4),t.charCodeAt(s+7)<<8|t.charCodeAt(s+6)),this.v1.add(l.multiply(o)).rotl(31).multiply(i),s+=8,l=r(t.charCodeAt(s+1)<<8|t.charCodeAt(s),t.charCodeAt(s+3)<<8|t.charCodeAt(s+2),t.charCodeAt(s+5)<<8|t.charCodeAt(s+4),t.charCodeAt(s+7)<<8|t.charCodeAt(s+6)),this.v2.add(l.multiply(o)).rotl(31).multiply(i),s+=8,l=r(t.charCodeAt(s+1)<<8|t.charCodeAt(s),t.charCodeAt(s+3)<<8|t.charCodeAt(s+2),t.charCodeAt(s+5)<<8|t.charCodeAt(s+4),t.charCodeAt(s+7)<<8|t.charCodeAt(s+6)),this.v3.add(l.multiply(o)).rotl(31).multiply(i),s+=8,l=r(t.charCodeAt(s+1)<<8|t.charCodeAt(s),t.charCodeAt(s+3)<<8|t.charCodeAt(s+2),t.charCodeAt(s+5)<<8|t.charCodeAt(s+4),t.charCodeAt(s+7)<<8|t.charCodeAt(s+6)),this.v4.add(l.multiply(o)).rotl(31).multiply(i);else l=r(t[s+1]<<8|t[s],t[s+3]<<8|t[s+2],t[s+5]<<8|t[s+4],t[s+7]<<8|t[s+6]),this.v1.add(l.multiply(o)).rotl(31).multiply(i),l=r(t[(s+=8)+1]<<8|t[s],t[s+3]<<8|t[s+2],t[s+5]<<8|t[s+4],t[s+7]<<8|t[s+6]),this.v2.add(l.multiply(o)).rotl(31).multiply(i),l=r(t[(s+=8)+1]<<8|t[s],t[s+3]<<8|t[s+2],t[s+5]<<8|t[s+4],t[s+7]<<8|t[s+6]),this.v3.add(l.multiply(o)).rotl(31).multiply(i),l=r(t[(s+=8)+1]<<8|t[s],t[s+3]<<8|t[s+2],t[s+5]<<8|t[s+4],t[s+7]<<8|t[s+6]),this.v4.add(l.multiply(o)).rotl(31).multiply(i);s+=8}while(s<=f)}return s<c&&(a?this.memory+=t.slice(s):n?this.memory.set(t.subarray(s,c),this.memsize):t.copy(this.memory,this.memsize,s,c),this.memsize=c-s),this},c.prototype.digest=function(){var t,e,n=this.memory,c="string"==typeof n,h=0,f=this.memsize,l=new r;for(this.total_len>=32?((t=this.v1.clone().rotl(1)).add(this.v2.clone().rotl(7)),t.add(this.v3.clone().rotl(12)),t.add(this.v4.clone().rotl(18)),t.xor(this.v1.multiply(o).rotl(31).multiply(i)),t.multiply(i).add(s),t.xor(this.v2.multiply(o).rotl(31).multiply(i)),t.multiply(i).add(s),t.xor(this.v3.multiply(o).rotl(31).multiply(i)),t.multiply(i).add(s),t.xor(this.v4.multiply(o).rotl(31).multiply(i)),t.multiply(i).add(s)):t=this.seed.clone().add(u),t.add(l.fromNumber(this.total_len));h<=f-8;)c?l.fromBits(n.charCodeAt(h+1)<<8|n.charCodeAt(h),n.charCodeAt(h+3)<<8|n.charCodeAt(h+2),n.charCodeAt(h+5)<<8|n.charCodeAt(h+4),n.charCodeAt(h+7)<<8|n.charCodeAt(h+6)):l.fromBits(n[h+1]<<8|n[h],n[h+3]<<8|n[h+2],n[h+5]<<8|n[h+4],n[h+7]<<8|n[h+6]),l.multiply(o).rotl(31).multiply(i),t.xor(l).rotl(27).multiply(i).add(s),h+=8;for(h+4<=f&&(c?l.fromBits(n.charCodeAt(h+1)<<8|n.charCodeAt(h),n.charCodeAt(h+3)<<8|n.charCodeAt(h+2),0,0):l.fromBits(n[h+1]<<8|n[h],n[h+3]<<8|n[h+2],0,0),t.xor(l.multiply(i)).rotl(23).multiply(o).add(a),h+=4);h<f;)l.fromBits(c?n.charCodeAt(h++):n[h++],0,0,0),t.xor(l.multiply(u)).rotl(11).multiply(i);return e=t.clone().shiftRight(33),t.xor(e).multiply(o),e=t.clone().shiftRight(29),t.xor(e).multiply(a),e=t.clone().shiftRight(32),t.xor(e),this.init(this.seed),t},t.exports=c}).call(this,n(87).Buffer)},function(t,e,n){"use strict";var r=n(146),i=n(120);t.exports=n(147)("Map",(function(t){return function(){return t(this,arguments.length>0?arguments[0]:void 0)}}),{get:function(t){var e=r.getEntry(i(this,"Map"),t);return e&&e.v},set:function(t,e){return r.def(i(this,"Map"),0===t?0:t,e)}},r,!0)},function(t,e,n){"use strict";var r=n(6).f,i=n(33),o=n(42),a=n(13),s=n(41),u=n(63),c=n(58),h=n(82),f=n(64),l=n(7),p=n(65).fastKey,d=n(120),v=l?"_s":"size",y=function(t,e){var n,r=p(e);if("F"!==r)return t._i[r];for(n=t._f;n;n=n.n)if(n.k==e)return n};t.exports={getConstructor:function(t,e,n,c){var h=t((function(t,r){s(t,h,e,"_i"),t._t=e,t._i=i(null),t._f=void 0,t._l=void 0,t[v]=0,null!=r&&u(r,n,t[c],t)}));return o(h.prototype,{clear:function(){for(var t=d(this,e),n=t._i,r=t._f;r;r=r.n)r.r=!0,r.p&&(r.p=r.p.n=void 0),delete n[r.i];t._f=t._l=void 0,t[v]=0},delete:function(t){var n=d(this,e),r=y(n,t);if(r){var i=r.n,o=r.p;delete n._i[r.i],r.r=!0,o&&(o.n=i),i&&(i.p=o),n._f==r&&(n._f=i),n._l==r&&(n._l=o),n[v]--}return!!r},forEach:function(t){d(this,e);for(var n,r=a(t,arguments.length>1?arguments[1]:void 0,3);n=n?n.n:this._f;)for(r(n.v,n.k,this);n&&n.r;)n=n.p},has:function(t){return!!y(d(this,e),t)}}),l&&r(h.prototype,"size",{get:function(){return d(this,e)[v]}}),h},def:function(t,e,n){var r,i,o=y(t,e);return o?o.v=n:(t._l=o={i:i=p(e,!0),k:e,v:n,p:r=t._l,n:void 0,r:!1},t._f||(t._f=o),r&&(r.n=o),t[v]++,"F"!==i&&(t._i[i]=o)),t},getEntry:y,setStrong:function(t,e,n){c(t,e,(function(t,n){this._t=d(t,e),this._k=n,this._l=void 0}),(function(){for(var t=this._k,e=this._l;e&&e.r;)e=e.p;return this._t&&(this._l=e=e?e.n:this._t._f)?h(0,"keys"==t?e.k:"values"==t?e.v:[e.k,e.v]):(this._t=void 0,h(1))}),n?"entries":"values",!n,!0),f(e)}}},function(t,e,n){"use strict";var r=n(4),i=n(2),o=n(16),a=n(42),s=n(65),u=n(63),c=n(41),h=n(5),f=n(9),l=n(46),p=n(27),d=n(134);t.exports=function(t,e,n,v,y,m){var g=r[t],w=g,b=y?"set":"add",E=w&&w.prototype,_={},A=function(t){var e=E[t];o(E,t,"delete"==t?function(t){return!(m&&!h(t))&&e.call(this,0===t?0:t)}:"has"==t?function(t){return!(m&&!h(t))&&e.call(this,0===t?0:t)}:"get"==t?function(t){return m&&!h(t)?void 0:e.call(this,0===t?0:t)}:"add"==t?function(t){return e.call(this,0===t?0:t),this}:function(t,n){return e.call(this,0===t?0:t,n),this})};if("function"==typeof w&&(m||E.forEach&&!f((function(){(new w).entries().next()})))){var x=new w,k=x[b](m?{}:-0,1)!=x,T=f((function(){x.has(1)})),S=l((function(t){new w(t)})),C=!m&&f((function(){for(var t=new w,e=5;e--;)t[b](e,e);return!t.has(-0)}));S||((w=e((function(e,n){c(e,w,t);var r=d(new g,e,w);return null!=n&&u(n,y,r[b],r),r}))).prototype=E,E.constructor=w),(T||C)&&(A("delete"),A("has"),y&&A("get")),(C||k)&&A(b),m&&E.clear&&delete E.clear}else w=v.getConstructor(e,t,y,b),a(w.prototype,n),s.NEED=!0;return p(w,t),_[t]=w,i(i.G+i.W+i.F*(w!=g),_),m||v.setStrong(w,t,y),w}},function(t,e,n){"use strict";var r=n(2),i=n(31)(1);r(r.P+r.F*!n(36)([].map,!0),"Array",{map:function(t){return i(this,t,arguments[1])}})},function(t,e,n){"use strict";var r=n(2),i=n(31)(3);r(r.P+r.F*!n(36)([].some,!0),"Array",{some:function(t){return i(this,t,arguments[1])}})},,function(t,e,n){"use strict";var r,i,o=n(93),a=RegExp.prototype.exec,s=String.prototype.replace,u=a,c=(r=/a/,i=/b*/g,a.call(r,"a"),a.call(i,"a"),0!==r.lastIndex||0!==i.lastIndex),h=void 0!==/()??/.exec("")[1];(c||h)&&(u=function(t){var e,n,r,i,u=this;return h&&(n=new RegExp("^"+u.source+"$(?!\\s)",o.call(u))),c&&(e=u.lastIndex),r=a.call(u,t),c&&r&&(u.lastIndex=u.global?r.index+r[0].length:e),h&&r&&r.length>1&&s.call(r[0],n,(function(){for(i=1;i<arguments.length-2;i++)void 0===arguments[i]&&(r[i]=void 0)})),r}),t.exports=u},function(t,e,n){"use strict";var r,i="object"==typeof Reflect?Reflect:null,o=i&&"function"==typeof i.apply?i.apply:function(t,e,n){return Function.prototype.apply.call(t,e,n)};r=i&&"function"==typeof i.ownKeys?i.ownKeys:Object.getOwnPropertySymbols?function(t){return Object.getOwnPropertyNames(t).concat(Object.getOwnPropertySymbols(t))}:function(t){return Object.getOwnPropertyNames(t)};var a=Number.isNaN||function(t){return t!=t};function s(){s.init.call(this)}t.exports=s,s.EventEmitter=s,s.prototype._events=void 0,s.prototype._eventsCount=0,s.prototype._maxListeners=void 0;var u=10;function c(t){return void 0===t._maxListeners?s.defaultMaxListeners:t._maxListeners}function h(t,e,n,r){var i,o,a,s;if("function"!=typeof n)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof n);if(void 0===(o=t._events)?(o=t._events=Object.create(null),t._eventsCount=0):(void 0!==o.newListener&&(t.emit("newListener",e,n.listener?n.listener:n),o=t._events),a=o[e]),void 0===a)a=o[e]=n,++t._eventsCount;else if("function"==typeof a?a=o[e]=r?[n,a]:[a,n]:r?a.unshift(n):a.push(n),(i=c(t))>0&&a.length>i&&!a.warned){a.warned=!0;var u=new Error("Possible EventEmitter memory leak detected. "+a.length+" "+String(e)+" listeners added. Use emitter.setMaxListeners() to increase limit");u.name="MaxListenersExceededWarning",u.emitter=t,u.type=e,u.count=a.length,s=u,console&&console.warn&&console.warn(s)}return t}function f(){for(var t=[],e=0;e<arguments.length;e++)t.push(arguments[e]);this.fired||(this.target.removeListener(this.type,this.wrapFn),this.fired=!0,o(this.listener,this.target,t))}function l(t,e,n){var r={fired:!1,wrapFn:void 0,target:t,type:e,listener:n},i=f.bind(r);return i.listener=n,r.wrapFn=i,i}function p(t,e,n){var r=t._events;if(void 0===r)return[];var i=r[e];return void 0===i?[]:"function"==typeof i?n?[i.listener||i]:[i]:n?function(t){for(var e=new Array(t.length),n=0;n<e.length;++n)e[n]=t[n].listener||t[n];return e}(i):v(i,i.length)}function d(t){var e=this._events;if(void 0!==e){var n=e[t];if("function"==typeof n)return 1;if(void 0!==n)return n.length}return 0}function v(t,e){for(var n=new Array(e),r=0;r<e;++r)n[r]=t[r];return n}Object.defineProperty(s,"defaultMaxListeners",{enumerable:!0,get:function(){return u},set:function(t){if("number"!=typeof t||t<0||a(t))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+t+".");u=t}}),s.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},s.prototype.setMaxListeners=function(t){if("number"!=typeof t||t<0||a(t))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+t+".");return this._maxListeners=t,this},s.prototype.getMaxListeners=function(){return c(this)},s.prototype.emit=function(t){for(var e=[],n=1;n<arguments.length;n++)e.push(arguments[n]);var r="error"===t,i=this._events;if(void 0!==i)r=r&&void 0===i.error;else if(!r)return!1;if(r){var a;if(e.length>0&&(a=e[0]),a instanceof Error)throw a;var s=new Error("Unhandled error."+(a?" ("+a.message+")":""));throw s.context=a,s}var u=i[t];if(void 0===u)return!1;if("function"==typeof u)o(u,this,e);else{var c=u.length,h=v(u,c);for(n=0;n<c;++n)o(h[n],this,e)}return!0},s.prototype.addListener=function(t,e){return h(this,t,e,!1)},s.prototype.on=s.prototype.addListener,s.prototype.prependListener=function(t,e){return h(this,t,e,!0)},s.prototype.once=function(t,e){if("function"!=typeof e)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof e);return this.on(t,l(this,t,e)),this},s.prototype.prependOnceListener=function(t,e){if("function"!=typeof e)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof e);return this.prependListener(t,l(this,t,e)),this},s.prototype.removeListener=function(t,e){var n,r,i,o,a;if("function"!=typeof e)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof e);if(void 0===(r=this._events))return this;if(void 0===(n=r[t]))return this;if(n===e||n.listener===e)0==--this._eventsCount?this._events=Object.create(null):(delete r[t],r.removeListener&&this.emit("removeListener",t,n.listener||e));else if("function"!=typeof n){for(i=-1,o=n.length-1;o>=0;o--)if(n[o]===e||n[o].listener===e){a=n[o].listener,i=o;break}if(i<0)return this;0===i?n.shift():function(t,e){for(;e+1<t.length;e++)t[e]=t[e+1];t.pop()}(n,i),1===n.length&&(r[t]=n[0]),void 0!==r.removeListener&&this.emit("removeListener",t,a||e)}return this},s.prototype.off=s.prototype.removeListener,s.prototype.removeAllListeners=function(t){var e,n,r;if(void 0===(n=this._events))return this;if(void 0===n.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==n[t]&&(0==--this._eventsCount?this._events=Object.create(null):delete n[t]),this;if(0===arguments.length){var i,o=Object.keys(n);for(r=0;r<o.length;++r)"removeListener"!==(i=o[r])&&this.removeAllListeners(i);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(e=n[t]))this.removeListener(t,e);else if(void 0!==e)for(r=e.length-1;r>=0;r--)this.removeListener(t,e[r]);return this},s.prototype.listeners=function(t){return p(this,t,!0)},s.prototype.rawListeners=function(t){return p(this,t,!1)},s.listenerCount=function(t,e){return"function"==typeof t.listenerCount?t.listenerCount(e):d.call(t,e)},s.prototype.listenerCount=d,s.prototype.eventNames=function(){return this._eventsCount>0?r(this._events):[]}},function(t,e,n){var r;
/*! Hammer.JS - v2.0.7 - 2016-04-22
 * http://hammerjs.github.io/
 *
 * Copyright (c) 2016 Jorik Tangelder;
 * Licensed under the MIT license */!function(i,o,a,s){"use strict";var u,c=["","webkit","Moz","MS","ms","o"],h=o.createElement("div"),f=Math.round,l=Math.abs,p=Date.now;function d(t,e,n){return setTimeout(E(t,n),e)}function v(t,e,n){return!!Array.isArray(t)&&(y(t,n[e],n),!0)}function y(t,e,n){var r;if(t)if(t.forEach)t.forEach(e,n);else if(void 0!==t.length)for(r=0;r<t.length;)e.call(n,t[r],r,t),r++;else for(r in t)t.hasOwnProperty(r)&&e.call(n,t[r],r,t)}function m(t,e,n){var r="DEPRECATED METHOD: "+e+"\n"+n+" AT \n";return function(){var e=new Error("get-stack-trace"),n=e&&e.stack?e.stack.replace(/^[^\(]+?[\n$]/gm,"").replace(/^\s+at\s+/gm,"").replace(/^Object.<anonymous>\s*\(/gm,"{anonymous}()@"):"Unknown Stack Trace",o=i.console&&(i.console.warn||i.console.log);return o&&o.call(i.console,r,n),t.apply(this,arguments)}}u="function"!=typeof Object.assign?function(t){if(null==t)throw new TypeError("Cannot convert undefined or null to object");for(var e=Object(t),n=1;n<arguments.length;n++){var r=arguments[n];if(null!=r)for(var i in r)r.hasOwnProperty(i)&&(e[i]=r[i])}return e}:Object.assign;var g=m((function(t,e,n){for(var r=Object.keys(e),i=0;i<r.length;)(!n||n&&void 0===t[r[i]])&&(t[r[i]]=e[r[i]]),i++;return t}),"extend","Use `assign`."),w=m((function(t,e){return g(t,e,!0)}),"merge","Use `assign`.");function b(t,e,n){var r,i=e.prototype;(r=t.prototype=Object.create(i)).constructor=t,r._super=i,n&&u(r,n)}function E(t,e){return function(){return t.apply(e,arguments)}}function _(t,e){return"function"==typeof t?t.apply(e&&e[0]||void 0,e):t}function A(t,e){return void 0===t?e:t}function x(t,e,n){y(C(e),(function(e){t.addEventListener(e,n,!1)}))}function k(t,e,n){y(C(e),(function(e){t.removeEventListener(e,n,!1)}))}function T(t,e){for(;t;){if(t==e)return!0;t=t.parentNode}return!1}function S(t,e){return t.indexOf(e)>-1}function C(t){return t.trim().split(/\s+/g)}function R(t,e,n){if(t.indexOf&&!n)return t.indexOf(e);for(var r=0;r<t.length;){if(n&&t[r][n]==e||!n&&t[r]===e)return r;r++}return-1}function P(t){return Array.prototype.slice.call(t,0)}function I(t,e,n){for(var r=[],i=[],o=0;o<t.length;){var a=e?t[o][e]:t[o];R(i,a)<0&&r.push(t[o]),i[o]=a,o++}return n&&(r=e?r.sort((function(t,n){return t[e]>n[e]})):r.sort()),r}function M(t,e){for(var n,r,i=e[0].toUpperCase()+e.slice(1),o=0;o<c.length;){if((r=(n=c[o])?n+i:e)in t)return r;o++}}var U=1;function O(t){var e=t.ownerDocument||t;return e.defaultView||e.parentWindow||i}var D="ontouchstart"in i,L=void 0!==M(i,"PointerEvent"),N=D&&/mobile|tablet|ip(ad|hone|od)|android/i.test(navigator.userAgent),F=["x","y"],B=["clientX","clientY"];function V(t,e){var n=this;this.manager=t,this.callback=e,this.element=t.element,this.target=t.options.inputTarget,this.domHandler=function(e){_(t.options.enable,[t])&&n.handler(e)},this.init()}function j(t,e,n){var r=n.pointers.length,i=n.changedPointers.length,o=1&e&&r-i==0,a=12&e&&r-i==0;n.isFirst=!!o,n.isFinal=!!a,o&&(t.session={}),n.eventType=e,function(t,e){var n=t.session,r=e.pointers,i=r.length;n.firstInput||(n.firstInput=Y(e));i>1&&!n.firstMultiple?n.firstMultiple=Y(e):1===i&&(n.firstMultiple=!1);var o=n.firstInput,a=n.firstMultiple,s=a?a.center:o.center,u=e.center=G(r);e.timeStamp=p(),e.deltaTime=e.timeStamp-o.timeStamp,e.angle=X(s,u),e.distance=z(s,u),function(t,e){var n=e.center,r=t.offsetDelta||{},i=t.prevDelta||{},o=t.prevInput||{};1!==e.eventType&&4!==o.eventType||(i=t.prevDelta={x:o.deltaX||0,y:o.deltaY||0},r=t.offsetDelta={x:n.x,y:n.y});e.deltaX=i.x+(n.x-r.x),e.deltaY=i.y+(n.y-r.y)}(n,e),e.offsetDirection=q(e.deltaX,e.deltaY);var c=W(e.deltaTime,e.deltaX,e.deltaY);e.overallVelocityX=c.x,e.overallVelocityY=c.y,e.overallVelocity=l(c.x)>l(c.y)?c.x:c.y,e.scale=a?(h=a.pointers,f=r,z(f[0],f[1],B)/z(h[0],h[1],B)):1,e.rotation=a?function(t,e){return X(e[1],e[0],B)+X(t[1],t[0],B)}(a.pointers,r):0,e.maxPointers=n.prevInput?e.pointers.length>n.prevInput.maxPointers?e.pointers.length:n.prevInput.maxPointers:e.pointers.length,function(t,e){var n,r,i,o,a=t.lastInterval||e,s=e.timeStamp-a.timeStamp;if(8!=e.eventType&&(s>25||void 0===a.velocity)){var u=e.deltaX-a.deltaX,c=e.deltaY-a.deltaY,h=W(s,u,c);r=h.x,i=h.y,n=l(h.x)>l(h.y)?h.x:h.y,o=q(u,c),t.lastInterval=e}else n=a.velocity,r=a.velocityX,i=a.velocityY,o=a.direction;e.velocity=n,e.velocityX=r,e.velocityY=i,e.direction=o}(n,e);var h,f;var d=t.element;T(e.srcEvent.target,d)&&(d=e.srcEvent.target);e.target=d}(t,n),t.emit("hammer.input",n),t.recognize(n),t.session.prevInput=n}function Y(t){for(var e=[],n=0;n<t.pointers.length;)e[n]={clientX:f(t.pointers[n].clientX),clientY:f(t.pointers[n].clientY)},n++;return{timeStamp:p(),pointers:e,center:G(e),deltaX:t.deltaX,deltaY:t.deltaY}}function G(t){var e=t.length;if(1===e)return{x:f(t[0].clientX),y:f(t[0].clientY)};for(var n=0,r=0,i=0;i<e;)n+=t[i].clientX,r+=t[i].clientY,i++;return{x:f(n/e),y:f(r/e)}}function W(t,e,n){return{x:e/t||0,y:n/t||0}}function q(t,e){return t===e?1:l(t)>=l(e)?t<0?2:4:e<0?8:16}function z(t,e,n){n||(n=F);var r=e[n[0]]-t[n[0]],i=e[n[1]]-t[n[1]];return Math.sqrt(r*r+i*i)}function X(t,e,n){n||(n=F);var r=e[n[0]]-t[n[0]],i=e[n[1]]-t[n[1]];return 180*Math.atan2(i,r)/Math.PI}V.prototype={handler:function(){},init:function(){this.evEl&&x(this.element,this.evEl,this.domHandler),this.evTarget&&x(this.target,this.evTarget,this.domHandler),this.evWin&&x(O(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&k(this.element,this.evEl,this.domHandler),this.evTarget&&k(this.target,this.evTarget,this.domHandler),this.evWin&&k(O(this.element),this.evWin,this.domHandler)}};var H={mousedown:1,mousemove:2,mouseup:4};function K(){this.evEl="mousedown",this.evWin="mousemove mouseup",this.pressed=!1,V.apply(this,arguments)}b(K,V,{handler:function(t){var e=H[t.type];1&e&&0===t.button&&(this.pressed=!0),2&e&&1!==t.which&&(e=4),this.pressed&&(4&e&&(this.pressed=!1),this.callback(this.manager,e,{pointers:[t],changedPointers:[t],pointerType:"mouse",srcEvent:t}))}});var J={pointerdown:1,pointermove:2,pointerup:4,pointercancel:8,pointerout:8},Q={2:"touch",3:"pen",4:"mouse",5:"kinect"},$="pointerdown",Z="pointermove pointerup pointercancel";function tt(){this.evEl=$,this.evWin=Z,V.apply(this,arguments),this.store=this.manager.session.pointerEvents=[]}i.MSPointerEvent&&!i.PointerEvent&&($="MSPointerDown",Z="MSPointerMove MSPointerUp MSPointerCancel"),b(tt,V,{handler:function(t){var e=this.store,n=!1,r=t.type.toLowerCase().replace("ms",""),i=J[r],o=Q[t.pointerType]||t.pointerType,a="touch"==o,s=R(e,t.pointerId,"pointerId");1&i&&(0===t.button||a)?s<0&&(e.push(t),s=e.length-1):12&i&&(n=!0),s<0||(e[s]=t,this.callback(this.manager,i,{pointers:e,changedPointers:[t],pointerType:o,srcEvent:t}),n&&e.splice(s,1))}});var et={touchstart:1,touchmove:2,touchend:4,touchcancel:8};function nt(){this.evTarget="touchstart",this.evWin="touchstart touchmove touchend touchcancel",this.started=!1,V.apply(this,arguments)}function rt(t,e){var n=P(t.touches),r=P(t.changedTouches);return 12&e&&(n=I(n.concat(r),"identifier",!0)),[n,r]}b(nt,V,{handler:function(t){var e=et[t.type];if(1===e&&(this.started=!0),this.started){var n=rt.call(this,t,e);12&e&&n[0].length-n[1].length==0&&(this.started=!1),this.callback(this.manager,e,{pointers:n[0],changedPointers:n[1],pointerType:"touch",srcEvent:t})}}});var it={touchstart:1,touchmove:2,touchend:4,touchcancel:8};function ot(){this.evTarget="touchstart touchmove touchend touchcancel",this.targetIds={},V.apply(this,arguments)}function at(t,e){var n=P(t.touches),r=this.targetIds;if(3&e&&1===n.length)return r[n[0].identifier]=!0,[n,n];var i,o,a=P(t.changedTouches),s=[],u=this.target;if(o=n.filter((function(t){return T(t.target,u)})),1===e)for(i=0;i<o.length;)r[o[i].identifier]=!0,i++;for(i=0;i<a.length;)r[a[i].identifier]&&s.push(a[i]),12&e&&delete r[a[i].identifier],i++;return s.length?[I(o.concat(s),"identifier",!0),s]:void 0}b(ot,V,{handler:function(t){var e=it[t.type],n=at.call(this,t,e);n&&this.callback(this.manager,e,{pointers:n[0],changedPointers:n[1],pointerType:"touch",srcEvent:t})}});function st(){V.apply(this,arguments);var t=E(this.handler,this);this.touch=new ot(this.manager,t),this.mouse=new K(this.manager,t),this.primaryTouch=null,this.lastTouches=[]}function ut(t,e){1&t?(this.primaryTouch=e.changedPointers[0].identifier,ct.call(this,e)):12&t&&ct.call(this,e)}function ct(t){var e=t.changedPointers[0];if(e.identifier===this.primaryTouch){var n={x:e.clientX,y:e.clientY};this.lastTouches.push(n);var r=this.lastTouches;setTimeout((function(){var t=r.indexOf(n);t>-1&&r.splice(t,1)}),2500)}}function ht(t){for(var e=t.srcEvent.clientX,n=t.srcEvent.clientY,r=0;r<this.lastTouches.length;r++){var i=this.lastTouches[r],o=Math.abs(e-i.x),a=Math.abs(n-i.y);if(o<=25&&a<=25)return!0}return!1}b(st,V,{handler:function(t,e,n){var r="touch"==n.pointerType,i="mouse"==n.pointerType;if(!(i&&n.sourceCapabilities&&n.sourceCapabilities.firesTouchEvents)){if(r)ut.call(this,e,n);else if(i&&ht.call(this,n))return;this.callback(t,e,n)}},destroy:function(){this.touch.destroy(),this.mouse.destroy()}});var ft=M(h.style,"touchAction"),lt=void 0!==ft,pt=function(){if(!lt)return!1;var t={},e=i.CSS&&i.CSS.supports;return["auto","manipulation","pan-y","pan-x","pan-x pan-y","none"].forEach((function(n){t[n]=!e||i.CSS.supports("touch-action",n)})),t}();function dt(t,e){this.manager=t,this.set(e)}dt.prototype={set:function(t){"compute"==t&&(t=this.compute()),lt&&this.manager.element.style&&pt[t]&&(this.manager.element.style[ft]=t),this.actions=t.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var t=[];return y(this.manager.recognizers,(function(e){_(e.options.enable,[e])&&(t=t.concat(e.getTouchAction()))})),function(t){if(S(t,"none"))return"none";var e=S(t,"pan-x"),n=S(t,"pan-y");if(e&&n)return"none";if(e||n)return e?"pan-x":"pan-y";if(S(t,"manipulation"))return"manipulation";return"auto"}(t.join(" "))},preventDefaults:function(t){var e=t.srcEvent,n=t.offsetDirection;if(this.manager.session.prevented)e.preventDefault();else{var r=this.actions,i=S(r,"none")&&!pt.none,o=S(r,"pan-y")&&!pt["pan-y"],a=S(r,"pan-x")&&!pt["pan-x"];if(i){var s=1===t.pointers.length,u=t.distance<2,c=t.deltaTime<250;if(s&&u&&c)return}if(!a||!o)return i||o&&6&n||a&&24&n?this.preventSrc(e):void 0}},preventSrc:function(t){this.manager.session.prevented=!0,t.preventDefault()}};function vt(t){this.options=u({},this.defaults,t||{}),this.id=U++,this.manager=null,this.options.enable=A(this.options.enable,!0),this.state=1,this.simultaneous={},this.requireFail=[]}function yt(t){return 16&t?"cancel":8&t?"end":4&t?"move":2&t?"start":""}function mt(t){return 16==t?"down":8==t?"up":2==t?"left":4==t?"right":""}function gt(t,e){var n=e.manager;return n?n.get(t):t}function wt(){vt.apply(this,arguments)}function bt(){wt.apply(this,arguments),this.pX=null,this.pY=null}function Et(){wt.apply(this,arguments)}function _t(){vt.apply(this,arguments),this._timer=null,this._input=null}function At(){wt.apply(this,arguments)}function xt(){wt.apply(this,arguments)}function kt(){vt.apply(this,arguments),this.pTime=!1,this.pCenter=!1,this._timer=null,this._input=null,this.count=0}function Tt(t,e){return(e=e||{}).recognizers=A(e.recognizers,Tt.defaults.preset),new St(t,e)}vt.prototype={defaults:{},set:function(t){return u(this.options,t),this.manager&&this.manager.touchAction.update(),this},recognizeWith:function(t){if(v(t,"recognizeWith",this))return this;var e=this.simultaneous;return e[(t=gt(t,this)).id]||(e[t.id]=t,t.recognizeWith(this)),this},dropRecognizeWith:function(t){return v(t,"dropRecognizeWith",this)?this:(t=gt(t,this),delete this.simultaneous[t.id],this)},requireFailure:function(t){if(v(t,"requireFailure",this))return this;var e=this.requireFail;return-1===R(e,t=gt(t,this))&&(e.push(t),t.requireFailure(this)),this},dropRequireFailure:function(t){if(v(t,"dropRequireFailure",this))return this;t=gt(t,this);var e=R(this.requireFail,t);return e>-1&&this.requireFail.splice(e,1),this},hasRequireFailures:function(){return this.requireFail.length>0},canRecognizeWith:function(t){return!!this.simultaneous[t.id]},emit:function(t){var e=this,n=this.state;function r(n){e.manager.emit(n,t)}n<8&&r(e.options.event+yt(n)),r(e.options.event),t.additionalEvent&&r(t.additionalEvent),n>=8&&r(e.options.event+yt(n))},tryEmit:function(t){if(this.canEmit())return this.emit(t);this.state=32},canEmit:function(){for(var t=0;t<this.requireFail.length;){if(!(33&this.requireFail[t].state))return!1;t++}return!0},recognize:function(t){var e=u({},t);if(!_(this.options.enable,[this,e]))return this.reset(),void(this.state=32);56&this.state&&(this.state=1),this.state=this.process(e),30&this.state&&this.tryEmit(e)},process:function(t){},getTouchAction:function(){},reset:function(){}},b(wt,vt,{defaults:{pointers:1},attrTest:function(t){var e=this.options.pointers;return 0===e||t.pointers.length===e},process:function(t){var e=this.state,n=t.eventType,r=6&e,i=this.attrTest(t);return r&&(8&n||!i)?16|e:r||i?4&n?8|e:2&e?4|e:2:32}}),b(bt,wt,{defaults:{event:"pan",threshold:10,pointers:1,direction:30},getTouchAction:function(){var t=this.options.direction,e=[];return 6&t&&e.push("pan-y"),24&t&&e.push("pan-x"),e},directionTest:function(t){var e=this.options,n=!0,r=t.distance,i=t.direction,o=t.deltaX,a=t.deltaY;return i&e.direction||(6&e.direction?(i=0===o?1:o<0?2:4,n=o!=this.pX,r=Math.abs(t.deltaX)):(i=0===a?1:a<0?8:16,n=a!=this.pY,r=Math.abs(t.deltaY))),t.direction=i,n&&r>e.threshold&&i&e.direction},attrTest:function(t){return wt.prototype.attrTest.call(this,t)&&(2&this.state||!(2&this.state)&&this.directionTest(t))},emit:function(t){this.pX=t.deltaX,this.pY=t.deltaY;var e=mt(t.direction);e&&(t.additionalEvent=this.options.event+e),this._super.emit.call(this,t)}}),b(Et,wt,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return["none"]},attrTest:function(t){return this._super.attrTest.call(this,t)&&(Math.abs(t.scale-1)>this.options.threshold||2&this.state)},emit:function(t){if(1!==t.scale){var e=t.scale<1?"in":"out";t.additionalEvent=this.options.event+e}this._super.emit.call(this,t)}}),b(_t,vt,{defaults:{event:"press",pointers:1,time:251,threshold:9},getTouchAction:function(){return["auto"]},process:function(t){var e=this.options,n=t.pointers.length===e.pointers,r=t.distance<e.threshold,i=t.deltaTime>e.time;if(this._input=t,!r||!n||12&t.eventType&&!i)this.reset();else if(1&t.eventType)this.reset(),this._timer=d((function(){this.state=8,this.tryEmit()}),e.time,this);else if(4&t.eventType)return 8;return 32},reset:function(){clearTimeout(this._timer)},emit:function(t){8===this.state&&(t&&4&t.eventType?this.manager.emit(this.options.event+"up",t):(this._input.timeStamp=p(),this.manager.emit(this.options.event,this._input)))}}),b(At,wt,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return["none"]},attrTest:function(t){return this._super.attrTest.call(this,t)&&(Math.abs(t.rotation)>this.options.threshold||2&this.state)}}),b(xt,wt,{defaults:{event:"swipe",threshold:10,velocity:.3,direction:30,pointers:1},getTouchAction:function(){return bt.prototype.getTouchAction.call(this)},attrTest:function(t){var e,n=this.options.direction;return 30&n?e=t.overallVelocity:6&n?e=t.overallVelocityX:24&n&&(e=t.overallVelocityY),this._super.attrTest.call(this,t)&&n&t.offsetDirection&&t.distance>this.options.threshold&&t.maxPointers==this.options.pointers&&l(e)>this.options.velocity&&4&t.eventType},emit:function(t){var e=mt(t.offsetDirection);e&&this.manager.emit(this.options.event+e,t),this.manager.emit(this.options.event,t)}}),b(kt,vt,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10},getTouchAction:function(){return["manipulation"]},process:function(t){var e=this.options,n=t.pointers.length===e.pointers,r=t.distance<e.threshold,i=t.deltaTime<e.time;if(this.reset(),1&t.eventType&&0===this.count)return this.failTimeout();if(r&&i&&n){if(4!=t.eventType)return this.failTimeout();var o=!this.pTime||t.timeStamp-this.pTime<e.interval,a=!this.pCenter||z(this.pCenter,t.center)<e.posThreshold;if(this.pTime=t.timeStamp,this.pCenter=t.center,a&&o?this.count+=1:this.count=1,this._input=t,0===this.count%e.taps)return this.hasRequireFailures()?(this._timer=d((function(){this.state=8,this.tryEmit()}),e.interval,this),2):8}return 32},failTimeout:function(){return this._timer=d((function(){this.state=32}),this.options.interval,this),32},reset:function(){clearTimeout(this._timer)},emit:function(){8==this.state&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))}}),Tt.VERSION="2.0.7",Tt.defaults={domEvents:!1,touchAction:"compute",enable:!0,inputTarget:null,inputClass:null,preset:[[At,{enable:!1}],[Et,{enable:!1},["rotate"]],[xt,{direction:6}],[bt,{direction:6},["swipe"]],[kt],[kt,{event:"doubletap",taps:2},["tap"]],[_t]],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}};function St(t,e){var n;this.options=u({},Tt.defaults,e||{}),this.options.inputTarget=this.options.inputTarget||t,this.handlers={},this.session={},this.recognizers=[],this.oldCssProps={},this.element=t,this.input=new((n=this).options.inputClass||(L?tt:N?ot:D?st:K))(n,j),this.touchAction=new dt(this,this.options.touchAction),Ct(this,!0),y(this.options.recognizers,(function(t){var e=this.add(new t[0](t[1]));t[2]&&e.recognizeWith(t[2]),t[3]&&e.requireFailure(t[3])}),this)}function Ct(t,e){var n,r=t.element;r.style&&(y(t.options.cssProps,(function(i,o){n=M(r.style,o),e?(t.oldCssProps[n]=r.style[n],r.style[n]=i):r.style[n]=t.oldCssProps[n]||""})),e||(t.oldCssProps={}))}St.prototype={set:function(t){return u(this.options,t),t.touchAction&&this.touchAction.update(),t.inputTarget&&(this.input.destroy(),this.input.target=t.inputTarget,this.input.init()),this},stop:function(t){this.session.stopped=t?2:1},recognize:function(t){var e=this.session;if(!e.stopped){var n;this.touchAction.preventDefaults(t);var r=this.recognizers,i=e.curRecognizer;(!i||i&&8&i.state)&&(i=e.curRecognizer=null);for(var o=0;o<r.length;)n=r[o],2===e.stopped||i&&n!=i&&!n.canRecognizeWith(i)?n.reset():n.recognize(t),!i&&14&n.state&&(i=e.curRecognizer=n),o++}},get:function(t){if(t instanceof vt)return t;for(var e=this.recognizers,n=0;n<e.length;n++)if(e[n].options.event==t)return e[n];return null},add:function(t){if(v(t,"add",this))return this;var e=this.get(t.options.event);return e&&this.remove(e),this.recognizers.push(t),t.manager=this,this.touchAction.update(),t},remove:function(t){if(v(t,"remove",this))return this;if(t=this.get(t)){var e=this.recognizers,n=R(e,t);-1!==n&&(e.splice(n,1),this.touchAction.update())}return this},on:function(t,e){if(void 0!==t&&void 0!==e){var n=this.handlers;return y(C(t),(function(t){n[t]=n[t]||[],n[t].push(e)})),this}},off:function(t,e){if(void 0!==t){var n=this.handlers;return y(C(t),(function(t){e?n[t]&&n[t].splice(R(n[t],e),1):delete n[t]})),this}},emit:function(t,e){this.options.domEvents&&function(t,e){var n=o.createEvent("Event");n.initEvent(t,!0,!0),n.gesture=e,e.target.dispatchEvent(n)}(t,e);var n=this.handlers[t]&&this.handlers[t].slice();if(n&&n.length){e.type=t,e.preventDefault=function(){e.srcEvent.preventDefault()};for(var r=0;r<n.length;)n[r](e),r++}},destroy:function(){this.element&&Ct(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}},u(Tt,{INPUT_START:1,INPUT_MOVE:2,INPUT_END:4,INPUT_CANCEL:8,STATE_POSSIBLE:1,STATE_BEGAN:2,STATE_CHANGED:4,STATE_ENDED:8,STATE_RECOGNIZED:8,STATE_CANCELLED:16,STATE_FAILED:32,DIRECTION_NONE:1,DIRECTION_LEFT:2,DIRECTION_RIGHT:4,DIRECTION_UP:8,DIRECTION_DOWN:16,DIRECTION_HORIZONTAL:6,DIRECTION_VERTICAL:24,DIRECTION_ALL:30,Manager:St,Input:V,TouchAction:dt,TouchInput:ot,MouseInput:K,PointerEventInput:tt,TouchMouseInput:st,SingleTouchInput:nt,Recognizer:vt,AttrRecognizer:wt,Tap:kt,Pan:bt,Swipe:xt,Pinch:Et,Rotate:At,Press:_t,on:x,off:k,each:y,merge:w,extend:g,assign:u,inherit:b,bindFn:E,prefixed:M}),(void 0!==i?i:"undefined"!=typeof self?self:{}).Hammer=Tt,void 0===(r=function(){return Tt}.call(e,n,e,t))||(t.exports=r)}(window,document)},function(t,e,n){n(110)("Float32",4,(function(t){return function(e,n,r){return t(this,e,n,r)}}))},function(t,e,n){"use strict";var r=n(52),i=RegExp.prototype.exec;t.exports=function(t,e){var n=t.exec;if("function"==typeof n){var o=n.call(t,e);if("object"!=typeof o)throw new TypeError("RegExp exec method returned something other than an Object or null");return o}if("RegExp"!==r(t))throw new TypeError("RegExp#exec called on incompatible receiver");return i.call(t,e)}},function(t,e,n){"use strict";n(164);var r=n(16),i=n(10),o=n(9),a=n(29),s=n(3),u=n(151),c=s("species"),h=!o((function(){var t=/./;return t.exec=function(){var t=[];return t.groups={a:"7"},t},"7"!=="".replace(t,"$<a>")})),f=function(){var t=/(?:)/,e=t.exec;t.exec=function(){return e.apply(this,arguments)};var n="ab".split(t);return 2===n.length&&"a"===n[0]&&"b"===n[1]}();t.exports=function(t,e,n){var l=s(t),p=!o((function(){var e={};return e[l]=function(){return 7},7!=""[t](e)})),d=p?!o((function(){var e=!1,n=/a/;return n.exec=function(){return e=!0,null},"split"===t&&(n.constructor={},n.constructor[c]=function(){return n}),n[l](""),!e})):void 0;if(!p||!d||"replace"===t&&!h||"split"===t&&!f){var v=/./[l],y=n(a,l,""[t],(function(t,e,n,r,i){return e.exec===u?p&&!i?{done:!0,value:v.call(e,n,r)}:{done:!0,value:t.call(n,e,r)}:{done:!1}})),m=y[0],g=y[1];r(String.prototype,t,m),i(RegExp.prototype,l,2==e?function(t,e){return g.call(t,this,e)}:function(t){return g.call(t,this)})}}},,function(t,e,n){var r,i,o;i=[],void 0===(o="function"==typeof(r=function(){var t=XMLHttpRequest;if(!t)throw new Error("missing XMLHttpRequest");function e(o,a){if("function"!=typeof a)throw new Error("Bad callback given: "+a);if(!o)throw new Error("No options given");var s=o.onResponse;if((o="string"==typeof o?{uri:o}:JSON.parse(JSON.stringify(o))).onResponse=s,o.verbose&&(e.log=function(){var t,e,n={},o=["trace","debug","info","warn","error"];for(e=0;e<o.length;e++)n[t=o[e]]=r,"undefined"!=typeof console&&console&&console[t]&&(n[t]=i(console,t));return n}()),o.url&&(o.uri=o.url,delete o.url),!o.uri&&""!==o.uri)throw new Error("options.uri is a required argument");if("string"!=typeof o.uri)throw new Error("options.uri must be a string");for(var u=["proxy","_redirectsFollowed","maxRedirects","followRedirect"],c=0;c<u.length;c++)if(o[u[c]])throw new Error("options."+u[c]+" is not supported");if(o.callback=a,o.method=o.method||"GET",o.headers=o.headers||{},o.body=o.body||null,o.timeout=o.timeout||e.DEFAULT_TIMEOUT,o.headers.host)throw new Error("Options.headers.host is not supported");o.json&&(o.headers.accept=o.headers.accept||"application/json","GET"!==o.method&&(o.headers["content-type"]="application/json"),"boolean"!=typeof o.json?o.body=JSON.stringify(o.json):"string"!=typeof o.body&&(o.body=JSON.stringify(o.body)));var h=function(t){var e=[];for(var n in t)t.hasOwnProperty(n)&&e.push(encodeURIComponent(n)+"="+encodeURIComponent(t[n]));return e.join("&")};if(o.qs){var f="string"==typeof o.qs?o.qs:h(o.qs);-1!==o.uri.indexOf("?")?o.uri=o.uri+"&"+f:o.uri=o.uri+"?"+f}if(o.form){if("string"==typeof o.form)throw"form name unsupported";if("POST"===o.method){var l=(o.encoding||"application/x-www-form-urlencoded").toLowerCase();switch(o.headers["content-type"]=l,l){case"application/x-www-form-urlencoded":o.body=h(o.form).replace(/%20/g,"+");break;case"multipart/form-data":var p=function(t){var e={};e.boundry="-------------------------------"+Math.floor(1e9*Math.random());var n=[];for(var r in t)t.hasOwnProperty(r)&&n.push("--"+e.boundry+'\nContent-Disposition: form-data; name="'+r+'"\n\n'+t[r]+"\n");return n.push("--"+e.boundry+"--"),e.body=n.join(""),e.length=e.body.length,e.type="multipart/form-data; boundary="+e.boundry,e}(o.form);o.body=p.body,o.headers["content-type"]=p.type;break;default:throw new Error("unsupported encoding:"+l)}}}return o.onResponse=o.onResponse||r,!0===o.onResponse&&(o.onResponse=a,o.callback=r),!o.headers.authorization&&o.auth&&(o.headers.authorization="Basic "+function(t){var e,n,r,i,o,a,s,u,c="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",h=0,f=0,l="",p=[];if(!t)return t;do{e=t.charCodeAt(h++),n=t.charCodeAt(h++),r=t.charCodeAt(h++),i=(u=e<<16|n<<8|r)>>18&63,o=u>>12&63,a=u>>6&63,s=63&u,p[f++]=c.charAt(i)+c.charAt(o)+c.charAt(a)+c.charAt(s)}while(h<t.length);switch(l=p.join(""),t.length%3){case 1:l=l.slice(0,-2)+"==";break;case 2:l=l.slice(0,-1)+"="}return l}(o.auth.username+":"+o.auth.password)),function(r){var i=new t,o=!1,a=function(t){var e,n=/^([\w\+\.\-]+:)(?:\/\/([^\/?#:]*)(?::(\d+))?)?/;try{e=location.href}catch(t){(e=document.createElement("a")).href="",e=e.href}var r=n.exec(e.toLowerCase())||[],i=n.exec(t.toLowerCase());return!(!i||i[1]==r[1]&&i[2]==r[2]&&(i[3]||("http:"===i[1]?80:443))==(r[3]||("http:"===r[1]?80:443)))}(r.uri),s="withCredentials"in i;if(n+=1,i.seq_id=n,i.id=n+": "+r.method+" "+r.uri,i._id=i.id,a&&!s){var u=new Error("Browser does not support cross-origin request: "+r.uri);return u.cors="unsupported",r.callback(u,i)}i.timeoutTimer=setTimeout((function(){o=!0;var t=new Error("ETIMEDOUT");return t.code="ETIMEDOUT",t.duration=r.timeout,e.log.error("Timeout",{id:i._id,milliseconds:r.timeout}),r.callback(t,i)}),r.timeout);var c={response:!1,loading:!1,end:!1};return i.onreadystatechange=function(n){if(o)return e.log.debug("Ignoring timed out state change",{state:i.readyState,id:i.id});if(e.log.debug("State change",{state:i.readyState,id:i.id,timed_out:o}),i.readyState===t.OPENED)for(var a in e.log.debug("Request started",{id:i.id}),r.headers)i.setRequestHeader(a,r.headers[a]);else i.readyState===t.HEADERS_RECEIVED?h():i.readyState===t.LOADING?(h(),f()):i.readyState===t.DONE&&(h(),f(),function(){if(c.end)return;if(c.end=!0,e.log.debug("Request done",{id:i.id}),i.body=i.responseText,r.json)try{i.body=JSON.parse(i.responseText)}catch(t){return r.callback(t,i)}r.callback(null,i,i.body)}())},i.open(r.method,r.uri,!0),a&&(i.withCredentials=!!r.withCredentials),i.send(r.body),i;function h(){if(!c.response){if(c.response=!0,e.log.debug("Got response",{id:i.id,status:i.status}),clearTimeout(i.timeoutTimer),i.statusCode=i.status,a&&0==i.statusCode){var t=new Error("CORS request rejected: "+r.uri);return t.cors="rejected",c.loading=!0,c.end=!0,r.callback(t,i)}r.onResponse(null,i)}}function f(){c.loading||(c.loading=!0,e.log.debug("Response body loading",{id:i.id}))}}(o)}e.log={trace:r,debug:r,info:r,warn:r,error:r};var n=0;function r(){}function i(t,e){return function(n,r){return"object"==typeof r&&(n+=" "+JSON.stringify(r)),t[e].call(t,n)}}return e.withCredentials=!1,e.DEFAULT_TIMEOUT=18e4,e.defaults=function(t,n){var r=function(e){return function(n,r){for(var i in n="string"==typeof n?{uri:n}:JSON.parse(JSON.stringify(n)),t)void 0===n[i]&&(n[i]=t[i]);return e(n,r)}},i=r(e);return i.get=r(e.get),i.post=r(e.post),i.put=r(e.put),i.head=r(e.head),i},["get","put","post","head"].forEach((function(t){var n=t.toUpperCase();e[t.toLowerCase()]=function(t){"string"==typeof t?t={method:n,uri:t}:(t=JSON.parse(JSON.stringify(t))).method=n;var r=[t].concat(Array.prototype.slice.apply(arguments,[1]));return e.apply(this,r)}})),e.couch=function(t,n){return"string"==typeof t&&(t={uri:t}),t.json=!0,t.body&&(t.json=t.body),delete t.body,n=n||r,e(t,(function(t,e,r){if(t)return n(t,e,r);if((e.statusCode<200||e.statusCode>299)&&r.error){for(var i in t=new Error("CouchDB error: "+(r.error.reason||r.error.error)),r)t[i]=r[i];return n(t,e,r)}return n(t,e,r)}))},e})?r.apply(e,i):r)||(t.exports=o)},,,,,function(t,e,n){"use strict";var r=n(121)(!0);t.exports=function(t,e,n){return e+(n?r(t,e).length:1)}},function(t,e,n){"use strict";var r=n(151);n(2)({target:"RegExp",proto:!0,forced:r!==/./.exec},{exec:r})},function(t,e,n){"use strict";n(21),n(35),n(103),n(38),n(39),n(40),n(85),n(86),n(122),n(126),n(57),n(62);var r=n(14);n(206),n(209);Math.pow(2,32);function i(t,e,n,r,i,o,a){try{var s=t[o](a),u=s.value}catch(t){return void n(t)}s.done?e(u):Promise.resolve(u).then(r,i)}function o(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}n.d(e,"a",(function(){return b}));var a=2,s=3,u=4,c=5,h=6,f=7,l=8,p=0,d=1,v=3,y=5,m=9,g=10,w=11,b=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.taskStack=e}var e,n,b,_,A;return e=t,(n=[{key:"setComponentDescriptions",value:function(t){this.componentClasses=t}},{key:"castScreenSpaceRay",value:(_=regeneratorRuntime.mark((function t(e,n,i,o,a){var u,c=this;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return u=o?a?1:2:0,t.abrupt("return",new Promise((function(t,o){var a=r.a.fillMousePosBuffer(e,n,i,9);new DataView(a).setUint8(8,u,!0),c.taskStack.pushClientRemoteOperation(s,new Uint8Array(a),(function(e){var n=new DataView(e),i=r.a.readRTID(n,0);if(0==i)return t({entityRTID:null,pickedPosition:null});var o=[n.getFloat32(4,!0),n.getFloat32(8,!0),n.getFloat32(12,!0)];t({entityRTID:i.toString(),pickedPosition:o})}))})));case 2:case"end":return t.stop()}}),t,this)})),A=function(){var t=this,e=arguments;return new Promise((function(n,r){var o=_.apply(t,e);function a(t){i(o,n,r,a,s,"next",t)}function s(t){i(o,n,r,a,s,"throw",t)}a(void 0)}))},function(t,e,n,r,i){return A.apply(this,arguments)})},{key:"highlightEntities",value:function(t,e){var n=new ArrayBuffer(4*t.length+1),i=new DataView(n);for(var o in i.setInt8(0,0,!0),t)r.a.writeRTID(t[o],i,4*o+1);this.taskStack.pushClientRemoteOperation(u,new Uint8Array(n))}},{key:"createController",value:function(t,e,n){var i=new ArrayBuffer(6),o=new DataView(i);o.setUint8(0,t),o.setUint8(1,n?1:0),r.a.writeRTID(e,o,2),this.taskStack.pushClientRemoteOperation(a,new Uint8Array(i))}},{key:"deleteController",value:function(t){var e=new ArrayBuffer(4);new DataView(e).setUint32(0,t,!0),this.taskStack.pushClientRemoteOperation(h,new Uint8Array(e))}},{key:"setControllersState",value:function(t){var e=new ArrayBuffer(5*t.length),n=new DataView(e);for(var r in t)n.setUint32(5*r,t[r].id,!0),n.setInt8(5*r+4,t[r].enabled?1:0);this.taskStack.pushClientRemoteOperation(c,new Uint8Array(e))}},{key:"updateConfig",value:function(t){for(var e=JSON.stringify(t),n=new ArrayBuffer(e.length+1),r=new Uint8Array(n),i=0;i<e.length;i++)r[i]=e.charCodeAt(i);this.taskStack.pushEditorRemoteOperation(p,r,!0)}},{key:"createEntity",value:function(t){for(var e=JSON.stringify(t),n=new ArrayBuffer(8+e.length+1),r=new Uint8Array(n),i=0;i<e.length;i++)r[8+i]=e.charCodeAt(i);this.taskStack.pushEditorRemoteOperation(d,r)}},{key:"deleteEntities",value:function(t){var e=new ArrayBuffer(4*t.length),n=new DataView(e);for(var i in t)r.a.writeRTID(t[i],n,4*i);this.taskStack.pushEditorRemoteOperation(y,new Uint8Array(e))}},{key:"propagateChanges",value:function(t){var e={},n=[];for(var r in t){var i=t[r],o=!0,a=!1,s=void 0;try{for(var u,c=i.dirtyComponents[Symbol.iterator]();!(o=(u=c.next()).done);o=!0){var h=u.value;"material"==h&&n.push({entityRTID:i.isOverrider()?i.overriddenEntity.getComponent("euid").rtid:i.getComponent("euid").rtid,value:i.getComponent(h)}),E.hasOwnProperty(h)&&(e[h]||(e[h]=[]),e[h].push({rtid:i.isOverrider()?i.overriddenEntity.getComponent("euid").rtid:i.getComponent("euid").rtid,component:i.getComponent(h)}))}}catch(t){a=!0,s=t}finally{try{o||null==c.return||c.return()}finally{if(a)throw s}}i.dirtyComponents.length=0}Object.keys(e).length>0&&this.serializeComponents(e);for(var f=0;f<n.length;f++){var l=n[f];this.updateDataObject(l.entityRTID,l.value.dataJSON)}}},{key:"serializeComponents",value:function(t){var e=4;for(var n in t)e+=8,e+=4*(u=t[n]).length,e+=this.componentClasses[n].size*u.length;var i=0,o=new ArrayBuffer(e),a=new DataView(o);for(var n in a.setUint32(i,Object.keys(t).length,!0),i+=4,t){var s=this.componentClasses[n].hash,u=t[n];for(var c in a.setUint32(i,s,!0),i+=4,a.setUint32(i,u.length,!0),i+=4,u)r.a.writeRTID(u[c].rtid,a,i),i+=4;for(var c in u){var h=u[c].component;E[n](h,a,i),i+=this.componentClasses[n].size}}this.taskStack.pushEditorRemoteOperation(v,new Uint8Array(o),!0)}},{key:"updateDataObject",value:function(t,e){var n=JSON.stringify(e),i=new ArrayBuffer(4+n.length+1),o=new DataView(i);r.a.writeRTID(t,o,0);for(var a=0;a<n.length;a++)o.setUint8(a+4,n.charCodeAt(a));this.taskStack.pushEditorRemoteOperation(m,new Uint8Array(i),!0)}},{key:"fireEvent",value:function(t,e,n){for(var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},o=0==Object.keys(i).length,a=JSON.stringify(i),s=o?1:a.length+1,u=new ArrayBuffer(32+e.length+1+s+4+4*n.length),c=new DataView(u),h=0,f=0;f<16;f++)c.setUint8(h++,this.taskStack.uuidBuffer[f]);for(var l=r.a.uuidToUint8Array(t),p=0;p<16;p++)c.setUint8(h++,l[p]);for(var d=0;d<e.length;d++)c.setUint8(h++,e.charCodeAt(d));if(h++,!o)for(var v=0;v<a.length;v++)c.setUint8(h++,a.charCodeAt(v));for(var y in h++,c.setUint32(h,n.length,!0),h+=4,n)r.a.writeRTID(n[y],c,h),h+=4;this.taskStack.pushEditorRemoteOperation(w,new Uint8Array(u))}},{key:"updateActionMap",value:function(t){for(var e=t.serialize(),n=new ArrayBuffer(e.length+1),r=new Uint8Array(n),i=0;i<e.length;i++)r[i]=e.charCodeAt(i);this.taskStack.pushClientRemoteOperation(f,r)}},{key:"updateAsset",value:function(t,e){console.log("update-asset",t,e);for(var n=new ArrayBuffer(16+t.length+1),i=new Uint8Array(n),o=r.a.uuidToUint8Array(e),a=0,s=0;s<16;s++)i[a++]=o[s];for(var u=0;u<t.length;u++)i[a++]=t.charCodeAt(u);this.taskStack.pushEditorRemoteOperation(g,i)}},{key:"updateSelectionColor",value:function(t){var e=r.a.hexToRgb(t),n=e.r|e.g<<8|e.b<<16,i=new ArrayBuffer(4);new DataView(i).setUint32(0,n,!0),this.taskStack.pushClientRemoteOperation(l,new Uint8Array(i))}}])&&o(e.prototype,n),b&&o(e,b),t}(),E={local_transform:function(t,e,n){for(var r in t.position){var i=t.position[r];e.setFloat32(n,i,!0),n+=4}for(var r in t.orientation){i=t.orientation[r];e.setFloat32(n,i,!0),n+=4}for(var r in t.scale){i=t.scale[r];e.setFloat32(n,i,!0),n+=4}},point_light:function(t,e,n){for(var r in t.color){var i=t.color[r];e.setFloat32(n,i,!0),n+=4}e.setUint32(n,t.intensity,!0),n+=4},camera:function(t,e,n){r.a.serializeUUID(t.renderGraphRef,e,n),n+=16,e.setFloat32(n,t.aspectRatio,!0),n+=4,e.setFloat32(n,t.fovy,!0),n+=4,e.setFloat32(n,t.nearPlane,!0),n+=4,e.setFloat32(n,t.farPlane,!0),n+=4,e.setUint8(n,t.isOrthographic?1:0,!0),n+=1},material_ref:function(t,e,n){r.a.serializeUUID(t.value,e,n),n+=16},animation_ref:function(t,e,n){r.a.serializeUUID(t.value,e,n),n+=16},volume_material_ref:function(t,e,n){r.a.serializeUUID(t.value,e,n),n+=16},volume_filter:function(t,e,n){var r=!0,i=!1,o=void 0;try{for(var a,s=t.range[Symbol.iterator]();!(r=(a=s.next()).done);r=!0){var u=a.value;e.setFloat32(n,u,!0),n+=4}}catch(t){i=!0,o=t}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}e.setUint8(n,t.bool?1:0),n+=1},box_geometry:function(t,e,n){var r=!0,i=!1,o=void 0;try{for(var a,s=t.dimension[Symbol.iterator]();!(r=(a=s.next()).done);r=!0){var u=a.value;e.setFloat32(n,u,!0),n+=4}}catch(t){i=!0,o=t}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}e.setUint8(n,t.isAdditive?1:0),n+=1},capsule_geometry:function(t,e,n){e.setFloat32(n,t.radius,!0),n+=4,e.setFloat32(n,t.height,!0),n+=4,e.setUint32(n,t.axis,!0),n+=4,e.setUint8(n,t.isAdditive?1:0),n+=1},cylinder_geometry:function(t,e,n){e.setFloat32(n,t.radius,!0),n+=4,e.setFloat32(n,t.height,!0),n+=4,e.setUint32(n,t.axis,!0),n+=4,e.setUint8(n,t.isAdditive?1:0),n+=1},plane_geometry:function(t,e,n){e.setFloat32(n,t.distance,!0),n+=4;var r=!0,i=!1,o=void 0;try{for(var a,s=t.normal[Symbol.iterator]();!(r=(a=s.next()).done);r=!0){var u=a.value;e.setFloat32(n,u,!0),n+=4}}catch(t){i=!0,o=t}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}e.setUint8(n,t.isAdditive?1:0),n+=1},sphere_geometry:function(t,e,n){e.setFloat32(n,t.radius,!0),n+=4,e.setUint8(n,t.isAdditive?1:0),n+=1}}},function(t,e,n){"use strict";var r=n(8),i=n(22),o=n(17),a=n(28),s=n(163),u=n(155),c=Math.max,h=Math.min,f=Math.floor,l=/\$([$&`']|\d\d?|<[^>]*>)/g,p=/\$([$&`']|\d\d?)/g;n(156)("replace",2,(function(t,e,n,d){return[function(r,i){var o=t(this),a=null==r?void 0:r[e];return void 0!==a?a.call(r,o,i):n.call(String(o),r,i)},function(t,e){var i=d(n,t,this,e);if(i.done)return i.value;var f=r(t),l=String(this),p="function"==typeof e;p||(e=String(e));var y=f.global;if(y){var m=f.unicode;f.lastIndex=0}for(var g=[];;){var w=u(f,l);if(null===w)break;if(g.push(w),!y)break;""===String(w[0])&&(f.lastIndex=s(l,o(f.lastIndex),m))}for(var b,E="",_=0,A=0;A<g.length;A++){w=g[A];for(var x=String(w[0]),k=c(h(a(w.index),l.length),0),T=[],S=1;S<w.length;S++)T.push(void 0===(b=w[S])?b:String(b));var C=w.groups;if(p){var R=[x].concat(T,k,l);void 0!==C&&R.push(C);var P=String(e.apply(void 0,R))}else P=v(x,l,k,T,C,e);k>=_&&(E+=l.slice(_,k)+P,_=k+x.length)}return E+l.slice(_)}];function v(t,e,r,o,a,s){var u=r+t.length,c=o.length,h=p;return void 0!==a&&(a=i(a),h=l),n.call(s,h,(function(n,i){var s;switch(i.charAt(0)){case"$":return"$";case"&":return t;case"`":return e.slice(0,r);case"'":return e.slice(u);case"<":s=a[i.slice(1,-1)];break;default:var h=+i;if(0===h)return n;if(h>c){var l=f(h/10);return 0===l?n:l<=c?void 0===o[l-1]?i.charAt(1):o[l-1]+i.charAt(1):n}s=o[h-1]}return void 0===s?"":s}))}}))},function(t,e){var n="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof window.msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto);if(n){var r=new Uint8Array(16);t.exports=function(){return n(r),r}}else{var i=new Array(16);t.exports=function(){for(var t,e=0;e<16;e++)0==(3&e)&&(t=4294967296*Math.random()),i[e]=t>>>((3&e)<<3)&255;return i}}},function(t,e){for(var n=[],r=0;r<256;++r)n[r]=(r+256).toString(16).substr(1);t.exports=function(t,e){var r=e||0,i=n;return[i[t[r++]],i[t[r++]],i[t[r++]],i[t[r++]],"-",i[t[r++]],i[t[r++]],"-",i[t[r++]],i[t[r++]],"-",i[t[r++]],i[t[r++]],"-",i[t[r++]],i[t[r++]],i[t[r++]],i[t[r++]],i[t[r++]],i[t[r++]]].join("")}},,,function(t,e,n){"use strict";(function(t){n.d(e,"a",(function(){return v}));n(21),n(55),n(56),n(85),n(86),n(122),n(126),n(57);var r=n(172),i=n(175),o=n(176),a=n(14),s=n(123),u=n(76);function c(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var h=0,f=2,l=3,p=4,d=5,v=function(){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),this.notifier=t,this.decoder=new r.a(this.notifier),this.taskStack=new i.a,this.inputRelay=new o.a(this.taskStack,t),this.inactivityWarningCallback=null,this.resetConnectedState(!1)}var n,v,m;return n=e,(v=[{key:"start",value:function(t,e){var n=this;return this.config=t,(this.config.watchOnly=e)?this.decoder.fitVideoInCanvas=!0:this.renderingAreaSize=this.config.resolution,this.decoder.initialize(this.config),this.canvas&&!e&&this.inputRelay.initialize(this.canvas),this.notifier.emit("onLoadingStarted"),this.connect().then((function(){n.resetInactivityTimeout()}))}},{key:"stop",value:function(){this.resetConnectedState(),this.socket.close()}},{key:"resetInactivityTimeout",value:function(){var t=this;this.inactivityWarningTimeout&&clearTimeout(this.inactivityWarningTimeout),this.isConnected&&!this.config.watchOnly&&(this.inactivityWarningTimeout=setTimeout((function(){if(t.inactivityWarningTimeout=null,!t.inactivityWarningCallback)return console.warn("Inactivity timeout reached and no callback is set to notify the user. Please refer to setInactivityCallback https://docs.3dverse.com/sdk/SDK3DVerse.html#setInactivityCallback"),void t.stop();t.inactivityTimeout=setTimeout((function(){console.warn("Inactivity timeout reached"),t.stop(),t.inactivityTimeout=null}),3e4),t.inactivityWarningCallback((function(){clearTimeout(t.inactivityTimeout),t.inactivityTimeout=null,t.resetInactivityTimeout()}))}),3e5))}},{key:"resetConnectedState",value:function(t){var e=this;t&&!this.isConnected||(this.isConnected=!1,this.onConnected=new Promise((function(t){e.onConnectedCallback=t})))}},{key:"setupDisplay",value:function(t){this.canvas=t,this.config&&this.inputRelay.initialize(t),this.decoder.setupDisplay(t),this.notifier.emit("onDisplayReady")}},{key:"connect",value:function(){var t=this;return this.isConnected&&this.stop(),this.socket=new WebSocket(this.getUrl()),this.socket.binaryType="arraybuffer",this.socket.onopen=function(){return t.onSocketOpened()},this.socket.onclose=function(){return t.onSocketClosed()},this.socket.onerror=function(e){return t.onSocketError(e)},this.onConnected}},{key:"getUrl",value:function(){return"https:"==location.protocol?"wss://".concat(this.config.connectionInfo.ip,":").concat(this.config.connectionInfo.sslport):"ws://".concat(this.config.connectionInfo.ip,":").concat(this.config.connectionInfo.port)}},{key:"onSocketOpened",value:function(){var t=this;if(console.log("Connected to "+this.getUrl()),this.notifier.emit("onLoadingProgress",{status:"connected",message:"Socket connected"}),this.socket.onmessage=function(e){var n=new DataView(e.data),r=t.config.connectionInfo.standalone?1:n.getInt16(0,!0),i=t.config.connectionInfo.standalone?0:2;if(t.clientUUID=t.parseUUID(e.data,i),t.taskStack.setClientUUID(t.clientUUID),1==r)return t.config.watchOnly?(t.setupClient(!1),t.setupHeartbeat(),void t.notifyLoadingEnded()):void t.sendViewerClientInfo();t.handleConnectionError(r)},!this.config.connectionInfo.standalone){var e=JSON.stringify({sessionKey:this.config.connectionInfo.sessionKey,clientApp:"$browser:".concat(navigator.userAgent),os:navigator.platform}),n=new ArrayBuffer(2),r=new DataView(n);r.setInt8(0,255&e.length,!0),r.setInt8(1,255&e.length>>8,!0),this.socket.send(n),this.socket.send(e)}}},{key:"onSocketClosed",value:function(){console.log("Disconnected from "+this.getUrl()),this.taskPurgeInterval&&clearInterval(this.taskPurgeInterval),this.heartbeatInterval&&clearInterval(this.heartbeatInterval),this.inactivityTimeout&&(clearTimeout(this.inactivityTimeout),this.inactivityTimeout=null),this.inactivityWarningTimeout&&(clearTimeout(this.inactivityWarningTimeout),this.inactivityWarningTimeout=null),this.decoder.close(),this.notifier.emit("onConnectionClosed"),this.resetConnectedState()}},{key:"onSocketError",value:function(t){console.error("Connection Error:"+JSON.stringify(t)),this.notifier.emit("onStreamerSocketError",t),this.stop()}},{key:"onMessageReceived",value:function(t){var e=new Uint8Array(t.data),n=new DataView(t.data),r=e[0];if(r==s.a.video_stream||r==s.a.video_stream_header){var i=n.getUint32(4,!0),o=n.getUint32(8,!0);if(o>0&&!this.config.watchOnly){var a=t.data.slice(12+i,12+i+o);this.parseFrameData(a,i)}var u=t.data.slice(12,12+i);this.notifier.emit("onFrameReceived",u),this.decoder.onFrameReceived(u)}else if(r==s.a.viewer_control){var c=n.getUint16(4,!0),h=n.getUint16(6,!0);this.decoder.resize(c,h),this.notifier.emit("onNewRenderingAreaSize",c,h)}else if(r==s.a.client_remote_operations){var f=t.data.slice(28);this.taskStack.onTaskResponse(f)}else r==s.a.registration?this.config.connectionInfo.standalone?this.connectToRenderer():(this.setupHeartbeat(),this.notifyLoadingEnded()):console.warn("Received a message on an unsupported channel "+r)}},{key:"connectToRenderer",value:function(){var t=this,e="ws://".concat(this.config.connectionInfo.ip,":").concat(this.config.connectionInfo.rendererPort);this.rendererSocket=new WebSocket(e),this.rendererSocket.binaryType="arraybuffer",this.rendererSocket.onopen=function(){console.log("Connected to renderer on ".concat(e)),t.notifyLoadingEnded()},this.rendererSocket.onclose=function(){console.warn("Disconnected from renderer on ".concat(e))},this.rendererSocket.onerror=function(e){return t.onSocketError(e)}}},{key:"notifyLoadingEnded",value:function(){this.notifier.emit("onLoadingEnded",{status:"accepted",message:"Connection accepted"}),this.isConnected=!0,this.onConnectedCallback()}},{key:"handleConnectionError",value:function(t){var e;switch(this.socket.onclose=function(){},this.socket.close(),t){case 100:e="Authentication failed";break;case 101:e="Session not found";break;case 102:e="Session closed";break;case 200:case 201:case 202:e="Rendering service unavailable";break;case 0:default:e="Unknown Error code : ".concat(t)}this.notifier.emit("onLoadingEnded",{status:"error",message:e,errorCode:t})}},{key:"setupClient",value:function(){var t=this,e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.socket.onmessage=function(e){return t.onMessageReceived(e)},e&&this.startPurgeTasks()}},{key:"startPurgeTasks",value:function(){var t=this;this.taskPurgeInterval=setInterval((function(){for(;!t.taskStack.isEmpty();){var e=t.taskStack.pop(),n=e.buffer,r=e.isRemoteOperation;t.config.connectionInfo.standalone&&r?t.rendererSocket.send(n):t.socket.send(n),t.resetInactivityTimeout()}}),1e3/this.inputRelayFrequency)}},{key:"sendViewerClientInfo",value:function(){var t=JSON.stringify({renderingAreaSize:this.renderingAreaSize,encoderConfig:{codec:0,profile:0,frameRate:30,lossy:!0,mp4:this.config.display.hardwareDecoding},inputConfig:{hasKeyboard:!0,hasMouse:!0,hasHololens:!1,hasGamepad:!0,hasTouchscreen:!0}});this.sendConfig(t),this.setupClient()}},{key:"sendConfig",value:function(t){var e=new ArrayBuffer(4);y(new DataView(e),s.a.registration,t.length),this.socket.send(e),this.socket.send(t)}},{key:"subscribeTo",value:function(t){console.log("Subscribe to "+t);var e=new ArrayBuffer(20),n=new DataView(e),r=a.a.uuidToUint8Array(t);y(n,s.a.camera_sharing,16);for(var i=0;i<16;i++)n.setUint8(4+i,r[i]);this.socket.send(e)}},{key:"parseFrameData",value:function(t,e){var n=0,r=new DataView(t),i={clientUUID:this.clientUUID,clients:{},networkTimestamp:new Date,rendererTimeStamp:r.getUint32(0,!0),frameCounter:r.getUint32(4,!0),imageSize:e};n+=8;var o=r.getUint8(n,!0);n++;for(var s=0;s<o;++s){var c=this.parseUUID(t,n);n+=16;var h=r.getUint8(n,!0);n++;for(var f=[],l=0;l<h;++l){var p=a.a.readRTID(r,n).toString();n+=4;for(var d=[],v=0;v<16;++v)d[v]=r.getFloat32(n,!0),n+=4;f.push({cameraRTID:p,worldMatrix:u.b.fromValues.apply(u.b,d)})}n+=68*(8-h),i.clients[c]={viewports:f}}this.notifier.emit("onFrameDataReceived",i)}},{key:"parseUUID",value:function(e,n){var r=new DataView(e,n,16),i=r.getUint32(0,!0),o=r.getUint16(4,!0),a=r.getUint16(6,!0);r.setUint32(0,i,!1),r.setUint16(4,o,!1),r.setUint16(6,a,!1);var s=new t;return s.import(Array.from(new Uint8Array(e).slice(n,n+16))),s.toString()}},{key:"resize",value:function(t,e){var n=a.a.alignForYUV(t,e);if(n.width!=this.renderingAreaSize[0]||n.height!=this.renderingAreaSize[1]){this.renderingAreaSize=[n.width,n.height];var r=new ArrayBuffer(9),i=new DataView(r);y(i,s.a.viewer_control,5),i.setUint8(4,h),i.setUint16(5,n.width,!0),i.setUint16(7,n.height,!0),this.socket.send(r)}}},{key:"updateViewports",value:function(t){var e=2+20*t.length,n=new ArrayBuffer(4+e),r=new DataView(n),i=0;for(var o in y(r,s.a.viewer_control,e),i+=4,r.setUint8(i,d),i++,r.setUint8(i,t.length),i++,t){var u=t[o];r.setFloat32(i,u.leftRatio,!0),i+=4,r.setFloat32(i,u.topRatio,!0),i+=4,r.setFloat32(i,u.widthRatio,!0),i+=4,r.setFloat32(i,u.heightRatio,!0),i+=4,a.a.writeRTID(u.cameraEntity.UNSAFE_getComponent("euid").rtid,r,i),i+=4}this.viewports=t,this.socket.send(n)}},{key:"sendEncoderParams",value:function(t){this.sendJsonToViewerControl(p,JSON.stringify(t))}},{key:"sendJsonToViewerControl",value:function(t,e){var n=1+e.length,r=new ArrayBuffer(4+n),i=new DataView(r),o=0;y(i,s.a.viewer_control,n),o+=4,i.setUint8(o++,t);for(var a=0;a<e.length;a++)i.setUint8(o++,e.charCodeAt(a));this.socket.send(r)}},{key:"setState",value:function(t){var e=new ArrayBuffer(5),n=new DataView(e);y(n,s.a.viewer_control,1),n.setUint8(4,t?l:f),this.socket.send(e)}},{key:"setupHeartbeat",value:function(){var t=this;this.heartbeatInterval=setInterval((function(){var e=new ArrayBuffer(4);y(new DataView(e),s.a.heartbeat,0),t.socket.send(e)}),3e4)}}])&&c(n.prototype,v),m&&c(n,m),e}();function y(t,e,n){t.setUint8(0,e,!0),t.setUint8(1,255&n>>0,!0),t.setUint8(2,255&n>>8,!0),t.setUint8(3,255&n>>16,!0)}}).call(this,n(133))},function(t,e,n){"use strict";n.d(e,"a",(function(){return h}));n(21),n(122),n(57),n(62),n(124);var r=n(173),i=n.n(r),o=n(174),a=n.n(o);n(14);function s(t,e,n,r,i,o,a){try{var s=t[o](a),u=s.value}catch(t){return void n(t)}s.done?e(u):Promise.resolve(u).then(r,i)}function u(t){return function(){var e=this,n=arguments;return new Promise((function(r,i){var o=t.apply(e,n);function a(t){s(o,r,i,a,u,"next",t)}function u(t){s(o,r,i,a,u,"throw",t)}a(void 0)}))}}function c(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var h=function(){function t(e){var n,r,i,o=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),i=function(){if(!o.sourceBuffer.updating&&0!=o.queue.length)try{o.sourceBuffer.appendBuffer(o.queue.shift())}catch(t){"QuotaExceededError"===t.name?console.error("sourceBuffer QuotaExceeded"):console.error("Error occured while appending sourceBuffer -  ".concat(t.name,": ").concat(t.message))}},(r="onSourceBufferUpdate")in(n=this)?Object.defineProperty(n,r,{value:i,enumerable:!0,configurable:!0,writable:!0}):n[r]=i,this.notifier=e,this.lastFrame=null}var e,n,r;return e=t,(n=[{key:"initialize",value:function(t){var e=this;if(this.isHardwareDecoding=t.display.hardwareDecoding,this.isHardwareDecoding&&!this.video?(this.video=document.createElement("video"),this.video.muted=!0,this.video.onpause=u(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.video.play();case 2:case"end":return t.stop()}}),t,this)})))):this.isHardwareDecoding||(this.canvasBuffer=document.createElement("canvas"),this.decoder=new i.a,this.decoder.onPictureDecoded=function(t,n,r){e.onFrameDecoded(t,n,r)},window.addEventListener("focus",(function(){e.lastFrame=e.cachedFrame}),!1)),this.resize(t.resolution[0],t.resolution[1]),window.requestAnimationFrame((function(){return e.renderFrame()})),!this.isHardwareDecoding)return console.log("Using software decoding"),Promise.resolve();if(console.log("Using hardware decoding"),!window.MediaSource)throw"Browser does not support media source extension.";var n='video/mp4; codecs="avc1.42E01E"';if(!MediaSource.isTypeSupported(n))throw"Unsupported media format";return this.mediaSource=new MediaSource,this.video.src=URL.createObjectURL(this.mediaSource),this.queue=[],new Promise((function(t){e.mediaSource.addEventListener("sourceopen",(function(){e.sourceBuffer=e.mediaSource.addSourceBuffer(n),e.sourceBuffer.mode="sequence",e.sourceBuffer.addEventListener("error",(function(t){console.error("sourceBuffer error",t)})),e.sourceBuffer.addEventListener("update",e.onSourceBufferUpdate),e.video.play(),e.onSourceBufferUpdate(),t()}),!1)}))}},{key:"setupDisplay",value:function(t){this.canvasContext=t.getContext("2d")}},{key:"close",value:function(){null!=this.sourceBuffer&&(this.mediaSource.removeSourceBuffer(this.sourceBuffer),this.sourceBuffer.removeEventListener("update",this.onSourceBufferUpdate),this.sourceBuffer.onupdateend=null,this.sourceBuffer=null)}},{key:"resize",value:function(t,e){this.targetWidth=t,this.targetHeight=e,this.isHardwareDecoding?(this.video.width=this.targetWidth,this.video.height=this.targetHeight):(this.canvasBuffer.width=this.targetWidth,this.canvasBuffer.height=this.targetHeight,this.yuvCanvas=new a.a({canvas:this.canvasBuffer,width:this.targetWidth,height:this.targetHeight}))}},{key:"onFrameReceived",value:function(t){var e=new Uint8Array(t);if(this.mediaSource)if(!this.sourceBuffer||this.sourceBuffer.updating||this.queue.length>0||"open"!=this.mediaSource.readyState)this.queue.push(e);else try{this.sourceBuffer.appendBuffer(e)}catch(t){"QuotaExceededError"===t.name?console.error("sourceBuffer QuotaExceeded"):console.error("Error occured while appending sourceBuffer -  ".concat(t.name,": ").concat(t.message))}else this.decoder.decode(e)}},{key:"onFrameDecoded",value:function(t,e,n){this.lastFrame={buffer:t,width:e,height:n}}},{key:"renderFrame",value:function(){var t=this;if(this.lastFrame){var e=this.lastFrame.buffer,n=this.lastFrame.width,r=this.lastFrame.height,i=n*r,o=n/2*(r/2);this.yuvCanvas.drawNextOutputPicture({yData:e.subarray(0,i),uData:e.subarray(i,i+o),vData:e.subarray(i+o,i+o+o)}),this.cachedFrame=this.lastFrame,this.lastFrame=null}this.canvasContext&&(this.adjustCanvasSize(),this.notifier.emit("onFramePreRender"),this.canvasContext.drawImage(this.canvasBuffer||this.video,0,0,this.renderWidth||this.canvasContext.canvas.clientWidth,this.renderHeight||this.canvasContext.canvas.clientHeight),this.notifier.emit("onFrameRendered"),this.notifier.emit("onFramePostRender")),window.requestAnimationFrame((function(){return t.renderFrame()}))}},{key:"adjustCanvasSize",value:function(){if(!this.video||this.video.videoWidth==this.targetWidth&&this.video.videoHeight==this.targetHeight||(this.targetWidth=this.video.videoWidth,this.targetHeight=this.video.videoHeight,this.video.width=this.targetWidth,this.video.height=this.targetHeight),this.fitVideoInCanvas&&this.video){var t=this.canvasContext.canvas.clientWidth,e=this.canvasContext.canvas.clientHeight,n=this.targetWidth/this.targetHeight,r=t/e;this.canvasContext.canvas.width=t,this.canvasContext.canvas.height=e,t>e&&r<n||e>t?(this.renderWidth=t,this.renderHeight=Math.floor(t/n)):(this.renderWidth=Math.floor(e*n),this.renderHeight=e)}else this.canvasContext.canvas.width==this.targetWidth&&this.canvasContext.canvas.height==this.targetHeight||(this.canvasContext.canvas.width=this.targetWidth,this.canvasContext.canvas.height=this.targetHeight,this.notifier.emit("onCanvasResized",this.targetWidth,this.targetHeight))}}])&&c(e.prototype,n),r&&c(e,r),t}()},function(t,e,n){(function(r){var i,o,a;function s(t){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}n(38),n(39),n(57),n(90),n(191),n(192),n(193),n(194),n(197),n(198),n(154),n(199),n(200),n(201),n(202),n(203),n(204),n(166),n(122),n(85),n(86),o=[],void 0===(a="function"==typeof(i=function(){var e;!function(){(e=this)||("undefined"!=typeof window?e=window:"undefined"!=typeof self&&(e=self))}();var n="https://3dverse.com/api/avc.wasm",i=function(i,o){var a,u=void 0!==u?u:{},c={};for(a in u)u.hasOwnProperty(a)&&(c[a]=u[a]);u.arguments=[],u.thisProgram="./this.program",u.quit=function(t,e){throw e},u.preRun=[],u.postRun=[];var h,f,l=!1,p=!1,d=!1,v=!1;if(u.ENVIRONMENT)if("WEB"===u.ENVIRONMENT)l=!0;else if("WORKER"===u.ENVIRONMENT)p=!0;else if("NODE"===u.ENVIRONMENT)d=!0;else{if("SHELL"!==u.ENVIRONMENT)throw new Error("Module['ENVIRONMENT'] value is not valid. must be one of: WEB|WORKER|NODE|SHELL.");v=!0}else l="object"===("undefined"==typeof window?"undefined":s(window)),p="function"==typeof importScripts,d="object"===(void 0===r?"undefined":s(r))&&!1,v=!l&&!d&&!p;if(d)u.read=function(t,e){var n;return h||(h=null("fs")),f||(f=null("path")),t=f.normalize(t),n=h.readFileSync(t),e?n:n.toString()},u.readBinary=function(t){var e=u.read(t,!0);return e.buffer||(e=new Uint8Array(e)),_(e.buffer),e},r.argv.length>1&&(u.thisProgram=r.argv[1].replace(/\\/g,"/")),u.arguments=r.argv.slice(2),t.exports=u,r.on("uncaughtException",(function(t){if(!(t instanceof Rt))throw t})),r.on("unhandledRejection",(function(t,e){r.exit(1)})),u.inspect=function(){return"[Emscripten Module object]"};else if(v)"undefined"!=typeof read&&(u.read=function(t){return read(t)}),u.readBinary=function(t){var e;return"function"==typeof readbuffer?new Uint8Array(readbuffer(t)):(_("object"===s(e=read(t,"binary"))),e)},"undefined"!=typeof scriptArgs?u.arguments=scriptArgs:void 0!==arguments&&(u.arguments=arguments),"function"==typeof quit&&(u.quit=function(t,e){quit(t)});else{if(!l&&!p)throw new Error("not compiled for this environment");u.read=function(t){var e=new XMLHttpRequest;return e.open("GET",t,!1),e.send(null),e.responseText},p&&(u.readBinary=function(t){var e=new XMLHttpRequest;return e.open("GET",t,!1),e.responseType="arraybuffer",e.send(null),new Uint8Array(e.response)}),u.readAsync=function(t,e,n){var r=new XMLHttpRequest;r.open("GET",t,!0),r.responseType="arraybuffer",r.onload=function(){200==r.status||0==r.status&&r.response?e(r.response):n()},r.onerror=n,r.send(null)},u.setWindowTitle=function(t){document.title=t}}for(a in u.print="undefined"!=typeof console?console.log.bind(console):"undefined"!=typeof print?print:null,u.printErr="undefined"!=typeof printErr?printErr:"undefined"!=typeof console&&console.warn.bind(console)||u.print,u.print=u.print,u.printErr=u.printErr,c)c.hasOwnProperty(a)&&(u[a]=c[a]);c=void 0;var y=16;function m(t){_(!U);var e=M;return M=M+t+15&-16,e}function g(t,e){return e||(e=y),t=Math.ceil(t/e)*e}var w={"f64-rem":function(t,e){return t%e},debugger:function(){}},b=(new Array(0),1024),E=0;function _(t,e){t||Mt("Assertion failed: "+e)}function A(t,e){if(0===e||!t)return"";for(var n,r=0,i=0;r|=n=C[t+i>>0],(0!=n||e)&&(i++,!e||i!=e););e||(e=i);var o="";if(r<128){for(var a;e>0;)a=String.fromCharCode.apply(String,C.subarray(t,t+Math.min(e,1024))),o=o?o+a:a,t+=1024,e-=1024;return o}return T(t)}var x="undefined"!=typeof TextDecoder?new TextDecoder("utf8"):void 0;function k(t,e){for(var n=e;t[n];)++n;if(n-e>16&&t.subarray&&x)return x.decode(t.subarray(e,n));for(var r,i,o,a,s,u="";;){if(!(r=t[e++]))return u;if(128&r)if(i=63&t[e++],192!=(224&r))if(o=63&t[e++],224==(240&r)?r=(15&r)<<12|i<<6|o:(a=63&t[e++],240==(248&r)?r=(7&r)<<18|i<<12|o<<6|a:(s=63&t[e++],r=248==(252&r)?(3&r)<<24|i<<18|o<<12|a<<6|s:(1&r)<<30|i<<24|o<<18|a<<12|s<<6|63&t[e++])),r<65536)u+=String.fromCharCode(r);else{var c=r-65536;u+=String.fromCharCode(55296|c>>10,56320|1023&c)}else u+=String.fromCharCode((31&r)<<6|i);else u+=String.fromCharCode(r)}}function T(t){return k(C,t)}"undefined"!=typeof TextDecoder&&new TextDecoder("utf-16le");var S,C,R,P,I,M,U,O,D,L,N,F=65536,B=16777216;function V(t,e){return t%e>0&&(t+=e-t%e),t}function j(t){u.buffer=S=t}function Y(){u.HEAP8=new Int8Array(S),u.HEAP16=R=new Int16Array(S),u.HEAP32=P=new Int32Array(S),u.HEAPU8=C=new Uint8Array(S),u.HEAPU16=new Uint16Array(S),u.HEAPU32=new Uint32Array(S),u.HEAPF32=new Float32Array(S),u.HEAPF64=new Float64Array(S)}function G(){Mt("Cannot enlarge memory arrays. Either (1) compile with  -s TOTAL_MEMORY=X  with X higher than the current value "+z+", (2) compile with  -s ALLOW_MEMORY_GROWTH=1  which allows increasing the size at runtime, or (3) if you want malloc to return NULL (0) instead of this abort, compile with  -s ABORTING_MALLOC=0 ")}function W(){G()}I=M=O=D=L=N=0,U=!1;var q=u.TOTAL_STACK||5242880,z=u.TOTAL_MEMORY||52428800;function X(){return z}if(z<q&&u.printErr("TOTAL_MEMORY should be larger than TOTAL_STACK, was "+z+"! (TOTAL_STACK="+q+")"),u.buffer?S=u.buffer:("object"===("undefined"==typeof WebAssembly?"undefined":s(WebAssembly))&&"function"==typeof WebAssembly.Memory?(u.wasmMemory=new WebAssembly.Memory({initial:z/F,maximum:z/F}),S=u.wasmMemory.buffer):S=new ArrayBuffer(z),u.buffer=S),Y(),P[0]=1668509029,R[1]=25459,115!==C[2]||99!==C[3])throw"Runtime error: expected the system to be little-endian!";function H(t){for(;t.length>0;){var e=t.shift();if("function"!=typeof e){var n=e.func;"number"==typeof n?void 0===e.arg?u.dynCall_v(n):u.dynCall_vi(n,e.arg):n(void 0===e.arg?null:e.arg)}else e()}}var K=[],J=[],Q=[],$=[],Z=[],tt=!1;function et(){if(u.preRun)for("function"==typeof u.preRun&&(u.preRun=[u.preRun]);u.preRun.length;)at(u.preRun.shift());H(K)}function nt(){tt||(tt=!0,H(J))}function rt(){H(Q)}function it(){H($)}function ot(){if(u.postRun)for("function"==typeof u.postRun&&(u.postRun=[u.postRun]);u.postRun.length;)st(u.postRun.shift());H(Z)}function at(t){K.unshift(t)}function st(t){Z.unshift(t)}Math.abs,Math.cos,Math.sin,Math.tan,Math.acos,Math.asin,Math.atan,Math.atan2,Math.exp,Math.log,Math.sqrt,Math.ceil,Math.floor,Math.pow,Math.imul,Math.fround,Math.round,Math.min,Math.max,Math.clz32,Math.trunc;var ut=0,ct=null,ht=null;function ft(t){ut++,u.monitorRunDependencies&&u.monitorRunDependencies(ut)}function lt(t){if(ut--,u.monitorRunDependencies&&u.monitorRunDependencies(ut),0==ut&&(null!==ct&&(clearInterval(ct),ct=null),ht)){var e=ht;ht=null,e()}}u.preloadedImages={},u.preloadedAudios={};var pt="data:application/octet-stream;base64,";function dt(t){return String.prototype.startsWith?t.startsWith(pt):0===t.indexOf(pt)}function vt(){var t="avc.wast",e="avc.temp.asm.js";"function"==typeof u.locateFile&&(dt(t)||(t=u.locateFile(t)),dt(n)||(n=u.locateFile(n)),dt(e)||(e=u.locateFile(e)));var r={global:null,env:null,asm2wasm:w,parent:u},i=null;function o(){try{if(u.wasmBinary)return new Uint8Array(u.wasmBinary);if(u.readBinary)return u.readBinary(n);throw"on the web, we need the wasm binary to be preloaded and set on Module['wasmBinary']. emcc.py will do that for you when generating HTML (but not JS)"}catch(t){Mt(t)}}function a(t,e,a){if("object"!==("undefined"==typeof WebAssembly?"undefined":s(WebAssembly)))return u.printErr("no native wasm support detected"),!1;if(!(u.wasmMemory instanceof WebAssembly.Memory))return u.printErr("no native wasm Memory in use"),!1;function c(t,e){(i=t.exports).memory&&function(t){var e=u.buffer;t.byteLength<e.byteLength&&u.printErr("the new buffer in mergeMemory is smaller than the previous one. in native wasm, we should grow memory here");var n=new Int8Array(e);new Int8Array(t).set(n),j(t),Y()}(i.memory),u.asm=i,u.usingWasm=!0,lt()}if(e.memory=u.wasmMemory,r.global={NaN:NaN,Infinity:1/0},r["global.Math"]=Math,r.env=e,ft(),u.instantiateWasm)try{return u.instantiateWasm(r,c)}catch(t){return u.printErr("Module.instantiateWasm callback failed with error: "+t),!1}function h(t){c(t.instance,t.module)}function f(t){(u.wasmBinary||!l&&!p||"function"!=typeof fetch?new Promise((function(t,e){t(o())})):fetch(n,{}).then((function(t){if(!t.ok)throw"failed to load wasm binary file at '"+n+"'";return t.arrayBuffer()})).catch((function(){return o()}))).then((function(t){return WebAssembly.instantiate(t,r)})).then(t).catch((function(t){u.printErr("failed to asynchronously prepare wasm: "+t),Mt(t)}))}return u.wasmBinary||"function"!=typeof WebAssembly.instantiateStreaming||dt(n)||"function"!=typeof fetch?f(h):WebAssembly.instantiateStreaming(fetch(n,{}),r).then(h).catch((function(t){u.printErr("wasm streaming compile failed: "+t),u.printErr("falling back to ArrayBuffer instantiation"),f(h)})),{}}u.asmPreload=u.asm;var c=u.reallocBuffer;u.reallocBuffer=function(t){return"asmjs"===h?c(t):function(t){t=V(t,u.usingWasm?F:B);var e=u.buffer.byteLength;if(u.usingWasm)try{return-1!==u.wasmMemory.grow((t-e)/65536)?u.buffer=u.wasmMemory.buffer:null}catch(t){return null}}(t)};var h="";u.asm=function(t,e,n){if(!(e=e).table){var r=u.wasmTableSize;void 0===r&&(r=1024);var i=u.wasmMaxTableSize;"object"===("undefined"==typeof WebAssembly?"undefined":s(WebAssembly))&&"function"==typeof WebAssembly.Table?e.table=void 0!==i?new WebAssembly.Table({initial:r,maximum:i,element:"anyfunc"}):new WebAssembly.Table({initial:r,element:"anyfunc"}):e.table=new Array(r),u.wasmTable=e.table}var o;return e.memoryBase||(e.memoryBase=u.STATIC_BASE),e.tableBase||(e.tableBase=0),_(o=a(0,e),"no binaryen method succeeded."),o}}vt(),M=(I=b)+9888,J.push();var yt=9888;u.STATIC_BASE=I,u.STATIC_BUMP=yt,M+=16;var mt={varargs:0,get:function(t){return mt.varargs+=4,P[mt.varargs-4>>2]},getStr:function(){return A(mt.get())},get64:function(){var t=mt.get(),e=mt.get();return _(t>=0?0===e:-1===e),t},getZero:function(){_(0===mt.get())}};function gt(t,e){mt.varargs=e;try{var n=mt.getStreamFromFD(),r=(mt.get(),mt.get()),i=mt.get(),o=mt.get(),a=r;return FS.llseek(n,a,o),P[i>>2]=n.position,n.getdents&&0===a&&0===o&&(n.getdents=null),0}catch(t){return"undefined"!=typeof FS&&t instanceof FS.ErrnoError||Mt(t),-t.errno}}function wt(t,e){mt.varargs=e;try{var n=mt.get(),r=mt.get(),i=mt.get(),o=0;wt.buffers||(wt.buffers=[null,[],[]],wt.printChar=function(t,e){var n=wt.buffers[t];_(n),0===e||10===e?((1===t?u.print:u.printErr)(k(n,0)),n.length=0):n.push(e)});for(var a=0;a<i;a++){for(var s=P[r+8*a>>2],c=P[r+(8*a+4)>>2],h=0;h<c;h++)wt.printChar(n,C[s+h]);o+=c}return o}catch(t){return"undefined"!=typeof FS&&t instanceof FS.ErrnoError||Mt(t),-t.errno}}function bt(t,e){mt.varargs=e;try{return 0}catch(t){return"undefined"!=typeof FS&&t instanceof FS.ErrnoError||Mt(t),-t.errno}}function Et(t,e){mt.varargs=e;try{var n=mt.getStreamFromFD();return FS.close(n),0}catch(t){return"undefined"!=typeof FS&&t instanceof FS.ErrnoError||Mt(t),-t.errno}}function _t(){i()}function At(t,e,n){o(t,e,n)}function xt(t,e,n){return C.set(C.subarray(e,e+n),t),t}function kt(t){return u.___errno_location&&(P[u.___errno_location()>>2]=t),t}u._broadwayOnHeadersDecoded=_t,u._broadwayOnPictureDecoded=At,N=m(4),O=D=g(M),L=g(O+q),P[N>>2]=L,U=!0,u.wasmTableSize=10,u.wasmMaxTableSize=10,u.asmGlobalArg={},u.asmLibraryArg={abort:Mt,enlargeMemory:W,getTotalMemory:X,abortOnCannotGrowMemory:G,___setErrNo:kt,___syscall140:gt,___syscall146:wt,___syscall54:bt,___syscall6:Et,_broadwayOnHeadersDecoded:_t,_broadwayOnPictureDecoded:At,_emscripten_memcpy_big:xt,DYNAMICTOP_PTR:N,STACKTOP:D};var Tt,St,Ct=u.asm(u.asmGlobalArg,u.asmLibraryArg,S);function Rt(t){this.name="ExitStatus",this.message="Program terminated with exit("+t+")",this.status=t}function Pt(t){function e(){u.calledRun||(u.calledRun=!0,E||(nt(),rt(),u.onRuntimeInitialized&&u.onRuntimeInitialized(),ot()))}t=t||u.arguments,ut>0||(et(),ut>0||u.calledRun||(u.setStatus?(u.setStatus("Running..."),setTimeout((function(){setTimeout((function(){u.setStatus("")}),1),e()}),1)):e()))}function It(t,e){e&&u.noExitRuntime&&0===t||(u.noExitRuntime||(E=!0,D=Tt,it(),u.onExit&&u.onExit(t)),d&&r.exit(t),u.quit(t,new Rt(t)))}function Mt(t){throw u.onAbort&&u.onAbort(t),void 0!==t?(u.print(t),u.printErr(t),t=JSON.stringify(t)):t="",E=!0,"abort("+t+"). Build with -s ASSERTIONS=1 for more info."}if(u.asm=Ct,u._broadwayCreateStream=function(){return u.asm._broadwayCreateStream.apply(null,arguments)},u._broadwayExit=function(){return u.asm._broadwayExit.apply(null,arguments)},u._broadwayGetMajorVersion=function(){return u.asm._broadwayGetMajorVersion.apply(null,arguments)},u._broadwayGetMinorVersion=function(){return u.asm._broadwayGetMinorVersion.apply(null,arguments)},u._broadwayInit=function(){return u.asm._broadwayInit.apply(null,arguments)},u._broadwayPlayStream=function(){return u.asm._broadwayPlayStream.apply(null,arguments)},u.asm=Ct,Rt.prototype=new Error,Rt.prototype.constructor=Rt,ht=function t(){u.calledRun||Pt(),u.calledRun||(ht=t)},u.run=Pt,u.exit=It,u.abort=Mt,u.preInit)for("function"==typeof u.preInit&&(u.preInit=[u.preInit]);u.preInit.length>0;)u.preInit.pop()();u.noExitRuntime=!0,Pt(),void 0!==e&&e.Module&&(St=e.Module),void 0!==u&&(St=u),St._broadwayOnHeadersDecoded=i,St._broadwayOnPictureDecoded=o;var Ut,Ot=!1,Dt=function(){Ot=!0,Ut&&Ut(St)};return St.onRuntimeInitialized=function(){Dt(St)},function(t){Ot?t(St):Ut=t}};return function(){"use strict";var t=function(){return(new Date).getTime()};"undefined"!=typeof performance&&performance.now&&(t=function(){return performance.now()});var n=function(e){var n;this.options=e||{},this.now=t;var r,a,s=function(e,i,a){var s,u=this.pictureBuffers[e];u||(u=this.pictureBuffers[e]=r(e,i*a*3/2));var c=!1;if(this.infoAr.length&&(c=!0,s=this.infoAr),this.infoAr=[],this.options.rgb){n||(n=o(i,a)),n.inp.set(u),n.doit();var h=new Uint8Array(n.outSize);return h.set(n.out),c&&(s[0].finishDecoding=t()),void this.onPictureDecoded(h,i,a,s)}c&&(s[0].finishDecoding=t()),this.onPictureDecoded(u,i,a,s)}.bind(this);this.options.sliceMode&&(s=function(e,n,i,o){var s=this.pictureBuffers[e];s||(s=this.pictureBuffers[e]=r(e,n*i*3/2));var u,c=this.pictureBuffers[o];c||(c=this.pictureBuffers[o]=a(o,18)),this.infoAr.length&&(u=this.infoAr),this.infoAr=[],u[0].finishDecoding=t();for(var h=[],f=0;f<20;++f)h.push(c[f]);u[0].sliceInfoAr=h,this.onPictureDecoded(s,n,i,u)}.bind(this));var u=i.apply({},[function(){},s]),c=this;this.onPictureDecoded=function(t,e,n,r){},this.onDecoderReady=function(){};var h=[];this.decode=function(t,e,n){h.push([t,e,n])},u((function(e){e.HEAP8;var n=e.HEAPU8;e.HEAP16,e.HEAP32,e._broadwayInit(),r=function(t,e){return n.subarray(t,t+e)},a=function(t,e){return new Uint32Array(n.buffer,t,e)},c.streamBuffer=r(e._broadwayCreateStream(1048576),1048576),c.pictureBuffers={},c.infoAr=[];var i=0;if(c.options.sliceMode?(i=c.options.sliceNum,c.decode=function(n,r,o){c.infoAr.push(r),r.startDecoding=t();var a,s=r.nals;if(!s){s=[],r.nals=s;var u=n.length,h=!1,f=0,l=0;for(a=0;a<u;++a)if(1===n[a]&&0===n[a-1]&&0===n[a-2]){var p=a-2;0===n[a-3]&&(p=a-3),h&&s.push({offset:f,end:p,type:31&n[l]}),f=p,l=p+3,0===n[a-3]&&(l=p+4),h=!0}h&&s.push({offset:f,end:a,type:31&n[l]})}var d,v=0,y=0;for(a=0;a<s.length;++a)1===s[a].type||5===s[a].type?(v===i&&(d=n.subarray(s[a].offset,s[a].end),c.streamBuffer[y]=0,y+=1,c.streamBuffer.set(d,y),y+=d.length),v+=1):(d=n.subarray(s[a].offset,s[a].end),c.streamBuffer[y]=0,y+=1,c.streamBuffer.set(d,y),y+=d.length,e._broadwayPlayStream(y),y=0);o(),e._broadwayPlayStream(y)}):c.decode=function(n,r){r&&(c.infoAr.push(r),r.startDecoding=t()),c.streamBuffer.set(n),e._broadwayPlayStream(n.length)},h.length){var o=0;for(o=0;o<h.length;++o)c.decode(h[o][0],h[o][1],h[o][2]);h=[]}c.onDecoderReady(c)}))};n.prototype={};var r={},o=function(t,n){var i=t+"x"+n;if(r[i])return r[i];for(var o=t*n,a=(0|o)>>2,s=o+a+a,u=t*n*4,c=s+u+4*Math.pow(2,24),h=Math.pow(2,24),f=h;f<c;)f+=h;var l=new ArrayBuffer(f),p=function(t,e,n){"use asm";var r=t.Math.imul,i=t.Math.min,o=t.Math.max,a=t.Math.pow,s=new t.Uint8Array(n),u=new t.Uint32Array(n),c=new t.Uint8Array(n),h=new t.Uint8Array(n),f=new t.Uint32Array(n),l=0,p=0,d=0,v=0,y=0,m=0,g=0,w=0,b=0,E=0;function _(t,e){t=t|0;e=e|0;var n=0;var i=0;l=t;b=r(t,4)|0;p=e;d=r(l|0,p|0)|0;v=(d|0)>>2;m=r(r(l,p)|0,4)|0;y=d+v|0+v|0;w=0;g=w+m|0;E=g+y|0;i=~~+a(+2,+24);i=r(i,4)|0;for(n=0|0;(n|0)<(i|0)|0;n=n+4|0){f[(E+n|0)>>2]=0}}function A(){var t=0;var e=0;var n=0;var r=0;var i=0;var o=0;var a=0;var s=0;var u=0;var h=0;var y=0;var m=0;var _=0;var A=0;_=w|0;t=g|0;e=t+d|0|0;n=e+v|0;for(u=0;(u|0)<(p|0);u=u+2|0){y=e;m=n;for(h=0;(h|0)<(l|0);h=h+2|0){r=c[t>>0]|0;i=c[(t+l|0)>>0]|0;o=c[e>>0]|0;a=c[n>>0]|0;A=((r<<16|0)+(o<<8|0)|0)+a|0;s=f[(E+A|0)>>2]|0;if(s){}else{s=x(r,o,a)|0;f[(E+A|0)>>2]=s|0}f[_>>2]=s;A=((i<<16|0)+(o<<8|0)|0)+a|0;s=f[(E+A|0)>>2]|0;if(s){}else{s=x(i,o,a)|0;f[(E+A|0)>>2]=s|0}f[(_+b|0)>>2]=s;_=_+4|0;t=t+1|0;r=c[t>>0]|0;i=c[(t+l|0)>>0]|0;A=((r<<16|0)+(o<<8|0)|0)+a|0;s=f[(E+A|0)>>2]|0;if(s){}else{s=x(r,o,a)|0;f[(E+A|0)>>2]=s|0}f[_>>2]=s;A=((i<<16|0)+(o<<8|0)|0)+a|0;s=f[(E+A|0)>>2]|0;if(s){}else{s=x(i,o,a)|0;f[(E+A|0)>>2]=s|0}f[(_+b|0)>>2]=s;_=_+4|0;t=t+1|0;e=e+1|0;n=n+1|0}_=_+b|0;t=t+l|0}}function x(t,e,n){t=t|0;e=e|0;n=n|0;var a=0;var s=0;var u=0;var c=0;var h=0;var f=0;var l=0;var p=0;var d=0;h=r(1192,t-16|0)|0;f=r(1634,n-128|0)|0;l=r(832,n-128|0)|0;p=r(400,e-128|0)|0;d=r(2066,e-128|0)|0;a=(h+f|0)>>10|0;s=((h-l|0)-p|0)>>10|0;u=(h+d|0)>>10|0;if((a&255|0)!=(a|0)|0){a=i(255,o(0,a|0)|0)|0}if((s&255|0)!=(s|0)|0){s=i(255,o(0,s|0)|0)|0}if((u&255|0)!=(u|0)|0){u=i(255,o(0,u|0)|0)|0}c=255;c=c<<8|0;c=c+u|0;c=c<<8|0;c=c+s|0;c=c<<8|0;c=c+a|0;return c|0}return{init:_,doit:A}}(e,{},l);return p.init(t,n),r[i]=p,p.heap=l,p.out=new Uint8Array(l,0,u),p.inp=new Uint8Array(l,u,s),p.outSize=u,p};if("undefined"!=typeof self){var a,s,u,c,h,f,l=!1,p=!1,d=!1,v=0,y=0,m=0,g=0,w=[],b=[],E=function(t){if(b.length){for(var e=b.shift();e&&e.byteLength!==t;)e=b.shift();if(e)return e}return new ArrayBuffer(t)},_=function(t,e,n,r,i){var o=function(n,i){var o=0;for(o=0;o<16;++o){var a=n+r*o,s=i+r*o;e.set(t.subarray(a,s),a)}},a=function(n,i){var o=0;for(o=0;o<8;++o){var a=n+r/2*o,s=i+r/2*o;e.set(t.subarray(a,s),a)}},s=function(n,r){e.set(t.subarray(n,r),n)},u=n[0],c=n[1];c>0&&(o(u,c),a(n[2],n[3]),a(n[4],n[5])),u=n[6],(c=n[7])>0&&(o(u,c),a(n[8],n[9]),a(n[10],n[11])),u=n[12],(c=n[15])>0&&(s(u,c),s(n[13],n[16]),s(n[14],n[17]))},A=function(t){m=(y=t)-1};self.addEventListener("message",(function(e){if(l){if(p&&e.data.reuse&&b.push(e.data.reuse),e.data.buf)return void(d&&0!==g?w.push(e.data):a.decode(new Uint8Array(e.data.buf,e.data.offset||0,e.data.length),e.data.info,(function(){d&&v!==m&&postMessage(e.data,[e.data.buf])})));if(e.data.slice){var r=t();if(_(new Uint8Array(e.data.slice),u,e.data.infos[0].sliceInfoAr,e.data.width,e.data.height),e.data.theOne&&(_(u,new Uint8Array(e.data.slice),s,e.data.width,e.data.height),f>e.data.infos[0].timeDecoding&&(e.data.infos[0].timeDecoding=f),e.data.infos[0].timeCopy+=t()-r),postMessage(e.data,[e.data.slice]),0==(g-=1)&&w.length){var i=w.shift();a.decode(new Uint8Array(i.buf,i.offset||0,i.length),i.info,(function(){d&&v!==m&&postMessage(i,[i.buf])}))}return}if(e.data.setSliceCnt)return void A(e.data.sliceCnt)}else e.data&&"Broadway.js - Worker init"===e.data.type&&(l=!0,a=new n(e.data.options),e.data.options.sliceMode?(p=!0,d=!0,v=e.data.options.sliceNum,A(e.data.options.sliceCnt),a.onPictureDecoded=function(t,e,n,r){var i=new Uint8Array(E(t.length));_(t,i,r[0].sliceInfoAr,e),c=r[0].startDecoding,h=r[0].finishDecoding,f=h-c,r[0].timeDecoding=f,r[0].timeCopy=0,postMessage({slice:i.buffer,sliceNum:v,width:e,height:n,infos:r},[i.buffer]),g=y-1,u=t,s=r[0].sliceInfoAr}):e.data.options.reuseMemory?(p=!0,a.onPictureDecoded=function(t,e,n,r){var i=new Uint8Array(E(t.length));i.set(t,0,t.length),postMessage({buf:i.buffer,length:t.length,width:e,height:n,infos:r},[i.buffer])}):a.onPictureDecoded=function(t,e,n,r){t&&(t=new Uint8Array(t));var i=new Uint8Array(t.length);i.set(t,0,t.length),postMessage({buf:i.buffer,length:t.length,width:e,height:n,infos:r},[i.buffer])},postMessage({consoleLog:"broadway worker initialized"}))}),!1)}return n.nowValue=t,n}()})?i.apply(e,o):i)||(t.exports=a)}).call(this,n(190))},function(t,e,n){var r,i,o;n(38),n(39),n(154),i=[],void 0===(o="function"==typeof(r=function(){function t(t){t=t||{},this.canvasElement=t.canvas||document.createElement("canvas"),this.contextOptions=t.contextOptions,this.type=t.type||"yuv420",this.customYUV444=t.customYUV444,this.conversionType=t.conversionType||"rec601",this.width=t.width||640,this.height=t.height||320,this.animationTime=t.animationTime||0,this.canvasElement.width=this.width,this.canvasElement.height=this.height,this.initContextGL(),this.contextGL&&(this.initProgram(),this.initBuffers(),this.initTextures()),"yuv420"===this.type?this.drawNextOuptutPictureGL=function(t){var e=this.contextGL,n=this.texturePosBuffer,r=this.uTexturePosBuffer,i=this.vTexturePosBuffer,o=this.yTextureRef,a=this.uTextureRef,s=this.vTextureRef,u=t.yData,c=t.uData,h=t.vData,f=this.width,l=this.height,p=t.yDataPerRow||f,d=t.yRowCnt||l,v=t.uDataPerRow||f/2,y=t.uRowCnt||l/2,m=t.vDataPerRow||v,g=t.vRowCnt||y;e.viewport(0,0,f,l);var w=l/d,b=f/p,E=new Float32Array([b,0,0,0,b,w,0,w]);e.bindBuffer(e.ARRAY_BUFFER,n),e.bufferData(e.ARRAY_BUFFER,E,e.DYNAMIC_DRAW),this.customYUV444?(w=l/y,b=f/v):(w=l/2/y,b=f/2/v);var _=new Float32Array([b,0,0,0,b,w,0,w]);e.bindBuffer(e.ARRAY_BUFFER,r),e.bufferData(e.ARRAY_BUFFER,_,e.DYNAMIC_DRAW),this.customYUV444?(w=l/g,b=f/m):(w=l/2/g,b=f/2/m);var A=new Float32Array([b,0,0,0,b,w,0,w]);e.bindBuffer(e.ARRAY_BUFFER,i),e.bufferData(e.ARRAY_BUFFER,A,e.DYNAMIC_DRAW),e.activeTexture(e.TEXTURE0),e.bindTexture(e.TEXTURE_2D,o),e.texImage2D(e.TEXTURE_2D,0,e.LUMINANCE,p,d,0,e.LUMINANCE,e.UNSIGNED_BYTE,u),e.activeTexture(e.TEXTURE1),e.bindTexture(e.TEXTURE_2D,a),e.texImage2D(e.TEXTURE_2D,0,e.LUMINANCE,v,y,0,e.LUMINANCE,e.UNSIGNED_BYTE,c),e.activeTexture(e.TEXTURE2),e.bindTexture(e.TEXTURE_2D,s),e.texImage2D(e.TEXTURE_2D,0,e.LUMINANCE,m,g,0,e.LUMINANCE,e.UNSIGNED_BYTE,h),e.drawArrays(e.TRIANGLE_STRIP,0,4)}:"yuv422"===this.type&&(this.drawNextOuptutPictureGL=function(t){var e=this.contextGL,n=this.texturePosBuffer,r=this.textureRef,i=t.data,o=this.width,a=this.height,s=t.dataPerRow||2*o,u=t.rowCnt||a;e.viewport(0,0,o,a);var c=a/u,h=o/(s/2),f=new Float32Array([h,0,0,0,h,c,0,c]);e.bindBuffer(e.ARRAY_BUFFER,n),e.bufferData(e.ARRAY_BUFFER,f,e.DYNAMIC_DRAW),e.uniform2f(e.getUniformLocation(this.shaderProgram,"resolution"),s,a),e.activeTexture(e.TEXTURE0),e.bindTexture(e.TEXTURE_2D,r),e.texImage2D(e.TEXTURE_2D,0,e.LUMINANCE,s,u,0,e.LUMINANCE,e.UNSIGNED_BYTE,i),e.drawArrays(e.TRIANGLE_STRIP,0,4)})}return t.prototype.isWebGL=function(){return this.contextGL},t.prototype.initContextGL=function(){for(var t=this.canvasElement,e=null,n=["webgl","experimental-webgl","moz-webgl","webkit-3d"],r=0;!e&&r<n.length;){var i=n[r];try{e=this.contextOptions?t.getContext(i,this.contextOptions):t.getContext(i)}catch(t){e=null}e&&"function"==typeof e.getParameter||(e=null),++r}this.contextGL=e},t.prototype.initProgram=function(){var t,e,n=this.contextGL;"yuv420"===this.type?(t=["attribute vec4 vertexPos;","attribute vec4 texturePos;","attribute vec4 uTexturePos;","attribute vec4 vTexturePos;","varying vec2 textureCoord;","varying vec2 uTextureCoord;","varying vec2 vTextureCoord;","void main()","{","  gl_Position = vertexPos;","  textureCoord = texturePos.xy;","  uTextureCoord = uTexturePos.xy;","  vTextureCoord = vTexturePos.xy;","}"].join("\n"),e=["precision highp float;","varying highp vec2 textureCoord;","varying highp vec2 uTextureCoord;","varying highp vec2 vTextureCoord;","uniform sampler2D ySampler;","uniform sampler2D uSampler;","uniform sampler2D vSampler;","uniform mat4 YUV2RGB;","void main(void) {","  highp float y = texture2D(ySampler,  textureCoord).r;","  highp float u = texture2D(uSampler,  uTextureCoord).r;","  highp float v = texture2D(vSampler,  vTextureCoord).r;","  gl_FragColor = vec4(y, u, v, 1) * YUV2RGB;","}"].join("\n")):"yuv422"===this.type&&(t=["attribute vec4 vertexPos;","attribute vec4 texturePos;","varying vec2 textureCoord;","void main()","{","  gl_Position = vertexPos;","  textureCoord = texturePos.xy;","}"].join("\n"),e=["precision highp float;","varying highp vec2 textureCoord;","uniform sampler2D sampler;","uniform highp vec2 resolution;","uniform mat4 YUV2RGB;","void main(void) {","  highp float texPixX = 1.0 / resolution.x;","  highp float logPixX = 2.0 / resolution.x;","  highp float logHalfPixX = 4.0 / resolution.x;","  highp float steps = floor(textureCoord.x / logPixX);","  highp float uvSteps = floor(textureCoord.x / logHalfPixX);","  highp float y = texture2D(sampler, vec2((logPixX * steps) + texPixX, textureCoord.y)).r;","  highp float u = texture2D(sampler, vec2((logHalfPixX * uvSteps), textureCoord.y)).r;","  highp float v = texture2D(sampler, vec2((logHalfPixX * uvSteps) + texPixX + texPixX, textureCoord.y)).r;","  gl_FragColor = vec4(y, u, v, 1.0) * YUV2RGB;","}"].join("\n"));var r=[];r="rec709"==this.conversionType?[1.16438,0,1.79274,-.97295,1.16438,-.21325,-.53291,.30148,1.16438,2.1124,0,-1.1334,0,0,0,1]:[1.16438,0,1.59603,-.87079,1.16438,-.39176,-.81297,.52959,1.16438,2.01723,0,-1.08139,0,0,0,1];var i=n.createShader(n.VERTEX_SHADER);n.shaderSource(i,t),n.compileShader(i),n.getShaderParameter(i,n.COMPILE_STATUS)||console.log("Vertex shader failed to compile: "+n.getShaderInfoLog(i));var o=n.createShader(n.FRAGMENT_SHADER);n.shaderSource(o,e),n.compileShader(o),n.getShaderParameter(o,n.COMPILE_STATUS)||console.log("Fragment shader failed to compile: "+n.getShaderInfoLog(o));var a=n.createProgram();n.attachShader(a,i),n.attachShader(a,o),n.linkProgram(a),n.getProgramParameter(a,n.LINK_STATUS)||console.log("Program failed to compile: "+n.getProgramInfoLog(a)),n.useProgram(a);var s=n.getUniformLocation(a,"YUV2RGB");n.uniformMatrix4fv(s,!1,r),this.shaderProgram=a},t.prototype.initBuffers=function(){var t=this.contextGL,e=this.shaderProgram,n=t.createBuffer();t.bindBuffer(t.ARRAY_BUFFER,n),t.bufferData(t.ARRAY_BUFFER,new Float32Array([1,1,-1,1,1,-1,-1,-1]),t.STATIC_DRAW);var r=t.getAttribLocation(e,"vertexPos");if(t.enableVertexAttribArray(r),t.vertexAttribPointer(r,2,t.FLOAT,!1,0,0),this.animationTime){var i=this.animationTime,o=0;!function n(){var r=1*(o+=15)/i;o>=i?r=1:setTimeout(n,15);var a=-1*r,s=1*r,u=t.createBuffer();t.bindBuffer(t.ARRAY_BUFFER,u),t.bufferData(t.ARRAY_BUFFER,new Float32Array([s,s,a,s,s,a,a,a]),t.STATIC_DRAW);var c=t.getAttribLocation(e,"vertexPos");t.enableVertexAttribArray(c),t.vertexAttribPointer(c,2,t.FLOAT,!1,0,0);try{t.drawArrays(t.TRIANGLE_STRIP,0,4)}catch(t){}}()}var a=t.createBuffer();t.bindBuffer(t.ARRAY_BUFFER,a),t.bufferData(t.ARRAY_BUFFER,new Float32Array([1,0,0,0,1,1,0,1]),t.STATIC_DRAW);var s=t.getAttribLocation(e,"texturePos");if(t.enableVertexAttribArray(s),t.vertexAttribPointer(s,2,t.FLOAT,!1,0,0),this.texturePosBuffer=a,"yuv420"===this.type){var u=t.createBuffer();t.bindBuffer(t.ARRAY_BUFFER,u),t.bufferData(t.ARRAY_BUFFER,new Float32Array([1,0,0,0,1,1,0,1]),t.STATIC_DRAW);var c=t.getAttribLocation(e,"uTexturePos");t.enableVertexAttribArray(c),t.vertexAttribPointer(c,2,t.FLOAT,!1,0,0),this.uTexturePosBuffer=u;var h=t.createBuffer();t.bindBuffer(t.ARRAY_BUFFER,h),t.bufferData(t.ARRAY_BUFFER,new Float32Array([1,0,0,0,1,1,0,1]),t.STATIC_DRAW);var f=t.getAttribLocation(e,"vTexturePos");t.enableVertexAttribArray(f),t.vertexAttribPointer(f,2,t.FLOAT,!1,0,0),this.vTexturePosBuffer=h}},t.prototype.initTextures=function(){var t=this.contextGL,e=this.shaderProgram;if("yuv420"===this.type){var n=this.initTexture(),r=t.getUniformLocation(e,"ySampler");t.uniform1i(r,0),this.yTextureRef=n;var i=this.initTexture(),o=t.getUniformLocation(e,"uSampler");t.uniform1i(o,1),this.uTextureRef=i;var a=this.initTexture(),s=t.getUniformLocation(e,"vSampler");t.uniform1i(s,2),this.vTextureRef=a}else if("yuv422"===this.type){var u=this.initTexture(),c=t.getUniformLocation(e,"sampler");t.uniform1i(c,0),this.textureRef=u}},t.prototype.initTexture=function(){var t=this.contextGL,e=t.createTexture();return t.bindTexture(t.TEXTURE_2D,e),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.NEAREST),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.NEAREST),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),t.bindTexture(t.TEXTURE_2D,null),e},t.prototype.drawNextOutputPicture=function(t,e,n,r){this.contextGL?this.drawNextOuptutPictureGL(t,e,n,r):this.drawNextOuptutPictureRGBA(t,e,n,r)},t.prototype.drawNextOuptutPictureRGBA=function(t,e,n,r){var i=r,o=this.canvasElement.getContext("2d"),a=o.getImageData(0,0,t,e);a.data.set(i),o.putImageData(a,0,0)},t})?r.apply(e,i):r)||(t.exports=o)},function(t,e,n){"use strict";n.d(e,"a",(function(){return a}));n(21),n(126),n(116),n(122);var r=n(14),i=n(123);function o(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var a=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.callbacks=[],this.stack=[],this.uuidBuffer=new Uint8Array(16)}var e,n,a;return e=t,(n=[{key:"setClientUUID",value:function(t){this.uuidBuffer=r.a.uuidToUint8Array(t)}},{key:"isEmpty",value:function(){return 0==this.stack.length}},{key:"pushInput",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];this.pushQuery(i.a.inputs,t,e,null,n)}},{key:"pushClientRemoteOperation",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];this.pushQuery(i.a.client_remote_operations,t,e,n,r)}},{key:"pushEditorRemoteOperation",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];this.pushQuery(i.a.editor_remote_operations,t,e,null,n)}},{key:"pushQuery",value:function(t,e,n,r,i){if(this.stack.length>100)console.warn("Message limit exceeded");else{var o=!1;if(i){var a=this.stack.findIndex((function(n){return t==n.channelID&&e==n.id}));-1!=a&&(this.stack[a].data=n,o=!0)}o||this.stack.push({channelID:t,id:e,data:n,callback:r})}}},{key:"pop",value:function(){var t=this.stack[0],e=t.channelID!=i.a.inputs,n=e?25:1,r=t.data?t.data.length:0,o=n+r,a=new ArrayBuffer(o+4),s=new DataView(a),u=0;if(s.setUint8(u++,t.channelID),s.setUint8(u++,255&o>>0),s.setUint8(u++,255&o>>8),s.setUint8(u++,255&o>>16),e){for(var c=0;c<16;c++)s.setUint8(u++,this.uuidBuffer[c]);s.setUint32(u,0,!0),u+=4,s.setUint32(u,r,!0),u+=4}if(s.setUint8(u++,t.id),t.data)for(var h=t.data,f=0;f<h.length;f++)s.setUint8(u++,h[f],!0);return t.callback&&this.callbacks.push(t.callback),this.stack.shift(),{task:t,isRemoteOperation:e,buffer:a}}},{key:"onTaskResponse",value:function(t){0!=this.callbacks.length?this.callbacks.shift()(t):console.warn("Task response received but callback stack is empty")}}])&&o(e.prototype,n),a&&o(e,a),t}()},function(t,e,n){"use strict";n.d(e,"a",(function(){return c}));n(38),n(39),n(21),n(126),n(122),n(40),n(35);var r=n(14),i=n(153),o=n.n(i);function a(t){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function s(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var u={MSG_UNKNOWN:0,MSG_LBUTTON_DOWN:1,MSG_MBUTTON_DOWN:2,MSG_RBUTTON_DOWN:3,MSG_LBUTTON_UP:4,MSG_MBUTTON_UP:5,MSG_RBUTTON_UP:6,MSG_MOUSEMOVE:7,MSG_ONKEYDOWN:8,MSG_ONKEYUP:9,MSG_RESIZE:10,MSG_DISCONNECTED:11,MSG_TOUCH_START:12,MSG_TOUCH_END:13,MSG_TOUCH_MOVE:14,MSG_TOUCH_PINCH_START:15,MSG_TOUCH_PINCH_MOVE:16,MSG_WINDOW_RESIZED:17,MSG_SET_CAMERA:18,MSG_WHEEL:22,MSG_GAMEPAD_AXIS:26,MSG_GAMEPAD_BUTTONS:27},c=function(){function t(e,n){var r=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.taskStack=e,this.hammer=null,this.keys={},this.lastClickX=0,this.lastClickY=0,this.controllerAxis=t.ControllerAxis,this.notifier=n,this.onFramePreRender=function(){return r.handleGamepadInputs()},this.previousGamepadsReading=[]}var e,n,i;return e=t,(n=[{key:"initialize",value:function(t){this.canvas=t,this.initializeListeners()}},{key:"initializeListeners",value:function(){var t=this;this.hammer&&this.hammer.destroy(),this.hammer=new o.a(this.canvas,{inputClass:o.a.SUPPORT_POINTER_EVENTS?o.a.PointerEventInput:o.a.TouchInput}),this.hammer.get("pinch").set({enable:!0}),this.hammer.on("panstart",(function(e){return t.OnPanStart(e)})),this.hammer.on("panend",(function(e){return t.OnPanEnd(e)})),this.hammer.on("pan",(function(e){return t.OnPan(e)})),this.hammer.on("pinchstart",(function(e){return t.OnPinchStart(e)})),this.hammer.on("pinchend",(function(e){return t.OnPinchEnd(e)})),this.hammer.on("pinch",(function(e){return t.OnPinch(e)})),this.inputListeners&&this.uninstallListeners(),this.inputListeners={mousedown:{element:this.canvas,callback:function(e){return t.OnMouseDown(e)},options:!1},mousemove:{element:window,callback:function(e){return t.OnMouseMove(e)},options:!1},mouseup:{element:window,callback:function(e){return t.OnMouseUp(e)},options:!1},mousewheel:{element:this.canvas,callback:function(e){return t.OnMouseWheel(e)},options:{passive:!0}},DOMMouseScroll:{element:this.canvas,callback:function(e){return t.OnMouseWheel(e)}},keydown:{element:this.canvas,callback:function(e){return t.OnKeyDown(e)},options:!1},keyup:{element:window,callback:function(e){return t.OnKeyUp(e)},options:!1},touchmove:{element:this.canvas,callback:function(t){return t.preventDefault()}}},this.installListeners()}},{key:"installListeners",value:function(){for(var t in this.inputListeners){var e=this.inputListeners[t];e.element.addEventListener(t,e.callback,e.options)}this.notifier.on("onFramePreRender",this.onFramePreRender)}},{key:"uninstallListeners",value:function(){for(var t in this.inputListeners){var e=this.inputListeners[t];e.element.removeEventListener(t,e.callback,!1)}this.notifier.off("onFramePreRender",this.onFramePreRender)}},{key:"OnKeyDown",value:function(t){if(!this.keys[t.keyCode]){var e=new Uint8Array(4);e[0]=255&t.keyCode,e[1]=t.keyCode>>8&255,e[2]=t.keyCode>>16&255,e[3]=t.keyCode>>24&255,this.keys[t.keyCode]={data:e}}this.keys[t.keyCode].down||this.taskStack.pushInput(u.MSG_ONKEYDOWN,this.keys[t.keyCode].data),this.keys[t.keyCode].down=!0}},{key:"OnKeyUp",value:function(t){this.keys[t.keyCode]&&(this.taskStack.pushInput(u.MSG_ONKEYUP,this.keys[t.keyCode].data),this.keys[t.keyCode].down=!1)}},{key:"OnMouseDown",value:function(t){this.canvas.focus();var e=r.a.fillMousePosBuffer(this.canvas,t.clientX,t.clientY),n=this.getTaskIDFromMouseEvent(t,!0);this.taskStack.pushInput(n,new Uint8Array(e)),this.lastClickX=t.clientX,this.lastClickY=t.clientY}},{key:"OnMouseUp",value:function(t){var e=r.a.fillMousePosBuffer(this.canvas,t.clientX,t.clientY),n=this.getTaskIDFromMouseEvent(t,!1);this.taskStack.pushInput(n,new Uint8Array(e))}},{key:"OnMouseMove",value:function(t){var e=r.a.fillMousePosBuffer(this.canvas,t.clientX,t.clientY);this.taskStack.pushInput(u.MSG_MOUSEMOVE,new Uint8Array(e),!0)}},{key:"OnMouseWheel",value:function(t){var e;e=t.wheelDelta?t.wheelDelta:-60*t.detail;var n=new Uint8Array(4);n[0]=255&e,n[1]=e>>8&255,n[2]=e>>16&255,n[3]=e>>24&255,this.taskStack.pushInput(u.MSG_WHEEL,n)}},{key:"OnPanStart",value:function(t){var e=r.a.fillMousePosBuffer(this.canvas,t.center.x,t.center.y);this.taskStack.pushInput(u.MSG_TOUCH_START,new Uint8Array(e))}},{key:"OnPanEnd",value:function(t){var e=r.a.fillMousePosBuffer(this.canvas,t.center.x,t.center.y);this.taskStack.pushInput(u.MSG_TOUCH_END,new Uint8Array(e))}},{key:"OnPan",value:function(t){var e=r.a.fillMousePosBuffer(this.canvas,t.center.x,t.center.y);this.taskStack.pushInput(u.MSG_TOUCH_MOVE,new Uint8Array(e))}},{key:"OnPinchStart",value:function(t){var e=r.a.fillPinchPosBuffer(this.canvas,t.center.x,t.center.y,t.center.x,t.center.y,this.canvas.width,this.canvas.height);this.taskStack.pushInput(u.MSG_TOUCH_PINCH_START,new Uint8Array(e))}},{key:"OnPinchEnd",value:function(t){var e=r.a.fillMousePosBuffer(this.canvas,t.center.x,t.center.y);this.taskStack.pushInput(u.MSG_TOUCH_END,new Uint8Array(e))}},{key:"OnPinch",value:function(t){var e=t.changedPointers[0],n=t.changedPointers[1];if(n){var i=r.a.fillPinchPosBuffer(this.canvas,n.clientX,n.clientY,e.clientX,e.clientY,this.canvas.width,this.canvas.height);this.taskStack.pushInput(u.MSG_TOUCH_PINCH_MOVE,new Uint8Array(i))}}},{key:"sendControllerAxis",value:function(t,e,n){var r=new ArrayBuffer(6),i=new DataView(r);i.setUint8(0,t),i.setUint8(1,e,!0),i.setFloat32(2,n,!0),this.taskStack.pushInput(u.MSG_GAMEPAD_AXIS,new Uint8Array(r))}},{key:"sendControllerButtons",value:function(t,e){var n=new ArrayBuffer(5),r=new DataView(n);r.setUint8(0,t),r.setUint16(1,e,!0),this.taskStack.pushInput(u.MSG_GAMEPAD_BUTTONS,new Uint8Array(n))}},{key:"getTaskIDFromMouseEvent",value:function(t,e){var n=e?"DOWN":"UP";switch(t.button){case 0:return u["MSG_LBUTTON_"+n];case 1:return u["MSG_MBUTTON_"+n];case 2:return u["MSG_RBUTTON_"+n]}console.log("Unhandled mouse event ",{event:t})}},{key:"handleGamepadInputs",value:function(){var t=function(){for(var t=navigator.getGamepads?navigator.getGamepads():navigator.webkitGetGamepads?navigator.webkitGetGamepads:[],e=[],n=0;n<t.length;++n){var r=t[n];r&&(e[r.index]=f(r))}return e}();for(var e in t){var n=this.previousGamepadsReading[e],r=t[e];n&&r&&this.sendControllerEvents(e,n,r),this.previousGamepadsReading[e]=r}}},{key:"sendControllerEvents",value:function(e,n,r){r.leftThumbstickX!=n.leftThumbstickX&&this.sendControllerAxis(e,t.ControllerAxis.LeftThumbstickX,r.leftThumbstickX),r.leftThumbstickY!=n.leftThumbstickY&&this.sendControllerAxis(e,t.ControllerAxis.LeftThumbstickY,r.leftThumbstickY),r.rightThumbstickX!=n.rightThumbstickX&&this.sendControllerAxis(e,t.ControllerAxis.RightThumbstickX,r.rightThumbstickX),r.rightThumbstickY!=n.rightThumbstickY&&this.sendControllerAxis(e,t.ControllerAxis.RightThumbstickY,r.rightThumbstickY),r.leftTrigger!=n.leftTrigger&&this.sendControllerAxis(e,t.ControllerAxis.LeftTrigger,r.leftTrigger),r.rightTrigger!=n.rightTrigger&&this.sendControllerAxis(e,t.ControllerAxis.RightTrigger,r.rightTrigger),r.buttons!=n.buttons&&this.sendControllerButtons(e,r.buttons)}}])&&s(e.prototype,n),i&&s(e,i),t}();c.ControllerAxis={LeftThumbstickX:0,LeftThumbstickY:1,RightThumbstickX:2,RightThumbstickY:3,LeftTrigger:4,RightTrigger:5};var h=[4,8,16,32,1024,2048,0,0,2,1,4096,8192,64,128,256,512];function f(t){return{buttons:l(t),leftTrigger:d(t.buttons[6]),rightTrigger:d(t.buttons[7]),leftThumbstickX:-t.axes[0],leftThumbstickY:t.axes[1],rightThumbstickX:-t.axes[2],rightThumbstickY:t.axes[3]}}function l(t){var e=0;for(var n in h){p(t.buttons[n])&&(e|=h[n])}return e}function p(t){return"object"==a(t)?t.pressed:1==t}function d(t){return"object"==a(t)?t.value:t}},function(t,e,n){"use strict";(function(t){n(95),n(92),n(21),n(210),n(55),n(56),n(116),n(149),n(90),n(38),n(39),n(57),n(97),n(96),n(75),n(103),n(40),n(35),n(148),n(85),n(86),n(62);var r=n(178),i=n(165),o=n(61),a=n(104),s=n(179),u=n(14),c=n(181),h=n.n(c),f=n(182),l=n.n(f);function p(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function d(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(t){return Object.getOwnPropertyDescriptor(n,t).enumerable})))),r.forEach((function(e){v(t,e,n[e])}))}return t}function v(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function y(t,e,n,r,i,o,a){try{var s=t[o](a),u=s.value}catch(t){return void n(t)}s.done?e(u):Promise.resolve(u).then(r,i)}function m(t){return function(){var e=this,n=arguments;return new Promise((function(r,i){var o=t.apply(e,n);function a(t){y(o,r,i,a,s,"next",t)}function s(t){y(o,r,i,a,s,"throw",t)}a(void 0)}))}}function g(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var w=function(){function e(t,n){var o=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),this.notifier=t,this.selectedEntities=[],this.ftlAPI=new i.a(n.taskStack),this.entityRegistry=new a.a((function(t){return o.resolveEntity(t)})),this.editorAPI=new r.a(this.notifier,this.entityRegistry),this.cameraAPI=new s.a(this.notifier,this,n),this.listenEditorEvents()}var n,c,f,v,y,w,b,E,_,A,x,k,T,S,C,R,P,I,M,U;return n=e,(c=[{key:"createEntity",value:(U=m(regeneratorRuntime.mark((function t(e,n){var r,i=arguments;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=i.length>2&&void 0!==i[2]?i[2]:0,t.next=3,this.requestEntityCreation(e,n,r,!1);case 3:return t.abrupt("return",t.sent);case 4:case"end":return t.stop()}}),t,this)}))),function(t,e){return U.apply(this,arguments)})},{key:"linkScene",value:(M=m(regeneratorRuntime.mark((function t(e,n,r){var i;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i={debug_name:{value:n}},SDK3DVerse.utils.resolveComponentDependencies(i,"scene_ref"),i.scene_ref={value:r},t.next=5,this.createEntity(e,i);case 5:return t.abrupt("return",t.sent);case 6:case"end":return t.stop()}}),t,this)}))),function(t,e,n){return M.apply(this,arguments)})},{key:"spawnEntity",value:(I=m(regeneratorRuntime.mark((function t(e,n){var r,i=arguments;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=i.length>2&&void 0!==i[2]?i[2]:0,t.next=3,this.requestEntityCreation(e,n,r,!0);case 3:return t.abrupt("return",t.sent);case 4:case"end":return t.stop()}}),t,this)}))),function(t,e){return I.apply(this,arguments)})},{key:"requestEntityCreation",value:(P=m(regeneratorRuntime.mark((function t(e,n,r,i){var o;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e?n.lineage={ancestors:[e.getEUID()],ordinal:r}:delete n.lineage,t.next=3,this.editorAPI.sendCreateEntityRequest(n,i);case 3:return o=t.sent,t.abrupt("return",o[0]);case 5:case"end":return t.stop()}}),t,this)}))),function(t,e,n,r){return P.apply(this,arguments)})},{key:"transientEntity",value:function(t){var e=h.a.v4(),n=u.a.generateRTID(e);return t.euid={value:e},this.ftlAPI.createEntity(t),t.euid.rtid=n,new o.a(this.entityRegistry,{rtid:n.toString(),components:t,children:[],isVisible:!0,isRuntime:!0,isExternal:!1,isTransient:!0})}},{key:"__transientEntity",value:function(t){return new o.a(this.entityRegistry,t)}},{key:"deleteEntities",value:function(t){var e=t.map((function(t){return t.getEUID()}));this.editorAPI.deleteEntities(e)}},{key:"overrideComponent",value:(R=m(regeneratorRuntime.mark((function t(e,n){var r,i;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:t.t0=regeneratorRuntime.keys(e);case 1:if((t.t1=t.t0()).done){t.next=8;break}return r=t.t1.value,i=e[r],t.next=6,this.setOrCreateOverrider(i,n,i.getComponent(n));case 6:t.next=1;break;case 8:this.commitChanges();case 9:case"end":return t.stop()}}),t,this)}))),function(t,e){return R.apply(this,arguments)})},{key:"discardOverriderComponent",value:function(t,e){for(var n in t){var r=t[n];r.overrider.detachComponent(e),r.setDirty(e)}this.deleteOverriderIfNeeded(t),this.propagateChanges(),this.commitChanges()}},{key:"markAsDeleted",value:(C=m(regeneratorRuntime.mark((function t(e){var n,r;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:t.t0=regeneratorRuntime.keys(e);case 1:if((t.t1=t.t0()).done){t.next=8;break}return n=t.t1.value,r=e[n],t.next=6,this.setOrCreateOverrider(r,"overrider",{deleter:!0});case 6:t.next=1;break;case 8:this.commitChanges();case 9:case"end":return t.stop()}}),t,this)}))),function(t){return C.apply(this,arguments)})},{key:"restoreEntities",value:function(t){for(var e in t)t[e].overrider.setComponent("overrider",{deleter:!1});this.deleteOverriderIfNeeded(t),this.commitChanges()}},{key:"setOrCreateOverrider",value:(S=m(regeneratorRuntime.mark((function t(e,n,r){var i;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.overrider){t.next=17;break}if((i={}).debug_name=this.getComponentDefaultValue("debug_name"),i.debug_name.value=e.getName(),i.overrider=this.getComponentDefaultValue("overrider"),i.overrider.overriddenEntityOriginalUUID=e.getEUID(),i.overrider.lineage=e.getLinkerLineage(),i[n]=d({},i[n],r),e.isRuntime()){t.next=13;break}return t.next=11,this.createEntity(null,i);case 11:t.next=15;break;case 13:return t.next=15,this.spawnEntity(null,i);case 15:t.next=18;break;case 17:e.overrider.UNSAFE_setComponent(n,r);case 18:case"end":return t.stop()}}),t,this)}))),function(t,e,n){return S.apply(this,arguments)})},{key:"deleteOverriderIfNeeded",value:function(t){var e=[];for(var n in t){var r=t[n];if(!(r.overrider.components.overrider.deleter||r.overrider.components.overrider.componentsToDetach.length>0)){var i=Object.keys(r.components),o=Object.keys(r.overrider.components);o.filter((function(t){return"debug_name"!=t&&r.isComponentOverridable(t)&&!i.includes(t)})).length>0||o.filter((function(t){return"debug_name"!=t&&r.isComponentOverridable(t)&&i.includes(t)})).length>0||(e.push(r.overrider.getEUID()),r.UNSAFE_detachComponent("overridden"),r.overrider=null)}}e.length>0&&this.editorAPI.deleteEntities(e)}},{key:"attachComponentWithDependencies",value:function(t,e){if(!t.isAttached(e)){var n=this.getComponentDescription(e).dependencies||[];for(var r in n)t.isAttached(n[r])||this.attachComponentWithDependencies(t,n[r]);t.attachComponent(e,this.getComponentDefaultValue(e))}}},{key:"detachComponentWithReferences",value:function(t,e){if(t.isAttached(e)){var n=t.getComponents();for(var r in n)(this.getComponentDescription(r).dependencies||[]).includes(e)&&this.detachComponentWithReferences(t,r);t.detachComponent(e)}}},{key:"getEntity",value:function(t){return this.entityRegistry.getEntity(t)}},{key:"reparentEntity",value:(T=m(regeneratorRuntime.mark((function t(e,n,r){var i,o,a,s;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(i=this.getEntity(e),o=i.getParent(),a=this.getEntity(n),!i.isExternal()){t.next=6;break}return console.error("Attempt to reparent an external entity"),t.abrupt("return");case 6:if(!a||!a.isExternal()){t.next=9;break}return console.error("Attempt to reparent a entity to an external parent"),t.abrupt("return");case 9:return this.editorAPI.prepareSequence(),r&&(i.computeGlobalTransformFromEntity(i.getGlobalTransform(),a),this.commitChanges()),s=this.editorAPI.reparentEntity(i.getEUID(),o?o.getEUID():null,a?a.getEUID():null),this.editorAPI.commitSequence("reparent-entity"),t.next=15,s;case 15:case"end":return t.stop()}}),t,this)}))),function(t,e,n){return T.apply(this,arguments)})},{key:"simplifyHierarchy",value:function(t){for(var e=null,n=t.getParent();n&&!(n.children.length>1);){var r=Object.keys(n.getComponents());for(var i in r){var o=r[i];if("debug_name"!=o&&"euid"!=o&&"lineage"!=o&&"local_transform"!=o&&"local_aabb"!=o)break}e=n,n=n.getParent()}if(null!=e){var a=n,s=t.getGlobalTransform(a);this.editorAPI.prepareSequence(),t.setComponent("local_transform",s),this.commitChanges(),this.reparentEntity(t.getID(),a?a.getID():null),this.deleteEntities([e]),this.editorAPI.commitSequence("simplify-hierarchy")}}},{key:"setEntityVisibility",value:(k=m(regeneratorRuntime.mark((function t(e,n){var r,i;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.visible=n,t.next=3,this.getEntityDescendants(e,!1);case 3:for(i in r=t.sent)r[i].visible=n;this.editorAPI.setEntityVisibility(e.getID(),n);case 6:case"end":return t.stop()}}),t,this)}))),function(t,e){return k.apply(this,arguments)})},{key:"findEntitiesByNames",value:(x=m(regeneratorRuntime.mark((function t(){var e,n,r,i=arguments;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:for(e=i.length,n=new Array(e),r=0;r<e;r++)n[r]=i[r];return t.next=3,this.editorAPI.findEntitiesByNames(n);case 3:return t.abrupt("return",t.sent);case 4:case"end":return t.stop()}}),t,this)}))),function(){return x.apply(this,arguments)})},{key:"selectEntity",value:function(t,e,n){this.updateSelectedEntities([t],e,n)}},{key:"selectEntities",value:function(t,e,n){this.updateSelectedEntities(t,e,n)}},{key:"unselectAllEntities",value:function(t){this.updateSelectedEntities([],!1,t)}},{key:"castScreenSpaceRay",value:(A=m(regeneratorRuntime.mark((function t(e,n,r,i){var o,a,s,u,c;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.ftlAPI.castScreenSpaceRay(this.canvas,e,n,r,i);case 2:if(o=t.sent,a=o.entityRTID,s=o.pickedPosition,null!=a){t.next=8;break}return r&&!i&&this.updateSelectedEntities([],!1,"picking"),t.abrupt("return",{entity:null,pickedPosition:null});case 8:return t.next=10,this.resolveEntity(a);case 10:for(u=t.sent,c=u;c.isExternal()&&!c.isComponentOverridden("local_transform")&&!this.selectedEntities.includes(c.linker);)c=c.linker;return r&&this.updateSelectedEntities([c],i,"picking"),t.abrupt("return",{entity:u,pickedPosition:s});case 15:case"end":return t.stop()}}),t,this)}))),function(t,e,n,r){return A.apply(this,arguments)})},{key:"filterEntities",value:(_=m(regeneratorRuntime.mark((function t(e){var n,r,i,o,a,s,u,c,h,f,l;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.editorAPI.sendRequestAsync("find-entities-with-components",e.mandatoryComponents);case 2:n=t.sent,r=[],i=50,o=20,a=0,t.t0=regeneratorRuntime.keys(n);case 8:if((t.t1=t.t0()).done){t.next=30;break}s=t.t1.value,u=n[s],c=u.ancestors,t.t2=regeneratorRuntime.keys(c);case 13:if((t.t3=t.t2()).done){t.next=20;break}return h=t.t3.value,f=c[h],t.next=18,this.entityRegistry.getOrAddEntity(f.rtid,f);case 18:t.next=13;break;case 20:return t.next=22,this.entityRegistry.getOrAddEntity(s,u);case 22:if(l=t.sent,r.push(l),!(++a>i)){t.next=28;break}return a=0,t.next=28,this.createSleepPromise(o);case 28:t.next=8;break;case 30:return t.abrupt("return",r);case 31:case"end":return t.stop()}}),t,this)}))),function(t){return _.apply(this,arguments)})},{key:"createSleepPromise",value:function(t){return new Promise((function(e){setTimeout(e,t)}))}},{key:"resolveEntity",value:(E=m(regeneratorRuntime.mark((function t(e){var n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!(n=this.entityRegistry.getEntity(e))){t.next=3;break}return t.abrupt("return",n);case 3:return t.next=5,this.editorAPI.resolveAncestors(e);case 5:return t.abrupt("return",this.entityRegistry.getEntity(e));case 6:case"end":return t.stop()}}),t,this)}))),function(t){return E.apply(this,arguments)})},{key:"updateSelectedEntities",value:function(t,e,n){var r=[],i=t.length>0;if(!e&&this.selectedEntities.length>0){var o=!0,a=!1,s=void 0;try{for(var u,c=this.selectedEntities[Symbol.iterator]();!(o=(u=c.next()).done);o=!0){var h=u.value;t.includes(h)||(h.selected=!1,r.push(h))}}catch(t){a=!0,s=t}finally{try{o||null==c.return||c.return()}finally{if(a)throw s}}this.selectedEntities.length=0,i=!0}var f=!0,l=!1,p=void 0;try{for(var d,v=t[Symbol.iterator]();!(f=(d=v.next()).done);f=!0){var y=d.value,m=this.selectedEntities.indexOf(y);i=!0,e&&-1!=m?(y.selected=!1,this.selectedEntities.splice(m,1),r.push(y)):(y.selected=!0,this.selectedEntities.push(y))}}catch(t){l=!0,p=t}finally{try{f||null==v.return||v.return()}finally{if(l)throw p}}i&&(this.notifier.emit("onEntitySelectionChanged",this.selectedEntities,r,n),this.highlightSelectedEntities())}},{key:"highlightSelectedEntities",value:function(){var t=this.selectedEntities.filter((function(t){return t.isAttached("local_transform")})),e=t.filter((function(e){var n=e.getAncestors();return!t.some((function(t){return n.includes(t)}))}));this.ftlAPI.highlightEntities(e.map((function(t){return t.components.euid.rtid})))}},{key:"getRootEntities",value:(b=m(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.editorAPI.onConnected;case 2:return t.abrupt("return",this.entityRegistry.getRootEntities());case 3:case"end":return t.stop()}}),t,this)}))),function(){return b.apply(this,arguments)})},{key:"getEntityChildren",value:(w=m(regeneratorRuntime.mark((function t(e){var n,r,i,o,a=arguments;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n=!(a.length>1&&void 0!==a[1])||a[1],r=[],t.t0=regeneratorRuntime.keys(e.children);case 3:if((t.t1=t.t0()).done){t.next=16;break}if(i=t.t1.value,o=e.children[i],!this.entityRegistry.hasEntity(o)){t.next=10;break}r.push(this.entityRegistry.getEntity(o)),t.next=14;break;case 10:if(!n){t.next=14;break}return t.next=13,this.editorAPI.getChildren(e);case 13:return t.abrupt("return",t.sent);case 14:t.next=3;break;case 16:return t.abrupt("return",r);case 17:case"end":return t.stop()}}),t,this)}))),function(t){return w.apply(this,arguments)})},{key:"getEntityDescendants",value:(y=m(regeneratorRuntime.mark((function t(e,n){var r,i,o;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.getEntityChildren(e,n);case 2:r=t.sent,i=[].concat(r),t.t0=regeneratorRuntime.keys(r);case 5:if((t.t1=t.t0()).done){t.next=14;break}return o=t.t1.value,t.t2=i,t.next=10,this.getEntityDescendants(r[o],n);case 10:t.t3=t.sent,i=t.t2.concat.call(t.t2,t.t3),t.next=5;break;case 14:return t.abrupt("return",i);case 15:case"end":return t.stop()}}),t,this)}))),function(t,e){return y.apply(this,arguments)})},{key:"undo",value:function(){this.editorAPI.sendRequest("undo")}},{key:"redo",value:function(){this.editorAPI.sendRequest("redo")}},{key:"propagateChanges",value:function(t){var e=this.entityRegistry.dirtyEntities;this.ftlAPI.propagateChanges(e),this.entityRegistry.dirtyEntities={},this.notifier.emit("onEntitiesUpdated",e,t)}},{key:"commitChanges",value:function(){this.editorAPI.updateEntities(this.entityRegistry.unsavedEntities),this.entityRegistry.dirtyEntities={},this.entityRegistry.unsavedEntities={}}},{key:"getComponentClassNames",value:function(){return Object.keys(this.editorAPI.componentClasses)}},{key:"getComponentDescription",value:function(t){return this.editorAPI.componentClasses[t]||null}},{key:"getComponentDefaultValue",value:function(t){return this.entityRegistry.getComponentDefaultValue(t)}},{key:"propagateSettings",value:function(t){this.ftlAPI.updateConfig(t)}},{key:"commitSettings",value:function(t){this.editorAPI.sendRequest("update-settings",t)}},{key:"fireEvent",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r=arguments.length>3?arguments[3]:void 0,i=n.map((function(t){return t.UNSAFE_getComponent("euid").rtid}));this.ftlAPI.fireEvent(t,e,i,r)}},{key:"canEdit",value:function(){return this.editorAPI.canEdit}},{key:"listenEditorEvents",value:function(){var t=this;this.editorAPI.on("editor-connected",(function(){t.ftlAPI.setComponentDescriptions(t.editorAPI.componentClasses),t.entityRegistry.setComponentDescriptions(t.editorAPI.componentClasses),t.cameraAPI.onEditorConnected(),t.ftlAPI.updateSelectionColor(t.editorAPI.selectColor)})),this.editorAPI.on("entities-deleted",(function(e){var n=0;for(var r in e){var i=t.selectedEntities.findIndex((function(t){return t.getID()==e[r]}));-1!=i&&(t.selectedEntities.splice(i,1),++n)}n>0&&t.notifier.emit("onEntitySelectionChanged",t.selectedEntities,[],"entities-deleted")})),this.editorAPI.on("entity-created",(function(e){t.notifier.emit("onEntityCreated",e)})),this.editorAPI.on("entities-deleted",(function(e){t.notifier.emit("onEntitiesDeleted",e)})),this.editorAPI.on("entity-visibility-updated",(function(e){t.notifier.emit("onEntityVisibilityChanged",e)})),this.editorAPI.on("reparent-entity",(function(e,n,r){t.notifier.emit("onEntityReparent",e,n,r)})),this.editorAPI.on("entities-overridden",(function(){t.notifier.emit("onEntitySelectionChanged",t.selectedEntities,[],"entities-overridden")})),this.editorAPI.on("entities-updated",(function(e){t.notifier.emit("onEntitiesUpdated",e)})),this.editorAPI.on("settings-updated",(function(e){t.notifier.emit("onSettingsUpdated",e)})),this.editorAPI.on("error",(function(e){t.notifier.emit("error",e)}))}},{key:"computeBoundingBoxes",value:(v=m(regeneratorRuntime.mark((function e(){var n,r,i,o,a,s,u,c,h,f,d,v,y,m,g,w,b,E,_,A,x,k,T,S,C,R,P,I,M,U,O,D,L,N,F,B,V,j,Y,G;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={},r=[],e.next=4,this.filterEntities({mandatoryComponents:["local_aabb","mesh_ref"]});case 4:i=e.sent,o=this.entityRegistry.getLinkers(),a=[].concat(p(i),p(o)),s=!0,u=!1,c=void 0,e.prev=10,h=a[Symbol.iterator]();case 12:if(s=(f=h.next()).done){e.next=24;break}if(d=f.value,v=d.isExternal()?d.linker.getComponent("scene_ref").value:this.editorAPI.sceneUUID,n.hasOwnProperty(v)||(n[v]={parentLinker:d.isExternal()?d.linker:null,entities:[],aabb:{min:t.fromValues(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE),max:t.fromValues(-Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE)}}),d.isLinker()&&r.push([v,d.getComponent("scene_ref").value]),y=n[v],!d.isExternal()||d.linker.isSame(y.parentLinker)){e.next=20;break}return e.abrupt("continue",21);case 20:y.entities.push(d);case 21:s=!0,e.next=12;break;case 24:e.next=30;break;case 26:e.prev=26,e.t0=e.catch(10),u=!0,c=e.t0;case 30:e.prev=30,e.prev=31,s||null==h.return||h.return();case 33:if(e.prev=33,!u){e.next=36;break}throw c;case 36:return e.finish(33);case 37:return e.finish(30);case 38:(m=l()(r).reverse()).includes(this.editorAPI.sceneUUID)||m.push(this.editorAPI.sceneUUID),g=!0,w=!1,b=void 0,e.prev=43,E=m[Symbol.iterator]();case 45:if(g=(_=E.next()).done){e.next=72;break}for(A=_.value,x=n[A],k=x.aabb,T=!0,S=!1,C=void 0,e.prev=53,R=x.entities[Symbol.iterator]();!(T=(P=R.next()).done);T=!0){for(I=P.value,M=I.getGlobalMatrix(x.parentLinker),U=null,I.isLinker()?U=n[I.getComponent("scene_ref").value].aabb:(L=I.UNSAFE_getComponent("local_aabb"),U={min:(O=t).fromValues.apply(O,p(L.min)),max:(D=t).fromValues.apply(D,p(L.max))}),(N=[])[0]=t.fromValues(U.min[0],U.min[1],U.min[2]),N[1]=t.fromValues(U.max[0],U.min[1],U.min[2]),N[2]=t.fromValues(U.min[0],U.max[1],U.min[2]),N[3]=t.fromValues(U.min[0],U.min[1],U.max[2]),N[4]=t.fromValues(U.max[0],U.max[1],U.max[2]),N[5]=t.fromValues(U.min[0],U.max[1],U.max[2]),N[6]=t.fromValues(U.max[0],U.min[1],U.max[2]),N[7]=t.fromValues(U.max[0],U.max[1],U.min[2]),F=t.fromValues(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE),B=t.fromValues(-Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE),V=0;V<N.length;V++)j=N[V],t.transformMat4(j,j,M),t.min(F,j,F),t.max(B,j,B);t.max(k.max,B,k.max),t.min(k.min,F,k.min)}e.next=61;break;case 57:e.prev=57,e.t1=e.catch(53),S=!0,C=e.t1;case 61:e.prev=61,e.prev=62,T||null==R.return||R.return();case 64:if(e.prev=64,!S){e.next=67;break}throw C;case 67:return e.finish(64);case 68:return e.finish(61);case 69:g=!0,e.next=45;break;case 72:e.next=78;break;case 74:e.prev=74,e.t2=e.catch(43),w=!0,b=e.t2;case 78:e.prev=78,e.prev=79,g||null==E.return||E.return();case 81:if(e.prev=81,!w){e.next=84;break}throw b;case 84:return e.finish(81);case 85:return e.finish(78);case 86:for(Y in console.log(n),n)G=n[Y],this.editorAPI.updateAABB(Y,{min:Array.from(G.aabb.min),max:Array.from(G.aabb.max)});case 88:case"end":return e.stop()}}),e,this,[[10,26,30,38],[31,,33,37],[43,74,78,86],[53,57,61,69],[62,,64,68],[79,,81,85]])}))),function(){return v.apply(this,arguments)})}])&&g(n.prototype,c),f&&g(n,f),e}();e.a=w}).call(this,n(12))},function(t,e,n){"use strict";n.d(e,"a",(function(){return d}));n(92),n(75),n(21),n(80),n(84),n(148),n(90),n(38),n(39),n(40),n(35),n(103),n(62),n(166),n(97),n(96),n(57);var r=n(14),i=n(152);function o(t){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function a(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(t){return Object.getOwnPropertyDescriptor(n,t).enumerable})))),r.forEach((function(e){s(t,e,n[e])}))}return t}function s(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function u(t,e,n,r,i,o,a){try{var s=t[o](a),u=s.value}catch(t){return void n(t)}s.done?e(u):Promise.resolve(u).then(r,i)}function c(t){return function(){var e=this,n=arguments;return new Promise((function(r,i){var o=t.apply(e,n);function a(t){u(o,r,i,a,s,"next",t)}function s(t){u(o,r,i,a,s,"throw",t)}a(void 0)}))}}function h(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function f(t,e){return!e||"object"!==o(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function l(t){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function p(t,e){return(p=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var d=function(t){function e(t,n){var r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(r=f(this,l(e).call(this))).notifier=t,r.entityRegistry=n,r.actionStack=[],r.callstack=[],r.sequence=null,r.sceneSettings={},r.clientColors={},r.processingAction=!1,r.canEdit=!1,r.onConnected=new Promise((function(t){r.onConnectedCallback=t})),r}var n,i,o,s,u,d,v,y,m,g,w,b,E,_,A;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&p(t,e)}(e,t),n=e,(i=[{key:"setURL",value:function(t){this.webSocketURL=t,("https:"==location.protocol||this.webSocketURL.includes("3dverse.com"))&&(this.webSocketURL=this.webSocketURL.replace("ws:","wss:"))}},{key:"connect",value:function(t,e,n){var r=this;this.setURL(t),this.sessionKey=e,this.socket=new WebSocket("".concat(this.webSocketURL,"?sessionKey=").concat(this.sessionKey,"&clientUUID=").concat(n)),this.socket.binaryType="arraybuffer",this.socket.onopen=function(){r.notifier.emit("onEditorSocketOpened")},this.socket.onclose=function(){r.notifier.emit("onEditorDisconnected")},this.socket.onerror=function(t){r.notifier.emit("onEditorSocketError",t)},this.socket.onmessage=function(t){return r.onMessageReceived(t)}}},{key:"close",value:function(){this.sendRequest("close")}},{key:"onMessageReceived",value:function(t){var e=JSON.parse(t.data);switch(e.type){case"connect-confirmation":this.handleConnectConfirmation(e.data);break;case"retrieve-children":case"find-entities-with-components":case"resolve-ancestors":case"find-entities-by-names":case"get-entities-by-euid":this.handleRequestResponse(e.data);break;case"next-undo-redo":this.handleNextUndoRedoEvent(e.data);break;case"client-color":this.handleClientColor(e.data);break;case"error":console.error(e.data),this.emit("error",e.data),this.emit("editor-error",e.data);break;default:this.actionStack.push(e),0==this.processingAction&&this.processAction()}}},{key:"processAction",value:(A=c(regeneratorRuntime.mark((function t(){var e;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e=null,this.processingAction=!0;case 2:if(!(e=this.actionStack.pop())){t.next=13;break}return t.prev=3,t.next=6,this.handleAction(e);case 6:t.next=11;break;case 8:t.prev=8,t.t0=t.catch(3),console.error("Error processing action ".concat(t.t0));case 11:t.next=2;break;case 13:this.processingAction=!1;case 14:case"end":return t.stop()}}),t,this,[[3,8]])}))),function(){return A.apply(this,arguments)})},{key:"handleAction",value:(_=c(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:t.t0=e.type,t.next="create-entity"===t.t0?3:"restore-entities"===t.t0?3:"spawn-entity"===t.t0?3:"entities-created"===t.t0?6:"entity-reparented"===t.t0?6:"attach-components"===t.t0?8:"update-components"===t.t0?8:"detach-components"===t.t0?10:"delete-entities"===t.t0?12:"reparent-entity"===t.t0?14:"entities-overridden"===t.t0?17:"update-settings"===t.t0?19:21;break;case 3:return t.next=5,this.handleEntitiesCreatedEvent(e.data);case 5:return t.abrupt("break",21);case 6:return this.handleRequestResponse(e.data),t.abrupt("break",21);case 8:return this.handleUpdateComponentsEvent(e.data),t.abrupt("break",21);case 10:return this.handleDetachComponentsEvent(e.data),t.abrupt("break",21);case 12:return this.handleEntitiesDeletedEvent(e.data),t.abrupt("break",21);case 14:return t.next=16,this.handleReparentEntityEvent(e.data.movingEntityEUID,e.data.oldParentEUID,e.data.newParentEUID);case 16:return t.abrupt("break",21);case 17:return this.handleEntitiesOverriddenEvent(e.data),t.abrupt("break",21);case 19:return this.handleUpdateSettingsEvent(e.data),t.abrupt("break",21);case 21:this.emit("debug",e);case 22:case"end":return t.stop()}}),t,this)}))),function(t){return _.apply(this,arguments)})},{key:"sendCreateEntityRequest",value:(E=c(regeneratorRuntime.mark((function t(e,n){var r,i;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=n?"spawn-entity":"create-entity",t.next=3,this.sendRequestAsync(r,e);case 3:return i=t.sent,t.next=6,this.handleEntitiesCreatedEvent(i);case 6:return t.abrupt("return",t.sent);case 7:case"end":return t.stop()}}),t,this)}))),function(t,e){return E.apply(this,arguments)})},{key:"deleteEntities",value:function(t){this.sendRequest("delete-entities",t)}},{key:"updateEntities",value:function(t){var e={},n={},r={};for(var i in t){var o=t[i],a=o.getEUID();this.fillRequest(e,a,o,o.attachedComponents,!0),this.fillRequest(n,a,o,o.unsavedComponents,!0),this.fillRequest(r,a,o,o.detachedComponents,!1)}Object.keys(e).length>0&&this.sendRequest("attach-components",e),Object.keys(n).length>0&&this.sendRequest("update-components",n),Object.keys(r).length>0&&this.sendRequest("detach-components",r)}},{key:"fillRequest",value:function(t,e,n,r,i){for(var o in r){t.hasOwnProperty(e)||(t[e]=i?{}:[]);var a=r[o];i?t[e][a]=n.getComponent(a):t[e].push(a)}r.length=0}},{key:"reparentEntity",value:(b=c(regeneratorRuntime.mark((function t(e,n,r){var i;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.sendRequestAsync("reparent-entity",{movingEntityEUID:e,oldParentEUID:n,newParentEUID:r});case 2:return i=t.sent,t.next=5,this.handleReparentEntityEvent(i.movingEntityEUID,i.oldParentEUID,i.newParentEUID);case 5:case"end":return t.stop()}}),t,this)}))),function(t,e,n){return b.apply(this,arguments)})},{key:"setEntityVisibility",value:function(t,e){this.sendRequest("set-node-visibility",{entityRTID:t,isVisible:e}),this.emit("entity-visibility-updated",t)}},{key:"findEntitiesByNames",value:(w=c(regeneratorRuntime.mark((function t(e){var n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.sendRequestAsync("find-entities-by-names",e);case 2:return n=t.sent,t.next=5,this.formatEditorEntities(n);case 5:return t.abrupt("return",t.sent);case 6:case"end":return t.stop()}}),t,this)}))),function(t){return w.apply(this,arguments)})},{key:"resolveEntitiesByEUID",value:(g=c(regeneratorRuntime.mark((function t(e){var n,r,i,o,a,s,u;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.sendRequestAsync("get-entities-by-euid",e);case 2:n=t.sent,r=!0,i=!1,o=void 0,t.prev=6,a=n[Symbol.iterator]();case 8:if(r=(s=a.next()).done){t.next=15;break}return u=s.value,t.next=12,this.resolveAncestors(u.rtid);case 12:r=!0,t.next=8;break;case 15:t.next=21;break;case 17:t.prev=17,t.t0=t.catch(6),i=!0,o=t.t0;case 21:t.prev=21,t.prev=22,r||null==a.return||a.return();case 24:if(t.prev=24,!i){t.next=27;break}throw o;case 27:return t.finish(24);case 28:return t.finish(21);case 29:return t.next=31,this.formatEditorEntities(n);case 31:return t.abrupt("return",t.sent);case 32:case"end":return t.stop()}}),t,this,[[6,17,21,29],[22,,24,28]])}))),function(t){return g.apply(this,arguments)})},{key:"getChildren",value:(m=c(regeneratorRuntime.mark((function t(e){var n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.sendRequestAsync("retrieve-children",e.getID());case 2:return n=t.sent,t.next=5,this.formatEditorEntities(n);case 5:return t.abrupt("return",t.sent);case 6:case"end":return t.stop()}}),t,this)}))),function(t){return m.apply(this,arguments)})},{key:"formatEditorEntities",value:(y=c(regeneratorRuntime.mark((function t(e){var n,r,i;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n=[],t.t0=regeneratorRuntime.keys(e);case 2:if((t.t1=t.t0()).done){t.next=14;break}if(r=t.t1.value,null==e[r]){t.next=11;break}return t.next=7,this.entityRegistry.getOrAddEntity(e[r].rtid,e[r]);case 7:i=t.sent,n.push(i),t.next=12;break;case 11:n.push(null);case 12:t.next=2;break;case 14:return t.abrupt("return",n);case 15:case"end":return t.stop()}}),t,this)}))),function(t){return y.apply(this,arguments)})},{key:"resolveAncestors",value:(v=c(regeneratorRuntime.mark((function t(e){var n,r,i;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.sendRequestAsync("resolve-ancestors",e);case 2:n=t.sent,t.t0=regeneratorRuntime.keys(n);case 4:if((t.t1=t.t0()).done){t.next=13;break}if(r=t.t1.value,this.entityRegistry.hasEntity(n[r].rtid)){t.next=11;break}return t.next=9,this.entityRegistry.addEntity(n[r]);case 9:i=t.sent,this.notifier.emit("entityResolved",i);case 11:t.next=4;break;case 13:case"end":return t.stop()}}),t,this)}))),function(t){return v.apply(this,arguments)})},{key:"updateAABB",value:function(t,e){this.sendRequest("update-aabb",{sceneUUID:t,aabb:e})}},{key:"handleConnectConfirmation",value:(d=c(regeneratorRuntime.mark((function t(e){var n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this.workspaceUUID=e.workspaceUUID,this.sceneUUID=e.sceneUUID,this.componentClasses=e.components,this.settingDescriptions=e.settingDescriptions,this.sceneSettings=e.settings,this.clientRTID=e.clientRTID,this.canEdit=e.canEdit,this.clientColors=e.clientColors,this.selectColor=e.selectColor,this.emit("editor-connected"),t.next=12,this.handleEntitiesCreatedEvent(e.rootNodes,!1);case 12:n=t.sent,this.notifier.emit("sceneGraphReady",n),this.handleNextUndoRedoEvent(e.undoRedo),this.onConnectedCallback();case 16:case"end":return t.stop()}}),t,this)}))),function(t){return d.apply(this,arguments)})},{key:"handleEntitiesCreatedEvent",value:(u=c(regeneratorRuntime.mark((function t(e){var n,r,i,o,a,s,u=arguments;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n=!(u.length>1&&void 0!==u[1])||u[1],r=[],t.t0=regeneratorRuntime.keys(e);case 3:if((t.t1=t.t0()).done){t.next=15;break}return i=t.t1.value,o=e[i],t.next=8,this.entityRegistry.addEntity(o);case 8:a=t.sent,(s=a.getParent())&&-1==s.children.indexOf(a.getID())&&s.children.push(a.getID()),r.push(a),n&&this.emit("entity-created",a),t.next=3;break;case 15:return t.abrupt("return",r);case 16:case"end":return t.stop()}}),t,this)}))),function(t){return u.apply(this,arguments)})},{key:"handleEntitiesDeletedEvent",value:function(t){var e=[];for(var n in t){var r=t[n],i=this.entityRegistry.getEntitiesByEUID(r);e=e.concat(i.map((function(t){return t.getID()}))),this.entityRegistry.deleteEntities(i)}this.emit("entities-deleted",e)}},{key:"handleUpdateComponentsEvent",value:function(t){var e=[];for(var n in t){var r=t[n],i=this.entityRegistry.getEntitiesByEUID(n);for(var o in i)for(var a in r)i[o].UNSAFE_setComponent(a,r[a]),e.push(i[o])}this.emit("entities-updated",e)}},{key:"handleDetachComponentsEvent",value:function(t){var e=[];for(var n in t){var r=this.entityRegistry.getEntitiesByEUID(n),i=t[n];for(var o in r)for(var a in i)r[o].UNSAFE_detachComponent(i[a]),e.push(r[o])}this.emit("entities-updated",e)}},{key:"handleReparentEntityEvent",value:(s=c(regeneratorRuntime.mark((function t(e,n,r){var i,o,a,s,u,c,h,f,l;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.resolveEntitiesByEUID(e);case 2:if(i=t.sent,!n){t.next=9;break}return t.next=6,this.resolveEntitiesByEUID(n);case 6:t.t0=t.sent,t.next=10;break;case 9:t.t0=null;case 10:if(o=t.t0,!r){t.next=17;break}return t.next=14,this.resolveEntitiesByEUID(r);case 14:t.t1=t.sent,t.next=18;break;case 17:t.t1=null;case 18:for(a=t.t1,s=Math.max(i.length,o?o.length:0,a?a.length:0),u=0;u<s;++u)c=i[u],h=o?o[u]:c.linker,f=a?a[u]:c.linker,h&&-1!=(l=h.children.indexOf(c.getID()))&&h.children.splice(l,1),f?(-1==(l=f.children.indexOf(c.getID()))&&f.children.push(c.getID()),c.components.lineage.ancestorRTID=f.getID()):c.components.lineage.ancestorRTID=null,this.emit("reparent-entity",c,h,f);case 21:case"end":return t.stop()}}),t,this)}))),function(t,e,n){return s.apply(this,arguments)})},{key:"handleEntitiesOverriddenEvent",value:function(t){for(var e in t){var n=t[e].overriddenEntitiesRTIDs,i=t[e].overriddenComponent,o=this.entityRegistry.getEntity(i.overriderEntityRTID);for(var a in n){var s=this.entityRegistry.getEntity(n[a]);s&&(s.UNSAFE_attachComponent("overridden",r.a.clone(i)),s.overrider=o,o.overriddenEntity=s)}}this.emit("entities-overridden",t)}},{key:"handleUpdateSettingsEvent",value:function(t){for(var e in t)this.sceneSettings[e]=a({},this.sceneSettings[e],t[e]);this.emit("settings-updated",t)}},{key:"handleClientColor",value:function(t){this.clientColors[t.clientUUID]=t.color,this.emit("client-color",t)}},{key:"handleNextUndoRedoEvent",value:function(t){this.emit("next-undo-redo",t)}},{key:"handleRequestResponse",value:function(t){this.callstack.shift()(t)}},{key:"prepareSequence",value:function(){return null==this.sequence&&(this.sequence=[],!0)}},{key:"commitSequence",value:function(t){var e=this.prepareMessage("sequence",{name:t,actions:this.sequence});this.sequence=null,this.socket.send(JSON.stringify(e))}},{key:"prepareMessage",value:function(t,e){return{type:t,data:e}}},{key:"sendRequest",value:function(t,e){var n=this.prepareMessage(t,e);null==this.sequence?this.socket.send(JSON.stringify(n)):this.sequence.push(n)}},{key:"sendRequestAsync",value:function(t,e){var n=this;return new Promise((function(r){n.callstack.push((function(e){console.log("Response received for request ".concat(t,".")),r(e)})),n.sendRequest(t,e)}))}}])&&h(n.prototype,i),o&&h(n,o),e}(n.n(i).a)},function(t,e,n){"use strict";(function(t,r,i){n(85),n(86),n(95),n(55),n(56),n(116),n(57),n(148),n(62),n(135),n(38),n(39),n(92),n(75),n(40),n(35),n(103),n(21),n(152);var o=n(180),a=n(76),s=n(14);function u(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function c(t,e,n,r,i,o,a){try{var s=t[o](a),u=s.value}catch(t){return void n(t)}s.done?e(u):Promise.resolve(u).then(r,i)}function h(t){return function(){var e=this,n=arguments;return new Promise((function(r,i){var o=t.apply(e,n);function a(t){c(o,r,i,a,s,"next",t)}function s(t){c(o,r,i,a,s,"throw",t)}a(void 0)}))}}function f(t){return(f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function l(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(t){return Object.getOwnPropertyDescriptor(n,t).enumerable})))),r.forEach((function(e){p(t,e,n[e])}))}return t}function p(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function d(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function v(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function y(t,e,n){return e&&v(t.prototype,e),n&&v(t,n),t}var m=0,g=0,w=1,b=function(){function e(n,r){d(this,e),this.id=n,this.onViewportUpdate=r,this.widthRatio=0,this.heightRatio=0,this.leftRatio=0,this.topRatio=0,this.projectionType=g,this.cameraEntity=null,this.frameTransform=null,this.isAttachedOnExistingCamera=!1,this.worldMatrix=t.create(),this.viewMatrix=t.create(),this.projectionMatrix=t.create(),this.viewProjectionMatrix=t.create()}return y(e,[{key:"getId",value:function(){return this.id}},{key:"setProperties",value:function(t){this.widthRatio=t.width,this.heightRatio=t.height,this.leftRatio=t.left,this.topRatio=t.top,this.computeProjectionData()}},{key:"setFrameTransform",value:function(t){this.frameTransform||(this.frameTransform=s.a.clone(t.UNSAFE_getComponent("local_transform")))}},{key:"setWorldMatrix",value:function(t){this.worldMatrix=t,this.frameTransform=s.a.matrixToTransform(this.worldMatrix),this.frameTransform.scale=[1,1,1],this.updateViewMatrix()}},{key:"getWorldMatrix",value:function(){return this.worldMatrix}},{key:"getCamera",value:function(){return this.cameraEntity}},{key:"setProjectionType",value:function(t,e){this.projectionType=t,this.computeProjectionData(),this.updateProjectionMatrix(e)}},{key:"setCamera",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];this.cameraEntity=t,this.isAttachedOnExistingCamera=e,this.updateProjectionMatrix(n)}},{key:"computeProjectionData",value:function(){this.projectionType===g&&this.computeAspectRatio()}},{key:"computeAspectRatio",value:function(){if(this.isAttachedOnExistingCamera)this.aspectRatio=this.cameraEntity.UNSAFE_getComponent("camera").aspectRatio;else{var t=this.getAreaSize();this.aspectRatio=t[0]/t[1]}}},{key:"updateProjectionMatrix",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],n=this.cameraEntity.UNSAFE_getComponent("camera");if(this.projectionType==g)!this.isAttachedOnExistingCamera&&e&&this.cameraEntity.setComponent("camera",l({},n,{aspectRatio:this.aspectRatio})),t.perspective(this.projectionMatrix,a.a.toRadian(n.fovy),this.aspectRatio,n.nearPlane,n.farPlane);else{var r=n.fovy,i=n.aspectRatio*r,o=r,s=100;t.ortho(this.projectionMatrix,-i,i,-o,o,-s,s)}this.updateViewProjectionMatrix()}},{key:"updateViewMatrix",value:function(){t.invert(this.viewMatrix,this.worldMatrix),this.updateViewProjectionMatrix()}},{key:"updateViewProjectionMatrix",value:function(){t.multiply(this.viewProjectionMatrix,this.projectionMatrix,this.viewMatrix)}},{key:"getTransform",value:function(){return this.frameTransform}},{key:"setTransform",value:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];this.cameraEntity.UNSAFE_setComponent("local_transform",t),this.cameraEntity.UNSAFE_setDirty("local_transform"),e?SDK3DVerse.engineAPI.ftlAPI.propagateChanges([this.cameraEntity]):this.cameraEntity.registry.UNSAFE_setDirtyEntity(this.cameraEntity),n&&(this.worldMatrix=this.cameraEntity.getGlobalMatrix(),this.updateViewMatrix())}},{key:"getProjection",value:function(){return this.cameraEntity.UNSAFE_getComponent("camera")}},{key:"getProjectionMatrix",value:function(){return this.projectionMatrix}},{key:"getViewProjectionMatrix",value:function(){return this.viewProjectionMatrix}},{key:"getAreaSize",value:function(){var t=SDK3DVerse.streamer.renderingAreaSize,e=this.widthRatio*t[0],n=this.heightRatio*t[1];if(!this.isAttachedOnExistingCamera)return[e,n];var r=this.cameraEntity.UNSAFE_getComponent("camera").aspectRatio,i=e/n;return[i>r?n*r:e,i>r?n:e/r]}},{key:"setAreaSize",value:function(t,e){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=SDK3DVerse.streamer.renderingAreaSize;this.setAreaRatio(t/r[0],e/r[1],n)}},{key:"setAreaRatio",value:function(t,e){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];this.widthRatio=t,this.heightRatio=e,this.computeProjectionData(),this.updateProjectionMatrix(),n&&this.onViewportUpdate()}},{key:"getOffset",value:function(){var t=SDK3DVerse.streamer.renderingAreaSize;return[this.leftRatio*t[0],this.topRatio*t[1]]}},{key:"setOffset",value:function(t,e){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=SDK3DVerse.streamer.renderingAreaSize;this.setOffsetRatio(t/r[0],e/r[1],n)}},{key:"setOffsetRatio",value:function(t,e){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];this.leftRatio=t,this.topRatio=e,n&&this.onViewportUpdate()}},{key:"isInArea",value:function(t){var e=this.getAreaSize(),n=this.getOffset();return t[0]>=n[0]&&t[0]<=n[0]+e[0]&&t[1]>=n[1]&&t[1]<=n[1]+e[1]}},{key:"reset",value:function(){var t,e=this,n=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];t=this.defaultTransform?this.defaultTransform:SDK3DVerse.engineAPI.editorAPI.sceneSettings.hasOwnProperty("default_camera_transform")?s.a.clone(SDK3DVerse.engineAPI.editorAPI.sceneSettings.default_camera_transform):s.a.clone(s.a.getIdentityTransform()),this.setTransform(t,n),setTimeout((function(){var t=SDK3DVerse.engineAPI.cameraAPI,n=t.getControllerType(e.id);t.setControllerType(e.id,n)}),100)}},{key:"enableUpdateFromFrameData",value:function(){this.disableUpdate=!1}},{key:"disableUpdateFromFrameData",value:function(){this.disableUpdate=!0}}]),e}(),E=function(){function t(e,n,r){var i=this;d(this,t),p(this,"onMouseEventListener",(function(t,e){var n=i.canvas.getClientRects()[0],r=[t.clientX-n.left,t.clientY-n.top],o=i.getHoveredViewport(r);o&&e(o,t)})),p(this,"updateViewportsAspectRatio",(function(t,e){i.registeredViewports.forEach((function(t){t.computeProjectionData(),t.getCamera()&&t.updateProjectionMatrix(!i.isOffline)})),i.isOffline||i.engineAPI.commitChanges()})),p(this,"updateViewportAttachedOnExistingCamera",(function(t){var e=function(e){var n=t[e],r=i.registeredViewports.filter((function(t){return t.isAttachedOnExistingCamera&&t.getCamera()&&t.getCamera().isSame(n)})),o=!0,a=!1,s=void 0;try{for(var u,c=r[Symbol.iterator]();!(o=(u=c.next()).done);o=!0){var h=u.value;h.computeProjectionData(),h.updateProjectionMatrix()}}catch(t){a=!0,s=t}finally{try{o||null==c.return||c.return()}finally{if(a)throw s}}if(r.length>0)return i.notifier.emit("onViewportsUpdated",i.registeredViewports),{v:void 0}};for(var n in t){var r=e(n);if("object"===f(r))return r.v}})),this.MAX_VIEWPORT=8,this.notifier=e,this.engineAPI=n,this.streamer=r,this.globalControllerID=0,this.currentClientUUID=null,this.defaultCameras=[],this.defaultCameraTemplate={local_transform:s.a.getIdentityTransform(),camera:{aspectRatio:1.777,fovy:60,nearPlane:.1,farPlane:1e3}},this.userName=null,this.viewports=[],this.registeredViewports=[],this.currentViewportEnabled=null,this.viewportRequestQueue=o.a.queue((function(t,e){i.requestRegisterViewports(t.viewports).then((function(){e()})).catch((function(t){e(t)}))}),1);for(var a=0;a<this.MAX_VIEWPORT;++a)this.viewports.push(new b(a,(function(){return i.updateViewports()})));this.notifier.on("onFrameDataReceived",(function(t){return i.onFrameDataReceived(t)})),this.notifier.on("onEntitiesUpdated",this.updateViewportAttachedOnExistingCamera),this.notifier.on("onNewRenderingAreaSize",this.updateViewportsAspectRatio)}var e,n,a,c,v,E;return y(t,[{key:"setupDisplay",value:function(t){var e=this;this.canvas=t,this.canvas&&(this.onMouseEvent("mousedown",(function(t){e.setActiveViewport(t)})),this.onMouseEvent("mouseup",(function(){e.notifier.emit("onViewportSelected",e.currentViewportEnabled)})))}},{key:"onMouseEvent",value:function(t,e){var n=this,r=function(t){return n.onMouseEventListener(t,e)};return this.canvas.addEventListener(t,r,!1),r}},{key:"getHoveredViewport",value:function(t){for(var e=this.registeredViewports.length-1;e>=0;e--){var n=this.registeredViewports[e];if(n.isInArea(t))return n}}},{key:"setActiveViewport",value:function(t){var e=[];null!=this.currentViewportEnabled&&this.currentViewportEnabled!=t&&this.currentViewportEnabled.cameraEntity.controller&&e.push({id:this.currentViewportEnabled.cameraEntity.controller.id,enabled:!1}),t&&t.cameraEntity&&t.cameraEntity.controller?(e.push({id:t.cameraEntity.controller.id,enabled:!0}),this.currentViewportEnabled=t):this.currentViewportEnabled=null,this.engineAPI.ftlAPI.setControllersState(e)}},{key:"getViewportByID",value:function(t){var e=this.viewports.find((function(e){return e.id==t}));if(!e)throw"Invalid viewport ID : "+t;return e}},{key:"registerViewport",value:function(t){var e=this.getViewportByID(t);return this.registeredViewports.push(e),e}},{key:"getActiveViewports",value:function(){return this.registeredViewports}},{key:"onEditorConnected",value:(E=h(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.defaultCameraTemplate={},s.a.resolveComponentDependencies(this.defaultCameraTemplate,"camera"),this.isEditorConnected=!0,!this.editorTimeout){t.next=11;break}if(clearTimeout(this.editorTimeout),!this.viewportsTemplate){t.next=8;break}return t.next=8,this.registerViewports(this.viewportsTemplate);case 8:this.viewportUpdatedCallback(),t.next=12;break;case 11:this.isOffline&&this.createCamerasFromEditor();case 12:case"end":return t.stop()}}),t,this)}))),function(){return E.apply(this,arguments)})},{key:"createCamerasFromEditor",value:(v=h(regeneratorRuntime.mark((function t(){var e,n,r,i,o,a,s,u,c,h,f,l,p,d,v,y;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.offlineRegisterPromise;case 2:this.defaultCameras=[],e=this.getActiveViewports(),n=e.map((function(t){return t.getCamera()})),r=n.map((function(t){return t.UNSAFE_getComponent("euid").rtid})),i=!0,o=!1,a=void 0,t.prev=9,s=e[Symbol.iterator]();case 11:if(i=(u=s.next()).done){t.next=22;break}return c=u.value,t.next=15,this.createOrGetDefaultCamera(c,c.getTransform(),c.getProjection(),c.getCamera().controller.type,c.projectionType==w,!1);case 15:h=t.sent,c.setCamera(h),c.frameTransform=null,c.setFrameTransform(h);case 19:i=!0,t.next=11;break;case 22:t.next=28;break;case 24:t.prev=24,t.t0=t.catch(9),o=!0,a=t.t0;case 28:t.prev=28,t.prev=29,i||null==s.return||s.return();case 31:if(t.prev=31,!o){t.next=34;break}throw a;case 34:return t.finish(31);case 35:return t.finish(28);case 36:for(this.updateViewports(),f=!0,l=!1,p=void 0,t.prev=40,d=n[Symbol.iterator]();!(f=(v=d.next()).done);f=!0)y=v.value,this.deleteController(y.controller);t.next=48;break;case 44:t.prev=44,t.t1=t.catch(40),l=!0,p=t.t1;case 48:t.prev=48,t.prev=49,f||null==d.return||d.return();case 51:if(t.prev=51,!l){t.next=54;break}throw p;case 54:return t.finish(51);case 55:return t.finish(48);case 56:this.engineAPI.ftlAPI.deleteEntities(r),this.isOffline=!1;case 58:case"end":return t.stop()}}),t,this,[[9,24,28,36],[29,,31,35],[40,44,48,56],[49,,51,55]])}))),function(){return v.apply(this,arguments)})},{key:"setEditorTimeout",value:function(t){this.editorTimeoutMilliseconds=t}},{key:"setViewports",value:function(t){var e=this;return new Promise((function(n,r){e.viewportRequestQueue.push({viewports:t},(function(t){t?r(t):n()}))}))}},{key:"requestRegisterViewports",value:(c=h(regeneratorRuntime.mark((function t(e){var n,r,i=this;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.viewportsTemplate=e||[],null===e&&(this.registeredViewports=[],this.updateViewports()),this.isEditorConnected){t.next=16;break}if(n=!0,!this.isOffline){t.next=9;break}return t.next=7,this.registerViewports(this.viewportsTemplate,n);case 7:t.next=14;break;case 9:if(this.editorTimeout){t.next=14;break}return r=new Promise((function(t){i.viewportUpdatedCallback=t})),this.editorTimeout=setTimeout(h(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i.editorTimeout=null,i.isOffline=!0,i.offlineRegisterPromise=i.registerViewports(i.viewportsTemplate,n),t.next=5,i.offlineRegisterPromise;case 5:i.viewportUpdatedCallback();case 6:case"end":return t.stop()}}),t,this)}))),this.editorTimeoutMilliseconds),t.next=14,r;case 14:t.next=18;break;case 16:return t.next=18,this.registerViewports(this.viewportsTemplate);case 18:case"end":return t.stop()}}),t,this)}))),function(t){return c.apply(this,arguments)})},{key:"registerViewports",value:(a=h(regeneratorRuntime.mark((function t(e){var n,r,i,o,a,s,u,c,h,f,l,p,d=arguments;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n=d.length>1&&void 0!==d[1]&&d[1],r=this.registeredViewports.filter((function(t){return-1==e.findIndex((function(e){return t.id===e.id}))})),this.registeredViewports=[],i=!0,o=!1,a=void 0,t.prev=6,s=e[Symbol.iterator]();case 8:if(i=(u=s.next()).done){t.next=28;break}if(c=u.value,h=c.camera,f=!!h,(l=this.registerViewport(c.id)).setProperties(c),f){t.next=18;break}return t.next=17,this.createOrGetDefaultCamera(l,c.defaultTransform,c.defaultProjection,c.defaultControllerType||m,c.isOrthographic||!1,n);case 17:h=t.sent;case 18:l.setFrameTransform(h),c.defaultTransform&&(l.defaultTransform=c.defaultTransform),c.defaultProjection&&(l.defaultProjection=c.defaultProjection),(p=h!==this.defaultCameras[c.id])&&(this.currentViewportEnabled&&(this.currentViewportEnabled.id,c.id),this.setActiveViewport(null)),l.setCamera(h,p,f),l.setProjectionType(c.isOrthographic?w:g,f);case 25:i=!0,t.next=8;break;case 28:t.next=34;break;case 30:t.prev=30,t.t0=t.catch(6),o=!0,a=t.t0;case 34:t.prev=34,t.prev=35,i||null==s.return||s.return();case 37:if(t.prev=37,!o){t.next=40;break}throw a;case 40:return t.finish(37);case 41:return t.finish(34);case 42:n||this.engineAPI.commitChanges(),this.updateViewports(),r.length>0&&this.releaseViewports(r);case 45:case"end":return t.stop()}}),t,this,[[6,30,34,42],[35,,37,41]])}))),function(t){return a.apply(this,arguments)})},{key:"updateViewports",value:function(){this.streamer.updateViewports(this.registeredViewports),this.notifier.emit("onViewportsUpdated",this.registeredViewports)}},{key:"releaseViewports",value:function(t){var e=[],n=!0,r=!1,i=void 0;try{for(var o,a=t[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var s=o.value,u=s.getCamera();u&&!s.isAttachedOnExistingCamera&&(this.deleteController(u.controller),e.push(u)),this.defaultCameras[s.id]=null}}catch(t){r=!0,i=t}finally{try{n||null==a.return||a.return()}finally{if(r)throw i}}this.engineAPI.deleteEntities(e)}},{key:"getControllerType",value:function(t){var e=this.getViewportByID(t).getCamera();return e&&e.controller?e.controller.type:null}},{key:"setControllerType",value:function(t,e){var n=this.getViewportByID(t),r=n.cameraEntity;if(r&&r.hasOwnProperty("controller")){this.deleteController(r.controller);var i=!!this.currentViewportEnabled&&n.id==this.currentViewportEnabled.id;r.controller=this.createController(e,r,i)}}},{key:"getUserName",value:(n=h(regeneratorRuntime.mark((function t(){var e;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!this.userName){t.next=2;break}return t.abrupt("return",this.userName);case 2:if(!SDK3DVerse.webAPI.apiToken){t.next=12;break}return t.prev=3,t.next=6,SDK3DVerse.webAPI.getUserProfile();case 6:return e=t.sent,t.abrupt("return",this.userName=e.username);case 10:t.prev=10,t.t0=t.catch(3);case 12:return t.abrupt("return",this.userName="Unnamed");case 13:case"end":return t.stop()}}),t,this,[[3,10]])}))),function(){return n.apply(this,arguments)})},{key:"createOrGetDefaultCamera",value:(e=h(regeneratorRuntime.mark((function t(e,n,r,i,o,a){var u,c,h,f,p;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(u=this.defaultCameras[e.id]){t.next=29;break}if(!a){t.next=6;break}t.t0="offline",t.next=9;break;case 6:return t.next=8,this.getUserName();case 8:t.t0=t.sent;case 9:if(c=t.t0,h=c+" camera "+(e.id+1),f=l({},s.a.clone(this.defaultCameraTemplate),{debug_name:{value:h}}),r&&(f.camera=r),f.camera.aspectRatio=e.aspectRatio,f.camera.isOrthographic=o,o&&(f.camera.fovy=1,f.camera.nearPlane=0),n?f.local_transform=n:SDK3DVerse.engineAPI.editorAPI.sceneSettings.hasOwnProperty("default_camera_transform")?(f.local_transform=SDK3DVerse.engineAPI.editorAPI.sceneSettings.default_camera_transform,f.local_transform.scale=[1,1,1]):f.local_transform=s.a.clone(s.a.getIdentityTransform()),!a){t.next=21;break}u=this.engineAPI.transientEntity(f),t.next=24;break;case 21:return t.next=23,this.engineAPI.spawnEntity(null,f);case 23:u=t.sent;case 24:p=this.currentViewportEnabled?this.currentViewportEnabled.id==e.id:0==e.id,u.controller=this.createController(i,u,p),p&&null==this.currentViewportEnabled&&(this.currentViewportEnabled=e),this.defaultCameras[e.id]=u,u.isCreatedByClient=!0;case 29:return t.abrupt("return",u);case 30:case"end":return t.stop()}}),t,this)}))),function(t,n,r,i,o,a){return e.apply(this,arguments)})},{key:"createController",value:function(t,e,n){return this.engineAPI.ftlAPI.createController(t,e.UNSAFE_getComponent("euid").rtid,n),{id:this.globalControllerID++,type:t}}},{key:"deleteController",value:function(t){this.engineAPI.ftlAPI.deleteController(t.id)}},{key:"onFrameDataReceived",value:function(t){if(t.clientUUID){this.currentClientUUID=t.clientUUID;for(var e=t.clients[this.currentClientUUID],n=[],r=0;r<e.viewports.length;++r){var i=e.viewports[r],o=this.registeredViewports.filter((function(t){return i.cameraRTID==(t.cameraEntity?t.cameraEntity.getID():"0")})),a=!0,s=!1,u=void 0;try{for(var c,h=o[Symbol.iterator]();!(a=(c=h.next()).done);a=!0){var f=c.value;f.disableUpdate||(f.setWorldMatrix(i.worldMatrix),n.push(f.cameraEntity))}}catch(t){s=!0,u=t}finally{try{a||null==h.return||h.return()}finally{if(s)throw u}}}n.length>0&&this.notifier.emit("OnCamerasUpdated",n)}}},{key:"refresh",value:function(){if(this.currentViewportEnabled&&this.currentViewportEnabled.cameraEntity){var t=this.currentViewportEnabled.cameraEntity;t.UNSAFE_setComponent("local_transform",this.currentViewportEnabled.getTransform()),t.UNSAFE_setDirty("local_transform"),this.engineAPI.ftlAPI.propagateChanges([t])}}},{key:"travel",value:function(t,e,n,o){var a,s,c,h,f=this;this.streamer.inputRelay.uninstallListeners();var l={position:(a=r).fromValues.apply(a,u(t.getTransform().position)),orientation:(s=i).fromValues.apply(s,u(t.getTransform().orientation))},p={position:(c=r).fromValues.apply(c,u(e)),orientation:(h=i).fromValues.apply(h,u(n))},d=1/(30*(r.distance(l.position,p.position)/o)),v=0;this.interval&&clearInterval(this.interval),this.interval=setInterval((function(){v+=d;var e=Math.min(f.smoothStep(v),1),n=r.create(),o=i.create();r.lerp(n,l.position,p.position,e),i.slerp(o,l.orientation,p.orientation,e),t.setTransform({position:Array.from(n),orientation:Array.from(o),scale:[1,1,1]}),e>=1&&(clearInterval(f.interval),f.interval=null,f.streamer.inputRelay.installListeners())}),1e3/30)}},{key:"smoothStep",value:function(t){return t*t*t*(t*(6*t-15)+10)}}]),t}();e.a=E}).call(this,n(94),n(12),n(91))},function(t,e,n){"use strict";function r(t){return function(...e){var n=e.pop();return t.call(this,e,n)}}var i="function"==typeof setImmediate&&setImmediate,o="object"==typeof process&&"function"==typeof process.nextTick;function a(t){setTimeout(t,0)}function s(t){return(e,...n)=>t(()=>e(...n))}var u=s(i?setImmediate:o?process.nextTick:a);function c(t){return l(t)?function(...e){const n=e.pop();return h(t.apply(this,e),n)}:r((function(e,n){var r;try{r=t.apply(this,e)}catch(t){return n(t)}if(r&&"function"==typeof r.then)return h(r,n);n(null,r)}))}function h(t,e){return t.then(t=>{f(e,null,t)},t=>{f(e,t&&t.message?t:new Error(t))})}function f(t,e,n){try{t(e,n)}catch(t){u(t=>{throw t},t)}}function l(t){return"AsyncFunction"===t[Symbol.toStringTag]}function p(t){if("function"!=typeof t)throw new Error("expected a function");return l(t)?c(t):t}function d(t,e=t.length){if(!e)throw new Error("arity is undefined");function n(...n){return"function"==typeof n[e-1]?t.apply(this,n):new Promise((r,i)=>{n[e-1]=(t,...e)=>{if(t)return i(t);r(e.length>1?e:e[0])},t.apply(this,n)})}return Object.defineProperty(n,"name",{value:`awaitable(${t.name})`}),n}function v(t){return function(e,...n){return d((function(r){var i=this;return t(e,(t,e)=>{p(t).apply(i,n.concat(e))},r)}))}}function y(t,e,n,r){e=e||[];var i=[],o=0,a=p(n);return t(e,(t,e,n)=>{var r=o++;a(t,(t,e)=>{i[r]=e,n(t)})},t=>{r(t,i)})}function m(t){return t&&"number"==typeof t.length&&t.length>=0&&t.length%1==0}const g={};function w(t){function e(...e){if(null!==t){var n=t;t=null,n.apply(this,e)}}return Object.assign(e,t),e}function b(t){if(m(t))return function(t){var e=-1,n=t.length;return function(){return++e<n?{value:t[e],key:e}:null}}(t);var e,n,r,i,o=function(t){return t[Symbol.iterator]&&t[Symbol.iterator]()}(t);return o?function(t){var e=-1;return function(){var n=t.next();return n.done?null:(e++,{value:n.value,key:e})}}(o):(n=(e=t)?Object.keys(e):[],r=-1,i=n.length,function(){var t=n[++r];return r<i?{value:e[t],key:t}:null})}function E(t){return function(...e){if(null===t)throw new Error("Callback was already called.");var n=t;t=null,n.apply(this,e)}}function _(t,e,n,r){let i=!1,o=!1,a=!1,s=0,u=0;function c(){s>=e||a||i||(a=!0,t.next().then(({value:t,done:e})=>{if(!o&&!i){if(a=!1,e)return i=!0,void(s<=0&&r(null));s++,n(t,u,h),u++,c()}}).catch(f))}function h(t,e){if(s-=1,!o)return t?f(t):!1===t?(i=!0,void(o=!0)):e===g||i&&s<=0?(i=!0,r(null)):void c()}function f(t){o||(a=!1,i=!0,r(t))}c()}var A=t=>(e,n,r)=>{if(r=w(r),t<=0)throw new RangeError("concurrency limit cannot be less than 1");if(!e)return r(null);if("AsyncGenerator"===e[Symbol.toStringTag])return _(e,t,n,r);if(function(t){return"function"==typeof t[Symbol.asyncIterator]}(e))return _(e[Symbol.asyncIterator](),t,n,r);var i=b(e),o=!1,a=!1,s=0,u=!1;function c(t,e){if(!a)if(s-=1,t)o=!0,r(t);else if(!1===t)o=!0,a=!0;else{if(e===g||o&&s<=0)return o=!0,r(null);u||h()}}function h(){for(u=!0;s<t&&!o;){var e=i();if(null===e)return o=!0,void(s<=0&&r(null));s+=1,n(e.value,e.key,E(c))}u=!1}h()};var x=d((function(t,e,n,r){return A(e)(t,p(n),r)}),4);function k(t,e,n){n=w(n);var r=0,i=0,{length:o}=t,a=!1;function s(t,e){!1===t&&(a=!0),!0!==a&&(t?n(t):++i!==o&&e!==g||n(null))}for(0===o&&n(null);r<o;r++)e(t[r],r,E(s))}function T(t,e,n){return x(t,1/0,e,n)}var S=d((function(t,e,n){return(m(t)?k:T)(t,p(e),n)}),3);var C=d((function(t,e,n){return y(S,t,e,n)}),3),R=v(C);var P=d((function(t,e,n){return x(t,1,e,n)}),3);var I=d((function(t,e,n){return y(P,t,e,n)}),3),M=v(I);const U=Symbol("promiseCallback");function O(){let t,e;function n(n,...r){if(n)return e(n);t(r.length>1?r:r[0])}return n[U]=new Promise((n,r)=>{t=n,e=r}),n}function D(t,e,n){"number"!=typeof e&&(n=e,e=null),n=w(n||O());var r=Object.keys(t).length;if(!r)return n(null);e||(e=r);var i={},o=0,a=!1,s=!1,u=Object.create(null),c=[],h=[],f={};function l(t,e){c.push(()=>function(t,e){if(s)return;var r=E((e,...r)=>{if(o--,!1!==e)if(r.length<2&&([r]=r),e){var c={};if(Object.keys(i).forEach(t=>{c[t]=i[t]}),c[t]=r,s=!0,u=Object.create(null),a)return;n(e,c)}else i[t]=r,(u[t]||[]).forEach(t=>t()),d();else a=!0});o++;var c=p(e[e.length-1]);e.length>1?c(i,r):c(r)}(t,e))}function d(){if(!a){if(0===c.length&&0===o)return n(null,i);for(;c.length&&o<e;){c.shift()()}}}function v(e){var n=[];return Object.keys(t).forEach(r=>{const i=t[r];Array.isArray(i)&&i.indexOf(e)>=0&&n.push(r)}),n}return Object.keys(t).forEach(e=>{var n=t[e];if(!Array.isArray(n))return l(e,[n]),void h.push(e);var r=n.slice(0,n.length-1),i=r.length;if(0===i)return l(e,n),void h.push(e);f[e]=i,r.forEach(o=>{if(!t[o])throw new Error("async.auto task `"+e+"` has a non-existent dependency `"+o+"` in "+r.join(", "));!function(t,e){var n=u[t];n||(n=u[t]=[]);n.push(e)}(o,()=>{0===--i&&l(e,n)})})}),function(){var t,e=0;for(;h.length;)t=h.pop(),e++,v(t).forEach(t=>{0==--f[t]&&h.push(t)});if(e!==r)throw new Error("async.auto cannot execute tasks due to a recursive dependency")}(),d(),n[U]}var L=/^(?:async\s+)?(?:function)?\s*\w*\s*\(\s*([^)]+)\s*\)(?:\s*{)/,N=/^(?:async\s+)?\(?\s*([^)=]+)\s*\)?(?:\s*=>)/,F=/,/,B=/(=.+)?(\s*)$/,V=/((\/\/.*$)|(\/\*[\s\S]*?\*\/))/gm;class j{constructor(){this.head=this.tail=null,this.length=0}removeLink(t){return t.prev?t.prev.next=t.next:this.head=t.next,t.next?t.next.prev=t.prev:this.tail=t.prev,t.prev=t.next=null,this.length-=1,t}empty(){for(;this.head;)this.shift();return this}insertAfter(t,e){e.prev=t,e.next=t.next,t.next?t.next.prev=e:this.tail=e,t.next=e,this.length+=1}insertBefore(t,e){e.prev=t.prev,e.next=t,t.prev?t.prev.next=e:this.head=e,t.prev=e,this.length+=1}unshift(t){this.head?this.insertBefore(this.head,t):Y(this,t)}push(t){this.tail?this.insertAfter(this.tail,t):Y(this,t)}shift(){return this.head&&this.removeLink(this.head)}pop(){return this.tail&&this.removeLink(this.tail)}toArray(){return[...this]}*[Symbol.iterator](){for(var t=this.head;t;)yield t.data,t=t.next}remove(t){for(var e=this.head;e;){var{next:n}=e;t(e)&&this.removeLink(e),e=n}return this}}function Y(t,e){t.length=1,t.head=t.tail=e}function G(t,e,n){if(null==e)e=1;else if(0===e)throw new RangeError("Concurrency must not be zero");var r=p(t),i=0,o=[];const a={error:[],drain:[],saturated:[],unsaturated:[],empty:[]};function s(t,e){return t?e?void(a[t]=a[t].filter(t=>t!==e)):a[t]=[]:Object.keys(a).forEach(t=>a[t]=[])}function c(t,...e){a[t].forEach(t=>t(...e))}var h=!1;function f(t,e,n,r){if(null!=r&&"function"!=typeof r)throw new Error("task callback must be a function");var i,o;function a(t,...e){return t?n?o(t):i():e.length<=1?i(e[0]):void i(e)}m.started=!0;var s={data:t,callback:n?a:r||a};if(e?m._tasks.unshift(s):m._tasks.push(s),h||(h=!0,u(()=>{h=!1,m.process()})),n||!r)return new Promise((t,e)=>{i=t,o=e})}function l(t){return function(e,...n){i-=1;for(var r=0,a=t.length;r<a;r++){var s=t[r],u=o.indexOf(s);0===u?o.shift():u>0&&o.splice(u,1),s.callback(e,...n),null!=e&&c("error",e,s.data)}i<=m.concurrency-m.buffer&&c("unsaturated"),m.idle()&&c("drain"),m.process()}}function d(t){return!(0!==t.length||!m.idle())&&(u(()=>c("drain")),!0)}const v=t=>e=>{if(!e)return new Promise((e,n)=>{!function(t,e){const n=(...r)=>{s(t,n),e(...r)};a[t].push(n)}(t,(t,r)=>{if(t)return n(t);e(r)})});s(t),function(t,e){a[t].push(e)}(t,e)};var y=!1,m={_tasks:new j,*[Symbol.iterator](){yield*m._tasks[Symbol.iterator]()},concurrency:e,payload:n,buffer:e/4,started:!1,paused:!1,push(t,e){if(Array.isArray(t)){if(d(t))return;return t.map(t=>f(t,!1,!1,e))}return f(t,!1,!1,e)},pushAsync(t,e){if(Array.isArray(t)){if(d(t))return;return t.map(t=>f(t,!1,!0,e))}return f(t,!1,!0,e)},kill(){s(),m._tasks.empty()},unshift(t,e){if(Array.isArray(t)){if(d(t))return;return t.map(t=>f(t,!0,!1,e))}return f(t,!0,!1,e)},unshiftAsync(t,e){if(Array.isArray(t)){if(d(t))return;return t.map(t=>f(t,!0,!0,e))}return f(t,!0,!0,e)},remove(t){m._tasks.remove(t)},process(){if(!y){for(y=!0;!m.paused&&i<m.concurrency&&m._tasks.length;){var t=[],e=[],n=m._tasks.length;m.payload&&(n=Math.min(n,m.payload));for(var a=0;a<n;a++){var s=m._tasks.shift();t.push(s),o.push(s),e.push(s.data)}i+=1,0===m._tasks.length&&c("empty"),i===m.concurrency&&c("saturated");var u=E(l(t));r(e,u)}y=!1}},length:()=>m._tasks.length,running:()=>i,workersList:()=>o,idle:()=>m._tasks.length+i===0,pause(){m.paused=!0},resume(){!1!==m.paused&&(m.paused=!1,u(m.process))}};return Object.defineProperties(m,{saturated:{writable:!1,value:v("saturated")},unsaturated:{writable:!1,value:v("unsaturated")},empty:{writable:!1,value:v("empty")},drain:{writable:!1,value:v("drain")},error:{writable:!1,value:v("error")}}),m}var W=d((function(t,e,n,r){r=w(r);var i=p(n);return P(t,(t,n,r)=>{i(e,t,(t,n)=>{e=n,r(t)})},t=>r(t,e))}),4);function q(...t){var e=t.map(p);return function(...t){var n=this,r=t[t.length-1];return"function"==typeof r?t.pop():r=O(),W(e,t,(t,e,r)=>{e.apply(n,t.concat((t,...e)=>{r(t,e)}))},(t,e)=>r(t,...e)),r[U]}}var z=d((function(t,e,n,r){return y(A(e),t,n,r)}),4);var X=d((function(t,e,n,r){var i=p(n);return z(t,e,(t,e)=>{i(t,(t,...n)=>t?e(t):e(t,n))},(t,e)=>{for(var n=[],i=0;i<e.length;i++)e[i]&&(n=n.concat(...e[i]));return r(t,n)})}),4);var H=d((function(t,e,n){return X(t,1/0,e,n)}),3);var K=d((function(t,e,n){return X(t,1,e,n)}),3);function J(t,e){return(n,r,i,o)=>{var a,s=!1;const u=p(i);n(r,(n,r,i)=>{u(n,(r,o)=>r||!1===r?i(r):t(o)&&!a?(s=!0,a=e(!0,n),i(null,g)):void i())},t=>{if(t)return o(t);o(null,s?a:e(!1))})}}var Q=d((function(t,e,n){return J(t=>t,(t,e)=>e)(S,t,e,n)}),3);var $=d((function(t,e,n,r){return J(t=>t,(t,e)=>e)(A(e),t,n,r)}),4);var Z=d((function(t,e,n){return J(t=>t,(t,e)=>e)(A(1),t,e,n)}),3);function tt(t){return(e,...n)=>p(e)(...n,(e,...n)=>{"object"==typeof console&&(e?console.error&&console.error(e):console[t]&&n.forEach(e=>console[t](e)))})}var et=tt("dir");var nt=d((function(t,e,n){n=E(n);var r,i=p(t),o=p(e);function a(t,...e){if(t)return n(t);!1!==t&&(r=e,o(...e,s))}function s(t,e){return t?n(t):!1!==t?e?void i(a):n(null,...r):void 0}return s(null,!0)}),3);function rt(t){return(e,n,r)=>t(e,r)}var it=d((function(t,e,n){return S(t,rt(p(e)),n)}),3);var ot=d((function(t,e,n,r){return A(e)(t,rt(p(n)),r)}),4);var at=d((function(t,e,n){return ot(t,1,e,n)}),3);function st(t){return l(t)?t:function(...e){var n=e.pop(),r=!0;e.push((...t)=>{r?u(()=>n(...t)):n(...t)}),t.apply(this,e),r=!1}}var ut=d((function(t,e,n){return J(t=>!t,t=>!t)(S,t,e,n)}),3);var ct=d((function(t,e,n,r){return J(t=>!t,t=>!t)(A(e),t,n,r)}),4);var ht=d((function(t,e,n){return J(t=>!t,t=>!t)(P,t,e,n)}),3);function ft(t,e,n,r){var i=new Array(e.length);t(e,(t,e,r)=>{n(t,(t,n)=>{i[e]=!!n,r(t)})},t=>{if(t)return r(t);for(var n=[],o=0;o<e.length;o++)i[o]&&n.push(e[o]);r(null,n)})}function lt(t,e,n,r){var i=[];t(e,(t,e,r)=>{n(t,(n,o)=>{if(n)return r(n);o&&i.push({index:e,value:t}),r(n)})},t=>{if(t)return r(t);r(null,i.sort((t,e)=>t.index-e.index).map(t=>t.value))})}function pt(t,e,n,r){return(m(e)?ft:lt)(t,e,p(n),r)}var dt=d((function(t,e,n){return pt(S,t,e,n)}),3);var vt=d((function(t,e,n,r){return pt(A(e),t,n,r)}),4);var yt=d((function(t,e,n){return pt(P,t,e,n)}),3);var mt=d((function(t,e){var n=E(e),r=p(st(t));return function t(e){if(e)return n(e);!1!==e&&r(t)}()}),2);var gt=d((function(t,e,n,r){var i=p(n);return z(t,e,(t,e)=>{i(t,(n,r)=>n?e(n):e(n,{key:r,val:t}))},(t,e)=>{for(var n={},{hasOwnProperty:i}=Object.prototype,o=0;o<e.length;o++)if(e[o]){var{key:a}=e[o],{val:s}=e[o];i.call(n,a)?n[a].push(s):n[a]=[s]}return r(t,n)})}),4);var wt=tt("log");var bt=d((function(t,e,n,r){r=w(r);var i={},o=p(n);return A(e)(t,(t,e,n)=>{o(t,e,(t,r)=>{if(t)return n(t);i[e]=r,n(t)})},t=>r(t,i))}),4);var Et=s(o?process.nextTick:i?setImmediate:a),_t=d((t,e,n)=>{var r=m(e)?[]:{};t(e,(t,e,n)=>{p(t)((t,...i)=>{i.length<2&&([i]=i),r[e]=i,n(t)})},t=>n(t,r))},3);function At(t,e){var n=p(t);return G((t,e)=>{n(t[0],e)},e,1)}class xt{constructor(){this.heap=[],this.pushCount=Number.MIN_SAFE_INTEGER}get length(){return this.heap.length}empty(){return this.heap=[],this}percUp(t){let e;for(;t>0&&Tt(this.heap[t],this.heap[e=kt(t)]);){let n=this.heap[t];this.heap[t]=this.heap[e],this.heap[e]=n,t=e}}percDown(t){let e;for(;(e=1+(t<<1))<this.heap.length&&(e+1<this.heap.length&&Tt(this.heap[e+1],this.heap[e])&&(e+=1),!Tt(this.heap[t],this.heap[e]));){let n=this.heap[t];this.heap[t]=this.heap[e],this.heap[e]=n,t=e}}push(t){t.pushCount=++this.pushCount,this.heap.push(t),this.percUp(this.heap.length-1)}unshift(t){return this.heap.push(t)}shift(){let[t]=this.heap;return this.heap[0]=this.heap[this.heap.length-1],this.heap.pop(),this.percDown(0),t}toArray(){return[...this]}*[Symbol.iterator](){for(let t=0;t<this.heap.length;t++)yield this.heap[t].data}remove(t){let e=0;for(let n=0;n<this.heap.length;n++)t(this.heap[n])||(this.heap[e]=this.heap[n],e++);this.heap.splice(e);for(let t=kt(this.heap.length-1);t>=0;t--)this.percDown(t);return this}}function kt(t){return(t+1>>1)-1}function Tt(t,e){return t.priority!==e.priority?t.priority<e.priority:t.pushCount<e.pushCount}var St=d((function(t,e){if(e=w(e),!Array.isArray(t))return e(new TypeError("First argument to race must be an array of functions"));if(!t.length)return e();for(var n=0,r=t.length;n<r;n++)p(t[n])(e)}),2);function Ct(t,e,n,r){var i=[...t].reverse();return W(i,e,n,r)}function Rt(t){var e=p(t);return r((function(t,n){return t.push((t,...e)=>{let r={};if(t&&(r.error=t),e.length>0){var i=e;e.length<=1&&([i]=e),r.value=i}n(null,r)}),e.apply(this,t)}))}function Pt(t,e,n,r){const i=p(n);return pt(t,e,(t,e)=>{i(t,(t,n)=>{e(t,!n)})},r)}var It=d((function(t,e,n){return Pt(S,t,e,n)}),3);var Mt=d((function(t,e,n,r){return Pt(A(e),t,n,r)}),4);var Ut=d((function(t,e,n){return Pt(P,t,e,n)}),3);function Ot(t){return function(){return t}}function Dt(t,e,n){var r={times:5,intervalFunc:Ot(0)};if(arguments.length<3&&"function"==typeof t?(n=e||O(),e=t):(Lt(r,t),n=n||O()),"function"!=typeof e)throw new Error("Invalid arguments for async.retry");var i=p(e),o=1;function a(){i((t,...e)=>{!1!==t&&(t&&o++<r.times&&("function"!=typeof r.errorFilter||r.errorFilter(t))?setTimeout(a,r.intervalFunc(o-1)):n(t,...e))})}return a(),n[U]}function Lt(t,e){if("object"==typeof e)t.times=+e.times||5,t.intervalFunc="function"==typeof e.interval?e.interval:Ot(+e.interval||0),t.errorFilter=e.errorFilter;else{if("number"!=typeof e&&"string"!=typeof e)throw new Error("Invalid arguments for async.retry");t.times=+e||5}}var Nt=d((function(t,e,n){return J(Boolean,t=>t)(S,t,e,n)}),3);var Ft=d((function(t,e,n,r){return J(Boolean,t=>t)(A(e),t,n,r)}),4);var Bt=d((function(t,e,n){return J(Boolean,t=>t)(P,t,e,n)}),3);var Vt=d((function(t,e,n){var r=p(e);return C(t,(t,e)=>{r(t,(n,r)=>{if(n)return e(n);e(n,{value:t,criteria:r})})},(t,e)=>{if(t)return n(t);n(null,e.sort(i).map(t=>t.value))});function i(t,e){var n=t.criteria,r=e.criteria;return n<r?-1:n>r?1:0}}),3);function jt(t,e,n,r){var i=p(n);return z(function(t){for(var e=Array(t);t--;)e[t]=t;return e}(t),e,i,r)}var Yt=d((function(t,e){var n,r=null;return at(t,(t,e)=>{p(t)((t,...i)=>{if(!1===t)return e(t);i.length<2?[n]=i:n=i,r=t,e(t?null:{})})},()=>e(r,n))}));var Gt=d((function(t,e,n){n=E(n);var r=p(e),i=p(t),o=[];function a(t,...e){if(t)return n(t);o=e,!1!==t&&i(s)}function s(t,e){return t?n(t):!1!==t?e?void r(a):n(null,...o):void 0}return i(s)}),3);var Wt=d((function(t,e){if(e=w(e),!Array.isArray(t))return e(new Error("First argument to waterfall must be an array of functions"));if(!t.length)return e();var n=0;function r(e){p(t[n++])(...e,E(i))}function i(i,...o){if(!1!==i)return i||n===t.length?e(i,...o):void r(o)}r([])})),qt={apply:function(t,...e){return(...n)=>t(...e,...n)},applyEach:R,applyEachSeries:M,asyncify:c,auto:D,autoInject:function(t,e){var n={};return Object.keys(t).forEach(e=>{var r,i=t[e],o=l(i),a=!o&&1===i.length||o&&0===i.length;if(Array.isArray(i))r=[...i],i=r.pop(),n[e]=r.concat(r.length>0?s:i);else if(a)n[e]=i;else{if(r=function(t){const e=t.toString().replace(V,"");let n=e.match(L);if(n||(n=e.match(N)),!n)throw new Error("could not parse args in autoInject\nSource:\n"+e);let[,r]=n;return r.replace(/\s/g,"").split(F).map(t=>t.replace(B,"").trim())}(i),0===i.length&&!o&&0===r.length)throw new Error("autoInject task functions require explicit parameters.");o||r.pop(),n[e]=r.concat(s)}function s(t,e){var n=r.map(e=>t[e]);n.push(e),p(i)(...n)}}),D(n,e)},cargo:function(t,e){return G(t,1,e)},cargoQueue:function(t,e,n){return G(t,e,n)},compose:function(...t){return q(...t.reverse())},concat:H,concatLimit:X,concatSeries:K,constant:function(...t){return function(...e){return e.pop()(null,...t)}},detect:Q,detectLimit:$,detectSeries:Z,dir:et,doUntil:function(t,e,n){const r=p(e);return nt(t,(...t)=>{const e=t.pop();r(...t,(t,n)=>e(t,!n))},n)},doWhilst:nt,each:it,eachLimit:ot,eachOf:S,eachOfLimit:x,eachOfSeries:P,eachSeries:at,ensureAsync:st,every:ut,everyLimit:ct,everySeries:ht,filter:dt,filterLimit:vt,filterSeries:yt,forever:mt,groupBy:function(t,e,n){return gt(t,1/0,e,n)},groupByLimit:gt,groupBySeries:function(t,e,n){return gt(t,1,e,n)},log:wt,map:C,mapLimit:z,mapSeries:I,mapValues:function(t,e,n){return bt(t,1/0,e,n)},mapValuesLimit:bt,mapValuesSeries:function(t,e,n){return bt(t,1,e,n)},memoize:function(t,e=(t=>t)){var n=Object.create(null),i=Object.create(null),o=p(t),a=r((t,r)=>{var a=e(...t);a in n?u(()=>r(null,...n[a])):a in i?i[a].push(r):(i[a]=[r],o(...t,(t,...e)=>{t||(n[a]=e);var r=i[a];delete i[a];for(var o=0,s=r.length;o<s;o++)r[o](t,...e)}))});return a.memo=n,a.unmemoized=t,a},nextTick:Et,parallel:function(t,e){return _t(S,t,e)},parallelLimit:function(t,e,n){return _t(A(e),t,n)},priorityQueue:function(t,e){var n=At(t,e);return n._tasks=new xt,n.push=function(t,e=0,r=(()=>{})){if("function"!=typeof r)throw new Error("task callback must be a function");if(n.started=!0,Array.isArray(t)||(t=[t]),0===t.length&&n.idle())return u(()=>n.drain());for(var i=0,o=t.length;i<o;i++){var a={data:t[i],priority:e,callback:r};n._tasks.push(a)}u(n.process)},delete n.unshift,n},queue:At,race:St,reduce:W,reduceRight:Ct,reflect:Rt,reflectAll:function(t){var e;return Array.isArray(t)?e=t.map(Rt):(e={},Object.keys(t).forEach(n=>{e[n]=Rt.call(this,t[n])})),e},reject:It,rejectLimit:Mt,rejectSeries:Ut,retry:Dt,retryable:function(t,e){e||(e=t,t=null);let n=t&&t.arity||e.length;l(e)&&(n+=1);var i=p(e);return r((e,r)=>{function o(t){i(...e,t)}return(e.length<n-1||null==r)&&(e.push(r),r=O()),t?Dt(t,o,r):Dt(o,r),r[U]})},seq:q,series:function(t,e){return _t(P,t,e)},setImmediate:u,some:Nt,someLimit:Ft,someSeries:Bt,sortBy:Vt,timeout:function(t,e,n){var i=p(t);return r((r,o)=>{var a,s=!1;r.push((...t)=>{s||(o(...t),clearTimeout(a))}),a=setTimeout((function(){var e=t.name||"anonymous",r=new Error('Callback function "'+e+'" timed out.');r.code="ETIMEDOUT",n&&(r.info=n),s=!0,o(r)}),e),i(...r)})},times:function(t,e,n){return jt(t,1/0,e,n)},timesLimit:jt,timesSeries:function(t,e,n){return jt(t,1,e,n)},transform:function(t,e,n,r){arguments.length<=3&&"function"==typeof e&&(r=n,n=e,e=Array.isArray(t)?[]:{}),r=w(r||O());var i=p(n);return S(t,(t,n,r)=>{i(e,t,n,r)},t=>r(t,e)),r[U]},tryEach:Yt,unmemoize:function(t){return(...e)=>(t.unmemoized||t)(...e)},until:function(t,e,n){const r=p(t);return Gt(t=>r((e,n)=>t(e,!n)),e,n)},waterfall:Wt,whilst:Gt,all:ut,allLimit:ct,allSeries:ht,any:Nt,anyLimit:Ft,anySeries:Bt,find:Q,findLimit:$,findSeries:Z,flatMap:H,flatMapLimit:X,flatMapSeries:K,forEach:it,forEachSeries:at,forEachLimit:ot,forEachOf:S,forEachOfSeries:P,forEachOfLimit:x,inject:W,foldl:W,foldr:Ct,select:dt,selectLimit:vt,selectSeries:yt,wrapSync:c,during:Gt,doDuring:nt};e.a=qt},function(t,e,n){var r=n(213),i=n(214),o=i;o.v1=r,o.v4=i,t.exports=o},function(t,e){function n(t,e){var n=t.length,r=new Array(n),i={},o=n,a=function(t){for(var e=new Map,n=0,r=t.length;n<r;n++){var i=t[n];e.has(i[0])||e.set(i[0],new Set),e.has(i[1])||e.set(i[1],new Set),e.get(i[0]).add(i[1])}return e}(e),s=function(t){for(var e=new Map,n=0,r=t.length;n<r;n++)e.set(t[n],n);return e}(t);for(e.forEach((function(t){if(!s.has(t[0])||!s.has(t[1]))throw new Error("Unknown node. There is an unknown node in the supplied edges.")}));o--;)i[o]||u(t[o],o,new Set);return r;function u(t,e,o){if(o.has(t)){var c;try{c=", node was:"+JSON.stringify(t)}catch(t){c=""}throw new Error("Cyclic dependency"+c)}if(!s.has(t))throw new Error("Found unknown node. Make sure to provided all involved nodes. Unknown node: "+JSON.stringify(t));if(!i[e]){i[e]=!0;var h=a.get(t)||new Set;if(e=(h=Array.from(h)).length){o.add(t);do{var f=h[--e];u(f,s.get(f),o)}while(e);o.delete(t)}r[--n]=t}}}t.exports=function(t){return n(function(t){for(var e=new Set,n=0,r=t.length;n<r;n++){var i=t[n];e.add(i[0]),e.add(i[1])}return Array.from(e)}(t),t)},t.exports.array=n},,,,,,,function(t,e,n){var r=n(248).default;t.exports=new r},function(t,e){var n,r,i=t.exports={};function o(){throw new Error("setTimeout has not been defined")}function a(){throw new Error("clearTimeout has not been defined")}function s(t){if(n===setTimeout)return setTimeout(t,0);if((n===o||!n)&&setTimeout)return n=setTimeout,setTimeout(t,0);try{return n(t,0)}catch(e){try{return n.call(null,t,0)}catch(e){return n.call(this,t,0)}}}!function(){try{n="function"==typeof setTimeout?setTimeout:o}catch(t){n=o}try{r="function"==typeof clearTimeout?clearTimeout:a}catch(t){r=a}}();var u,c=[],h=!1,f=-1;function l(){h&&u&&(h=!1,u.length?c=u.concat(c):f=-1,c.length&&p())}function p(){if(!h){var t=s(l);h=!0;for(var e=c.length;e;){for(u=c,c=[];++f<e;)u&&u[f].run();f=-1,e=c.length}u=null,h=!1,function(t){if(r===clearTimeout)return clearTimeout(t);if((r===a||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(t);try{r(t)}catch(e){try{return r.call(null,t)}catch(e){return r.call(this,t)}}}(t)}}function d(t,e){this.fun=t,this.array=e}function v(){}i.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];c.push(new d(t,e)),1!==c.length||h||s(p)},d.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=v,i.addListener=v,i.once=v,i.off=v,i.removeListener=v,i.removeAllListeners=v,i.emit=v,i.prependListener=v,i.prependOnceListener=v,i.listeners=function(t){return[]},i.binding=function(t){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(t){throw new Error("process.chdir is not supported")},i.umask=function(){return 0}},function(t,e,n){"use strict";var r=n(2),i=n(17),o=n(129),a="".startsWith;r(r.P+r.F*n(130)("startsWith"),"String",{startsWith:function(t){var e=o(this,t,"startsWith"),n=i(Math.min(arguments.length>1?arguments[1]:void 0,e.length)),r=String(t);return a?a.call(e,r,n):e.slice(n,n+r.length)===r}})},function(t,e,n){var r=n(2);r(r.S,"Math",{trunc:function(t){return(t>0?Math.floor:Math.ceil)(t)}})},function(t,e,n){var r=n(2);r(r.S,"Math",{clz32:function(t){return(t>>>=0)?31-Math.floor(Math.log(t+.5)*Math.LOG2E):32}})},function(t,e,n){var r=n(2);r(r.S,"Math",{fround:n(195)})},function(t,e,n){var r=n(196),i=Math.pow,o=i(2,-52),a=i(2,-23),s=i(2,127)*(2-a),u=i(2,-126);t.exports=Math.fround||function(t){var e,n,i=Math.abs(t),c=r(t);return i<u?c*(i/u/a+1/o-1/o)*u*a:(n=(e=(1+a/o)*i)-(e-i))>s||n!=n?c*(1/0):c*n}},function(t,e){t.exports=Math.sign||function(t){return 0==(t=+t)||t!=t?t:t<0?-1:1}},function(t,e,n){var r=n(2),i=Math.imul;r(r.S+r.F*n(9)((function(){return-5!=i(4294967295,5)||2!=i.length})),"Math",{imul:function(t,e){var n=+t,r=+e,i=65535&n,o=65535&r;return 0|i*o+((65535&n>>>16)*o+i*(65535&r>>>16)<<16>>>0)}})},function(t,e,n){n(110)("Float64",8,(function(t){return function(e,n,r){return t(this,e,n,r)}}))},function(t,e,n){n(110)("Uint32",4,(function(t){return function(e,n,r){return t(this,e,n,r)}}))},function(t,e,n){n(110)("Uint16",2,(function(t){return function(e,n,r){return t(this,e,n,r)}}))},function(t,e,n){n(110)("Int32",4,(function(t){return function(e,n,r){return t(this,e,n,r)}}))},function(t,e,n){n(110)("Int16",2,(function(t){return function(e,n,r){return t(this,e,n,r)}}))},function(t,e,n){n(110)("Int8",1,(function(t){return function(e,n,r){return t(this,e,n,r)}}))},function(t,e,n){var r=n(2);r(r.P,"Function",{bind:n(205)})},function(t,e,n){"use strict";var r=n(32),i=n(5),o=n(101),a=[].slice,s={},u=function(t,e,n){if(!(e in s)){for(var r=[],i=0;i<e;i++)r[i]="a["+i+"]";s[e]=Function("F,a","return new F("+r.join(",")+")")}return s[e](t,n)};t.exports=Function.bind||function(t){var e=r(this),n=a.call(arguments,1),s=function(){var r=n.concat(a.call(arguments));return this instanceof s?u(e,r.length,r):o(e,r,t)};return i(e.prototype)&&(s.prototype=e.prototype),s}},function(t,e,n){"use strict";var r=n(2),i=n(207),o=n(102);r(r.P+r.F*/Version\/10\.\d+(\.\d+)? Safari\//.test(o),"String",{padStart:function(t){return i(this,t,arguments.length>1?arguments[1]:void 0,!0)}})},function(t,e,n){var r=n(17),i=n(208),o=n(29);t.exports=function(t,e,n,a){var s=String(o(t)),u=s.length,c=void 0===n?" ":String(n),h=r(e);if(h<=u||""==c)return s;var f=h-u,l=i.call(c,Math.ceil(f/c.length));return l.length>f&&(l=l.slice(0,f)),a?l+s:s+l}},function(t,e,n){"use strict";var r=n(28),i=n(29);t.exports=function(t){var e=String(i(this)),n="",o=r(t);if(o<0||o==1/0)throw RangeError("Count can't be negative");for(;o>0;(o>>>=1)&&(e+=e))1&o&&(n+=e);return n}},function(t,e,n){var r=n(2);r(r.S+r.F*!n(7),"Object",{defineProperties:n(100)})},function(t,e,n){"use strict";var r=n(4),i=n(15),o=n(24),a=n(134),s=n(37),u=n(9),c=n(43).f,h=n(54).f,f=n(6).f,l=n(211).trim,p=r.Number,d=p,v=p.prototype,y="Number"==o(n(33)(v)),m="trim"in String.prototype,g=function(t){var e=s(t,!1);if("string"==typeof e&&e.length>2){var n,r,i,o=(e=m?e.trim():l(e,3)).charCodeAt(0);if(43===o||45===o){if(88===(n=e.charCodeAt(2))||120===n)return NaN}else if(48===o){switch(e.charCodeAt(1)){case 66:case 98:r=2,i=49;break;case 79:case 111:r=8,i=55;break;default:return+e}for(var a,u=e.slice(2),c=0,h=u.length;c<h;c++)if((a=u.charCodeAt(c))<48||a>i)return NaN;return parseInt(u,r)}}return+e};if(!p(" 0o1")||!p("0b1")||p("+0x1")){p=function(t){var e=arguments.length<1?0:t,n=this;return n instanceof p&&(y?u((function(){v.valueOf.call(n)})):"Number"!=o(n))?a(new d(g(e)),n,p):g(e)};for(var w,b=n(7)?c(d):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,isFinite,isInteger,isNaN,isSafeInteger,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,parseFloat,parseInt,isInteger".split(","),E=0;b.length>E;E++)i(d,w=b[E])&&!i(p,w)&&f(p,w,h(d,w));p.prototype=v,v.constructor=p,n(16)(r,"Number",p)}},function(t,e,n){var r=n(2),i=n(29),o=n(9),a=n(212),s="["+a+"]",u=RegExp("^"+s+s+"*"),c=RegExp(s+s+"*$"),h=function(t,e,n){var i={},s=o((function(){return!!a[t]()||"​"!="​"[t]()})),u=i[t]=s?e(f):a[t];n&&(i[n]=u),r(r.P+r.F*s,"String",i)},f=h.trim=function(t,e){return t=String(i(t)),1&e&&(t=t.replace(u,"")),2&e&&(t=t.replace(c,"")),t};t.exports=h},function(t,e){t.exports="\t\n\v\f\r   ᠎             　\u2028\u2029\ufeff"},function(t,e,n){var r,i,o=n(167),a=n(168),s=0,u=0;t.exports=function(t,e,n){var c=e&&n||0,h=e||[],f=(t=t||{}).node||r,l=void 0!==t.clockseq?t.clockseq:i;if(null==f||null==l){var p=o();null==f&&(f=r=[1|p[0],p[1],p[2],p[3],p[4],p[5]]),null==l&&(l=i=16383&(p[6]<<8|p[7]))}var d=void 0!==t.msecs?t.msecs:(new Date).getTime(),v=void 0!==t.nsecs?t.nsecs:u+1,y=d-s+(v-u)/1e4;if(y<0&&void 0===t.clockseq&&(l=l+1&16383),(y<0||d>s)&&void 0===t.nsecs&&(v=0),v>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");s=d,u=v,i=l;var m=(1e4*(268435455&(d+=122192928e5))+v)%4294967296;h[c++]=m>>>24&255,h[c++]=m>>>16&255,h[c++]=m>>>8&255,h[c++]=255&m;var g=d/4294967296*1e4&268435455;h[c++]=g>>>8&255,h[c++]=255&g,h[c++]=g>>>24&15|16,h[c++]=g>>>16&255,h[c++]=l>>>8|128,h[c++]=255&l;for(var w=0;w<6;++w)h[c+w]=f[w];return e||a(h)}},function(t,e,n){var r=n(167),i=n(168);t.exports=function(t,e,n){var o=e&&n||0;"string"==typeof t&&(e="binary"===t?new Array(16):null,t=null);var a=(t=t||{}).random||(t.rng||r)();if(a[6]=15&a[6]|64,a[8]=63&a[8]|128,e)for(var s=0;s<16;++s)e[o+s]=a[s];return e||i(a)}},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(t,e,n){"use strict";n.r(e);n(21),n(40),n(35),n(124),n(85),n(86),n(62),n(57);var r=n(152),i=n.n(r),o=n(171),a=(n(165),n(158)),s=n.n(a);function u(t,e,n,r,i,o,a){try{var s=t[o](a),u=s.value}catch(t){return void n(t)}s.done?e(u):Promise.resolve(u).then(r,i)}function c(t){return function(){var e=this,n=arguments;return new Promise((function(r,i){var o=t.apply(e,n);function a(t){u(o,r,i,a,s,"next",t)}function s(t){u(o,r,i,a,s,"throw",t)}a(void 0)}))}}function h(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var f=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}var e,n,r,i,o,a,u,f,l;return e=t,(n=[{key:"setURL",value:function(t){this.apiURL=t}},{key:"login",value:(l=c(regeneratorRuntime.mark((function t(e,n){var r;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.httpPost("authentication/login",{username:e,password:n});case 2:r=t.sent,this.apiToken=r.token,this.userUUID=r.userUUID;case 5:case"end":return t.stop()}}),t,this)}))),function(t,e){return l.apply(this,arguments)})},{key:"startSession",value:(f=c(regeneratorRuntime.mark((function t(e,n,r){var i;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.login(e,n);case 2:return t.next=4,this.httpPost("session/create",{token:this.apiToken,sceneUUID:r,maxUsers:10});case 4:return i=t.sent,t.next=7,this.joinSession(i.sessionUUID);case 7:return t.abrupt("return",t.sent);case 8:case"end":return t.stop()}}),t,this)}))),function(t,e,n){return f.apply(this,arguments)})},{key:"joinSession",value:(u=c(regeneratorRuntime.mark((function t(e){var n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this.sessionUUID=e,t.next=3,this.httpPost("session/join",{token:this.apiToken,sessionUUID:this.sessionUUID});case 3:return n=t.sent,this.sceneUUID=n.sceneUUID,t.abrupt("return",{ip:n.endpoint.ip,port:n.endpoint.port,sslport:n.endpoint.sslport,endpoint:n.endpoint,sessionKey:n.token});case 6:case"end":return t.stop()}}),t,this)}))),function(t){return u.apply(this,arguments)})},{key:"joinSessionAsWatcher",value:(a=c(regeneratorRuntime.mark((function t(e){var n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this.sessionUUID=e,t.next=3,this.httpPost("session/joinAsWatcher",{token:this.apiToken,sessionUUID:this.sessionUUID});case 3:return n=t.sent,this.sceneUUID=n.sceneUUID,t.abrupt("return",{ip:n.endpoint.ip,port:n.endpoint.port,sslport:n.endpoint.sslport,endpoint:n.endpoint,sessionKey:n.token});case 6:case"end":return t.stop()}}),t,this)}))),function(t){return a.apply(this,arguments)})},{key:"getUserProfile",value:(o=c(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.httpGet("user/profile",{token:this.apiToken});case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t,this)}))),function(){return o.apply(this,arguments)})},{key:"joinSessionAsGuest",value:(i=c(regeneratorRuntime.mark((function t(e){var n,r;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n={guestToken:e},this.apiToken&&(n.token=this.apiToken),t.next=4,this.httpPost("authentication/joinGuest",n);case 4:return r=t.sent,this.sceneUUID=r.sceneUUID||r.decodedPayload.sceneUUID,t.abrupt("return",{ip:r.endpoint.ip,port:r.endpoint.port,sslport:r.endpoint.sslport,endpoint:r.endpoint,sessionUUID:r.sessionUUID||r.decodedPayload.sessionUUID,sessionKey:r.token||r.guestSessionKey});case 7:case"end":return t.stop()}}),t,this)}))),function(t){return i.apply(this,arguments)})},{key:"httpGet",value:function(t,e){var n=this;return new Promise((function(r,i){s.a.get({url:n.getURL(t),qs:e},n.parseResponse(t,r,i))}))}},{key:"httpPost",value:function(t,e){var n=this;return new Promise((function(r,i){s.a.post({url:n.getURL(t),headers:{"Content-Type":"application/json"},body:JSON.stringify(e)},n.parseResponse(t,r,i))}))}},{key:"httpDelete",value:function(t,e){var n=this;return new Promise((function(r,i){s()({method:"DELETE",url:n.getURL(t),headers:{"Content-Type":"application/json"},body:JSON.stringify(e)},n.parseResponse(t,r,i))}))}},{key:"getURL",value:function(t){return"".concat(this.apiURL,"/").concat(t)}},{key:"parseResponse",value:function(t,e,n){return function(t,r,i){if(t)n(t.message);else{var o=i;try{o=JSON.parse(i)}catch(t){}if(200==r.statusCode)e(o);else if(o&&o.error){for(var a=o.error;a.error;)a=a.error;n("API Error ".concat(a.errorNum," : ").concat(a.message))}else n(o)}}}}])&&h(e.prototype,n),r&&h(e,r),t}(),l=n(177);function p(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var d=37,v=38,y=39,m=40,g=16;function w(t){return t.charCodeAt(0)}var b=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.ftlAPI=e,this.reset()}var e,n,r;return e=t,(n=[{key:"setFrenchKeyboardBindings",value:function(){this.reset(),this.values.MOVE_FORWARD[0]=["KEY_"+w("Z")],this.values.MOVE_LEFT[0]=["KEY_"+w("Q")],this.values.MOVE_DOWN[0]=["KEY_"+w("A")]}},{key:"getValues",value:function(){return this.values}},{key:"propagate",value:function(){this.ftlAPI.updateActionMap(this)}},{key:"reset",value:function(){this.values=this.getDefault()}},{key:"serialize",value:function(){return JSON.stringify(this.values)}},{key:"getDefault",value:function(){return{MOVE_FORWARD:[["KEY_"+w("W")],["KEY_"+w("I")],["KEY_"+v],["TOUCH_PINCH_START","TOUCH_FORWARD"],["GAMEPAD_LEFT_JOYSTICK_Y_NEG"]],MOVE_LEFT:[["KEY_"+w("A")],["KEY_"+w("J")],["GAMEPAD_LEFT_JOYSTICK_X_NEG"]],MOVE_BACKWARD:[["KEY_"+w("S")],["KEY_"+w("K")],["KEY_"+m],["TOUCH_PINCH_START","TOUCH_BACKWARD"],["GAMEPAD_LEFT_JOYSTICK_Y_POS"]],MOVE_RIGHT:[["KEY_"+w("D")],["KEY_"+w("L")],["GAMEPAD_LEFT_JOYSTICK_X_POS"]],MOVE_DOWN:[["KEY_"+w("Q")],["KEY_"+w("U")],["GAMEPAD_LEFT_TRIGGER"]],MOVE_UP:[["KEY_"+w("E")],["KEY_"+w("O")],["GAMEPAD_RIGHT_TRIGGER"]],LOOK_LEFT:[["MOUSE_BTN_LEFT","MOUSE_AXIS_X_POS"],["KEY_"+y],["TOUCH_START","TOUCH_AXIS_X_POS"],["GAMEPAD_RIGHT_JOYSTICK_X_POS"]],LOOK_RIGHT:[["MOUSE_BTN_LEFT","MOUSE_AXIS_X_NEG"],["KEY_"+d],["TOUCH_START","TOUCH_AXIS_X_NEG"],["GAMEPAD_RIGHT_JOYSTICK_X_NEG"]],LOOK_UP:[["MOUSE_BTN_LEFT","MOUSE_AXIS_Y_POS"],["TOUCH_START","TOUCH_AXIS_Y_POS"],["GAMEPAD_RIGHT_JOYSTICK_Y_POS"]],LOOK_DOWN:[["MOUSE_BTN_LEFT","MOUSE_AXIS_Y_NEG"],["TOUCH_START","TOUCH_AXIS_Y_NEG"],["GAMEPAD_RIGHT_JOYSTICK_Y_NEG"]],SPEED_UP:[["MOUSE_WHEEL_UP"]],SPEED_DOWN:[["MOUSE_WHEEL_DOWN"]],DISPLACE_UP:[["MOUSE_BTN_MIDDLE","MOUSE_AXIS_Y_POS"]],DISPLACE_DOWN:[["MOUSE_BTN_MIDDLE","MOUSE_AXIS_Y_NEG"]],DISPLACE_LEFT:[["MOUSE_BTN_MIDDLE","MOUSE_AXIS_X_NEG"]],DISPLACE_RIGHT:[["MOUSE_BTN_MIDDLE","MOUSE_AXIS_X_POS"]],SENSITIVITY_UP:[["KEY_"+g,"MOUSE_WHEEL_UP"]],SENSITIVITY_DOWN:[["KEY_"+g,"MOUSE_WHEEL_DOWN"]]}}}])&&p(e.prototype,n),r&&p(e,r),t}(),E=n(14);function _(t,e,n,r,i,o,a){try{var s=t[o](a),u=s.value}catch(t){return void n(t)}s.done?e(u):Promise.resolve(u).then(r,i)}function A(t){return function(){var e=this,n=arguments;return new Promise((function(r,i){var o=t.apply(e,n);function a(t){_(o,r,i,a,s,"next",t)}function s(t){_(o,r,i,a,s,"throw",t)}a(void 0)}))}}function x(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function k(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var T=function(){function t(){var e=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),k(this,"streamerConfig",void 0),k(this,"extensions",void 0),k(this,"notifier",void 0),k(this,"streamer",void 0),k(this,"webAPI",void 0),k(this,"engineAPI",void 0),k(this,"utils",void 0),k(this,"connected",void 0),this.extensions={},this.notifier=new i.a,this.webAPI=new f,this.streamer=new o.a(this.notifier),this.engineAPI=new l.a(this.notifier,this.streamer),this.actionMap=new b(this.engineAPI.ftlAPI),this.utils=E.a,this.streamerStarted=!1,this.connectedPromise=new Promise((function(t){e.onConnectedCallback=t})),this.setupDefaultConfig()}var e,n,r,a,s,u,c,h;return e=t,(n=[{key:"setupDisplay",value:function(t){this.streamerConfig.display.canvas=t,this.engineAPI.canvas=t,this.engineAPI.cameraAPI.setupDisplay(t),this.streamer.setupDisplay(t)}},{key:"setResolution",value:function(t,e){var n=this,r=this.utils.alignForYUV(t,e);return this.streamerStarted?(this.connectedPromise.then((function(){n.streamer.resize(r.width,r.height)})),r):(this.streamerConfig.resolution=[r.width,r.height],r)}},{key:"setViewports",value:(h=A(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.streamerStarted){t.next=3;break}return this.streamerConfig.viewports=e,t.abrupt("return");case 3:return t.next=5,this.connectedPromise;case 5:return t.next=7,this.engineAPI.cameraAPI.setViewports(e);case 7:case"end":return t.stop()}}),t,this)}))),function(t){return h.apply(this,arguments)})},{key:"setInputRelayFrequency",value:function(t){this.streamerConfig.inputRelayFrequency=t}},{key:"setInactivityCallback",value:function(t){this.streamer.inactivityWarningCallback=t}},{key:"startStreamer",value:(c=A(regeneratorRuntime.mark((function t(e){var n,r=this,i=arguments;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=i.length>1&&void 0!==i[1]&&i[1],this.streamerStarted=!0,this.streamerConfig.connectionInfo=e,this.streamerConfig.display.hardwareDecoding=n,this.validateConfig(),t.next=7,this.streamer.start(this.streamerConfig,!1);case 7:this.onConnectedCallback(),this.streamerConfig.connectionInfo.standalone&&(this.streamerConfig.editorTimeout=0),this.engineAPI.cameraAPI.setEditorTimeout(this.streamerConfig.editorTimeout),this.engineAPI.cameraAPI.setViewports(this.streamerConfig.viewports),document.addEventListener("visibilitychange",(function(t){var e="hidden"!=document.visibilityState;r.streamer.setState(e)}));case 12:case"end":return t.stop()}}),t,this)}))),function(t){return c.apply(this,arguments)})},{key:"watchSession",value:(u=A(regeneratorRuntime.mark((function t(e){var n,r=arguments;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=r.length>1&&void 0!==r[1]&&r[1],this.streamerConfig.connectionInfo=e,this.streamerStarted=!0,this.streamerConfig.display.hardwareDecoding=n,this.validateConfig(),t.next=7,this.streamer.start(this.streamerConfig,!0);case 7:this.pendingClientUUID&&(this.streamer.subscribeTo(this.pendingClientUUID),this.pendingClientUUID=null);case 8:case"end":return t.stop()}}),t,this)}))),function(t){return u.apply(this,arguments)})},{key:"subscribeTo",value:function(t){this.isConnected()?this.streamer.subscribeTo(t):this.pendingClientUUID=t}},{key:"connectToEditor",value:(s=A(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.onConnected();case 2:return this.engineAPI.editorAPI.connect(e,this.streamerConfig.connectionInfo.sessionKey,this.streamer.clientUUID),t.next=5,this.onEditorConnected();case 5:case"end":return t.stop()}}),t,this)}))),function(t){return s.apply(this,arguments)})},{key:"isConnected",value:function(){return this.streamer.isConnected}},{key:"onConnected",value:function(){return this.connectedPromise}},{key:"onEditorConnected",value:function(){return this.engineAPI.editorAPI.onConnected}},{key:"validateConfig",value:function(){this.checkParameter(this.streamerConfig.connectionInfo,"ip"),this.checkParameter(this.streamerConfig.connectionInfo,"port"),this.checkParameter(this.streamerConfig.connectionInfo,"sessionKey","standalone")}},{key:"setupDefaultConfig",value:function(){this.streamerConfig={connectionInfo:{},display:{canvas:null,hardwareDecoding:!1},resolution:[1280,720],viewports:[{id:0,left:0,top:0,width:1,height:1}],editorTimeout:2500,inputRelayFrequency:100}}},{key:"checkParameter",value:function(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];for(var i in n){var o=n[i];if(t[o])return}throw"Missing mandatory parameter ".concat(n.toString())}},{key:"installExtension",value:(a=A(regeneratorRuntime.mark((function t(e){var n,r,i,o,a=arguments;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.onConnected();case 2:for(n=new e(this),r=a.length,i=new Array(r>1?r-1:0),o=1;o<r;o++)i[o-1]=a[o];return t.next=6,n.onInit.apply(n,i);case 6:return this.extensions[n.name]=n,t.abrupt("return",n);case 8:case"end":return t.stop()}}),t,this)}))),function(t){return a.apply(this,arguments)})},{key:"getKey",value:function(t){var e=t.charCodeAt(0);return{down:!!this.streamer.inputRelay.keys[e]&&this.streamer.inputRelay.keys[e].down}}},{key:"enableInputs",value:function(){this.streamer.inputRelay.installListeners()}},{key:"disableInputs",value:function(){this.streamer.inputRelay.uninstallListeners()}},{key:"close",value:function(){return this.streamer.stop()}}])&&x(e.prototype,n),r&&x(e,r),t}();e.default=T}])}));
//# sourceMappingURL=SDK3DVerse.js.map